/*
 * Internal NT APIs and data structures
 *
 * Copyright (C) the Wine project
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */
#pragma warning(disable:4200)
#ifndef __WINE_WINTERNL_H
#define __WINE_WINTERNL_H

#include <windef.h>

#ifdef __cplusplus
extern "C" {
#endif /* defined(__cplusplus) */


/**********************************************************************
 * Fundamental types and data structures
 */

typedef LONG NTSTATUS;
typedef LARGE_INTEGER   QWORD;
typedef CONST char *PCSZ;

typedef short CSHORT;
typedef CSHORT *PCSHORT;

typedef struct _STRING {
  USHORT Length;
  USHORT MaximumLength;
  PCHAR Buffer;
} STRING, *PSTRING;

typedef STRING ANSI_STRING;
typedef PSTRING PANSI_STRING;
typedef const STRING *PCANSI_STRING;

typedef STRING OEM_STRING;
typedef PSTRING POEM_STRING;
typedef const STRING *PCOEM_STRING;

typedef struct _UNICODE_STRING 
{
  USHORT Length;        /* bytes */
  USHORT MaximumLength; /* bytes */
  PWSTR  Buffer;
} UNICODE_STRING, *PUNICODE_STRING;
typedef const UNICODE_STRING *PCUNICODE_STRING;

#ifndef _FILETIME_
#define _FILETIME_
/* 64 bit number of 100 nanoseconds intervals since January 1, 1601 */
typedef struct _FILETIME
{
#ifdef WORDS_BIGENDIAN
  DWORD  dwHighDateTime;
  DWORD  dwLowDateTime;
#else
  DWORD  dwLowDateTime;
  DWORD  dwHighDateTime;
#endif
} FILETIME, *PFILETIME, *LPFILETIME;
#endif /* _FILETIME_ */

/*
 * RTL_SYSTEM_TIME and RTL_TIME_ZONE_INFORMATION are the same as
 * the SYSTEMTIME and TIME_ZONE_INFORMATION structures defined
 * in winbase.h, however we need to define them seperately so
 * winternl.h doesn't depend on winbase.h.  They are used by
 * RtlQueryTimeZoneInformation and RtlSetTimeZoneInformation.
 * The names are guessed; if anybody knows the real names, let me know.
 */
typedef struct _RTL_SYSTEM_TIME {
    WORD wYear;
    WORD wMonth;
    WORD wDayOfWeek;
    WORD wDay;
    WORD wHour;
    WORD wMinute;
    WORD wSecond;
    WORD wMilliseconds;
} RTL_SYSTEM_TIME, *PRTL_SYSTEM_TIME;

typedef struct _RTL_TIME_ZONE_INFORMATION {
    LONG Bias;
    WCHAR StandardName[32];
    RTL_SYSTEM_TIME StandardDate;
    LONG StandardBias;
    WCHAR DaylightName[32];
    RTL_SYSTEM_TIME DaylightDate;
    LONG DaylightBias;
} RTL_TIME_ZONE_INFORMATION, *PRTL_TIME_ZONE_INFORMATION;

typedef struct _CLIENT_ID
{
   HANDLE UniqueProcess;
   HANDLE UniqueThread;
} CLIENT_ID, *PCLIENT_ID;

typedef struct _CURDIR
{
    UNICODE_STRING DosPath;
    PVOID Handle;
} CURDIR, *PCURDIR;

typedef struct RTL_DRIVE_LETTER_CURDIR
{
    USHORT              Flags;
    USHORT              Length;
    ULONG               TimeStamp;
    UNICODE_STRING      DosPath;
} RTL_DRIVE_LETTER_CURDIR, *PRTL_DRIVE_LETTER_CURDIR;

typedef struct tagRTL_BITMAP {
    ULONG  SizeOfBitMap; /* Number of bits in the bitmap */
    PULONG Buffer; /* Bitmap data, assumed sized to a DWORD boundary */
} RTL_BITMAP, *PRTL_BITMAP;

typedef const RTL_BITMAP *PCRTL_BITMAP;

typedef struct tagRTL_BITMAP_RUN {
    ULONG StartingIndex; /* Bit position at which run starts */
    ULONG NumberOfBits;  /* Size of the run in bits */
} RTL_BITMAP_RUN, *PRTL_BITMAP_RUN;

typedef const RTL_BITMAP_RUN *PCRTL_BITMAP_RUN;

typedef struct _RTL_USER_PROCESS_PARAMETERS
{
    ULONG               AllocationSize;
    ULONG               Size;
    ULONG               Flags;
    ULONG               DebugFlags;
    HANDLE              ConsoleHandle;
    ULONG               ConsoleFlags;
    HANDLE              hStdInput;
    HANDLE              hStdOutput;
    HANDLE              hStdError;
    CURDIR              CurrentDirectory;
    UNICODE_STRING      DllPath;
    UNICODE_STRING      ImagePathName;
    UNICODE_STRING      CommandLine;
    PWSTR               Environment;
    ULONG               dwX;
    ULONG               dwY;
    ULONG               dwXSize;
    ULONG               dwYSize;
    ULONG               dwXCountChars;
    ULONG               dwYCountChars;
    ULONG               dwFillAttribute;
    ULONG               dwFlags;
    ULONG               wShowWindow;
    UNICODE_STRING      WindowTitle;
    UNICODE_STRING      Desktop;
    UNICODE_STRING      ShellInfo;
    UNICODE_STRING      RuntimeInfo;
    RTL_DRIVE_LETTER_CURDIR DLCurrentDirectory[0x20];
} RTL_USER_PROCESS_PARAMETERS, *PRTL_USER_PROCESS_PARAMETERS;

/* value for Flags field (FIXME: not the correct name) */
#define PROCESS_PARAMS_FLAG_NORMALIZED 1

typedef struct _PEB_LDR_DATA
{
    ULONG               Length;
    BOOLEAN             Initialized;
    PVOID               SsHandle;
    LIST_ENTRY          InLoadOrderModuleList;
    LIST_ENTRY          InMemoryOrderModuleList;
    LIST_ENTRY          InInitializationOrderModuleList;
} PEB_LDR_DATA, *PPEB_LDR_DATA;

typedef struct _GDI_TEB_BATCH
{
    ULONG  Offset;
    HANDLE HDC;
    ULONG  Buffer[0x136];
} GDI_TEB_BATCH;

struct THREAD_INFO
{
	HANDLE hThread;
	CLIENT_ID id;
};
struct CSRSS_MESSAGE
{
	ULONG Unknown1;
	ULONG Opcode;
	ULONG Status;
	ULONG Unknown2;
};
#define NT_SUCCESS(Status) ((NTSTATUS)(Status) >= 0)
#ifndef _NTSTATUS_
#define _NTSTATUS_

#ifndef WIN32_NO_STATUS

/*
 * Debug codes
 */

#define DBG_REPLY_LATER                  ((NTSTATUS)0x40010001)
#define DBG_UNABLE_TO_PROVIDE_HANDLE     ((NTSTATUS)0x40010002)
#define DBG_PRINTEXCEPTION_C             ((NTSTATUS)0x40010006)
#define DBG_RIPEXCEPTION                 ((NTSTATUS)0x40010007)
#define DBG_NO_STATE_CHANGE              ((NTSTATUS)0xC0010001)
#define DBG_APP_NOT_IDLE                 ((NTSTATUS)0xC0010002)

/*
 * Exception codes
 */

#define STATUS_SUCCESS                   ((NTSTATUS)0x00000000)
#define STATUS_SEVERITY_SUCCESS          ((NTSTATUS)0x00000000)
#define STATUS_SEVERITY_INFORMATIONAL    ((NTSTATUS)0x00000001)
#define STATUS_SEVERITY_WARNING          ((NTSTATUS)0x00000002)
#define STATUS_SEVERITY_ERROR            ((NTSTATUS)0x00000003)

#define STATUS_WAIT_1                    ((NTSTATUS)0x00000001)
#define STATUS_WAIT_2                    ((NTSTATUS)0x00000002)
#define STATUS_WAIT_3                    ((NTSTATUS)0x00000003)
#define STATUS_WAIT_63                   ((NTSTATUS)0x0000003f)
#define STATUS_ABANDONED                 ((NTSTATUS)0x00000080)
#define STATUS_ABANDONED_WAIT_63         ((NTSTATUS)0x000000BF)
#define STATUS_KERNEL_APC                ((NTSTATUS)0x00000100)
#define STATUS_ALERTED                   ((NTSTATUS)0x00000101)
#define STATUS_REPARSE                   ((NTSTATUS)0x00000104)
#define STATUS_MORE_ENTRIES              ((NTSTATUS)0x00000105)
#define STATUS_NOT_ALL_ASSIGNED          ((NTSTATUS)0x00000106)
#define STATUS_SOME_NOT_MAPPED           ((NTSTATUS)0x00000107)
#define STATUS_OPLOCK_BREAK_IN_PROGRESS  ((NTSTATUS)0x00000108)
#define STATUS_VOLUME_MOUNTED            ((NTSTATUS)0x00000109)
#define STATUS_RXACT_COMMITTED           ((NTSTATUS)0x0000010A)
#define STATUS_NOTIFY_CLEANUP            ((NTSTATUS)0x0000010B)
#define STATUS_NOTIFY_ENUM_DIR           ((NTSTATUS)0x0000010C)
#define STATUS_NO_QUOTAS_FOR_ACCOUNT     ((NTSTATUS)0x0000010D)
#define STATUS_PRIMARY_TRANSPORT_CONNECT_FAILED ((NTSTATUS)0x0000010E)
#define STATUS_PAGE_FAULT_TRANSITION     ((NTSTATUS)0x00000110)
#define STATUS_PAGE_FAULT_DEMAND_ZERO    ((NTSTATUS)0x00000111)
#define STATUS_PAGE_FAULT_COPY_ON_WRITE  ((NTSTATUS)0x00000112)
#define STATUS_PAGE_FAULT_GUARD_PAGE     ((NTSTATUS)0x00000113)
#define STATUS_PAGE_FAULT_PAGING_FILE    ((NTSTATUS)0x00000114)
#define STATUS_CACHE_PAGE_LOCKED         ((NTSTATUS)0x00000115)
#define STATUS_CRASH_DUMP                ((NTSTATUS)0x00000116)
#define STATUS_BUFFER_ALL_ZEROS          ((NTSTATUS)0x00000117)
#define STATUS_REPARSE_OBJECT            ((NTSTATUS)0x00000118)
#define STATUS_RESOURCE_REQUIREMENTS_CHANGED ((NTSTATUS)0x00000119)
#define STATUS_TRANSLATION_COMPLETE      ((NTSTATUS)0x00000120)
#define STATUS_DS_MEMBERSHIP_EVALUATED_LOCALLY  ((NTSTATUS)0x00000121)
#define STATUS_NOTHING_TO_TERMINATE      ((NTSTATUS)0x00000122)
#define STATUS_PROCESS_NOT_IN_JOB        ((NTSTATUS)0x00000123)
#define STATUS_PROCESS_IN_JOB            ((NTSTATUS)0x00000124)
#define STATUS_VOLSNAP_HIBERNATE_READY   ((NTSTATUS)0x00000125)
#define STATUS_FSFILTER_OP_COMPLETED_SUCCESSFULLY ((NTSTATUS)0x00000126)

#define STATUS_OBJECT_NAME_EXISTS        ((NTSTATUS)0x40000000)
#define STATUS_THREAD_WAS_SUSPENDED      ((NTSTATUS)0x40000001)
#define STATUS_WORKING_SET_LIMIT_RANGE   ((NTSTATUS)0x40000002)
#define STATUS_IMAGE_NOT_AT_BASE         ((NTSTATUS)0x40000003)
#define STATUS_RXACT_STATE_CREATED       ((NTSTATUS)0x40000004)
#define STATUS_LOCAL_USER_SESSION_KEY    ((NTSTATUS)0x40000006)
#define STATUS_BAD_CURRENT_DIRECTORY     ((NTSTATUS)0x40000007)
#define STATUS_SERIAL_MORE_WRITES        ((NTSTATUS)0x40000008)
#define STATUS_REGISTRY_RECOVERED        ((NTSTATUS)0x40000009)
#define STATUS_FT_READ_RECOVERY_FROM_BACKUP ((NTSTATUS)0x4000000A)
#define STATUS_FT_WRITE_RECOVERY         ((NTSTATUS)0x4000000B)
#define STATUS_SERIAL_COUNTER_TIMEOUT    ((NTSTATUS)0x4000000C)
#define STATUS_NULL_LM_PASSWORD          ((NTSTATUS)0x4000000D)
#define STATUS_IMAGE_MACHINE_TYPE_MISMATCH ((NTSTATUS)0x4000000E)
#define STATUS_RECEIVE_PARTIAL           ((NTSTATUS)0x4000000F)
#define STATUS_RECEIVE_EXPEDITED         ((NTSTATUS)0x40000010)
#define STATUS_RECEIVE_PARTIAL_EXPEDITED ((NTSTATUS)0x40000011)
#define STATUS_EVENT_DONE                ((NTSTATUS)0x40000012)
#define STATUS_EVENT_PENDING             ((NTSTATUS)0x40000013)
#define STATUS_CHECKING_FILE_SYSTEM      ((NTSTATUS)0x40000014)
#define STATUS_FATAL_APP_EXIT            ((NTSTATUS)0x40000015)
#define STATUS_PREDEFINED_HANDLE         ((NTSTATUS)0x40000016)
#define STATUS_WAS_UNLOCKED              ((NTSTATUS)0x40000017)
#define STATUS_SERVICE_NOTIFICATION      ((NTSTATUS)0x40000018)
#define STATUS_WAS_LOCKED                ((NTSTATUS)0x40000019)
#define STATUS_LOG_HARD_ERROR            ((NTSTATUS)0x4000001A)
#define STATUS_ALREADY_WIN32             ((NTSTATUS)0x4000001B)
#define STATUS_WX86_UNSIMULATE           ((NTSTATUS)0x4000001C)
#define STATUS_WX86_CONTINUE             ((NTSTATUS)0x4000001D)
#define STATUS_WX86_SINGLE_STEP          ((NTSTATUS)0x4000001E)
#define STATUS_WX86_BREAKPOINT           ((NTSTATUS)0x4000001F)
#define STATUS_WX86_EXCEPTION_CONTINUE   ((NTSTATUS)0x40000020)
#define STATUS_WX86_EXCEPTION_LASTCHANCE ((NTSTATUS)0x40000021)
#define STATUS_WX86_EXCEPTION_CHAIN      ((NTSTATUS)0x40000022)
#define STATUS_IMAGE_MACHINE_TYPE_MISMATCH_EXE ((NTSTATUS)0x40000023)
#define STATUS_NO_YIELD_PERFORMED        ((NTSTATUS)0x40000024)
#define STATUS_TIMER_RESUME_IGNORED      ((NTSTATUS)0x40000025)
#define STATUS_ARBITRATION_UNHANDLED     ((NTSTATUS)0x40000026)
#define STATUS_CARDBUS_NOT_SUPPORTED     ((NTSTATUS)0x40000027)
#define STATUS_WX86_CREATEWX86TIB        ((NTSTATUS)0x40000028)
#define STATUS_MP_PROCESSOR_MISMATCH     ((NTSTATUS)0x40000029)
#define STATUS_HIBERNATED                ((NTSTATUS)0x4000002A)
#define STATUS_RESUME_HIBERNATION        ((NTSTATUS)0x4000002B)
#define STATUS_FIRMWARE_UPDATED          ((NTSTATUS)0x4000002C)
#define STATUS_WAKE_SYSTEM               ((NTSTATUS)0x40000294)
#define STATUS_DS_SHUTTING_DOWN          ((NTSTATUS)0x40000370)

#define RPC_NT_UUID_LOCAL_ONLY           ((NTSTATUS)0x40020056)
#define RPC_NT_SEND_INCOMPLETE           ((NTSTATUS)0x400200AF)

#define STATUS_CTX_CDM_CONNECT           ((NTSTATUS)0x400A0004)
#define STATUS_CTX_CDM_DISCONNECT        ((NTSTATUS)0x400A0005)

#define STATUS_SXS_RELEASE_ACTIVATION_CONTEXT ((NTSTATUS)0x4015000D)

#define STATUS_BUFFER_OVERFLOW           ((NTSTATUS)0x80000005)
#define STATUS_NO_MORE_FILES             ((NTSTATUS)0x80000006)
#define STATUS_WAKE_SYSTEM_DEBUGGER      ((NTSTATUS)0x80000007)

#define STATUS_HANDLES_CLOSED            ((NTSTATUS)0x8000000A)
#define STATUS_NO_INHERITANCE            ((NTSTATUS)0x8000000B)
#define STATUS_GUID_SUBSTITUTION_MADE    ((NTSTATUS)0x8000000C)
#define STATUS_PARTIAL_COPY              ((NTSTATUS)0x8000000D)
#define STATUS_DEVICE_PAPER_EMPTY        ((NTSTATUS)0x8000000E)
#define STATUS_DEVICE_POWERED_OFF        ((NTSTATUS)0x8000000F)
#define STATUS_DEVICE_OFF_LINE           ((NTSTATUS)0x80000010)
#define STATUS_DEVICE_BUSY               ((NTSTATUS)0x80000011)
#define STATUS_NO_MORE_EAS               ((NTSTATUS)0x80000012)
#define STATUS_INVALID_EA_NAME           ((NTSTATUS)0x80000013)
#define STATUS_EA_LIST_INCONSISTENT      ((NTSTATUS)0x80000014)
#define STATUS_INVALID_EA_FLAG           ((NTSTATUS)0x80000015)
#define STATUS_VERIFY_REQUIRED           ((NTSTATUS)0x80000016)
#define STATUS_EXTRANEOUS_INFORMATION    ((NTSTATUS)0x80000017)
#define STATUS_RXACT_COMMIT_NECESSARY    ((NTSTATUS)0x80000018)
#define STATUS_NO_MORE_ENTRIES           ((NTSTATUS)0x8000001A)
#define STATUS_FILEMARK_DETECTED         ((NTSTATUS)0x8000001B)
#define STATUS_MEDIA_CHANGED             ((NTSTATUS)0x8000001C)
#define STATUS_BUS_RESET                 ((NTSTATUS)0x8000001D)
#define STATUS_END_OF_MEDIA              ((NTSTATUS)0x8000001E)
#define STATUS_BEGINNING_OF_MEDIA        ((NTSTATUS)0x8000001F)
#define STATUS_MEDIA_CHECK               ((NTSTATUS)0x80000020)
#define STATUS_SETMARK_DETECTED          ((NTSTATUS)0x80000021)
#define STATUS_NO_DATA_DETECTED          ((NTSTATUS)0x80000022)
#define STATUS_REDIRECTOR_HAS_OPEN_HANDLES ((NTSTATUS)0x80000023)
#define STATUS_SERVER_HAS_OPEN_HANDLES   ((NTSTATUS)0x80000024)
#define STATUS_ALREADY_DISCONNECTED      ((NTSTATUS)0x80000025)
#define STATUS_LONGJUMP                  ((NTSTATUS)0x80000026)
#define STATUS_CLEANER_CARTRIDGE_INSTALLED      ((NTSTATUS)0x80000027)
#define STATUS_PLUGPLAY_QUERY_VETOED     ((NTSTATUS)0x80000028)
#define STATUS_UNWIND_CONSOLIDATE        ((NTSTATUS)0x80000029)
#define STATUS_REGISTRY_HIVE_RECOVERED   ((NTSTATUS)0x8000002A)
#define STATUS_DLL_MIGHT_BE_INSECURE     ((NTSTATUS)0x8000002B)
#define STATUS_DLL_MIGHT_BE_INCOMPATIBLE ((NTSTATUS)0x8000002C)

#define STATUS_DEVICE_REQUIRES_CLEANING  ((NTSTATUS)0x80000288)
#define STATUS_DEVICE_DOOR_OPEN          ((NTSTATUS)0x80000289)

#define STATUS_CLUSTER_NODE_ALREADY_UP   ((NTSTATUS)0x80130001)
#define STATUS_CLUSTER_NODE_ALREADY_DOWN ((NTSTATUS)0x80130002)
#define STATUS_CLUSTER_NETWORK_ALREADY_ONLINE   ((NTSTATUS)0x80130003)
#define STATUS_CLUSTER_NETWORK_ALREADY_OFFLINE  ((NTSTATUS)0x80130004)
#define STATUS_CLUSTER_NODE_ALREADY_MEMBER      ((NTSTATUS)0x80130005)

#define STATUS_UNSUCCESSFUL              ((NTSTATUS)0xC0000001)
#define STATUS_NOT_IMPLEMENTED           ((NTSTATUS)0xC0000002)
#define STATUS_INVALID_INFO_CLASS        ((NTSTATUS)0xC0000003)
#define STATUS_INFO_LENGTH_MISMATCH      ((NTSTATUS)0xC0000004)
#define STATUS_PAGEFILE_QUOTA            ((NTSTATUS)0xC0000007)
#define STATUS_BAD_INITIAL_STACK         ((NTSTATUS)0xC0000009)
#define STATUS_BAD_INITIAL_PC            ((NTSTATUS)0xC000000A)
#define STATUS_INVALID_CID               ((NTSTATUS)0xC000000B)
#define STATUS_TIMER_NOT_CANCELED        ((NTSTATUS)0xC000000C)
#define STATUS_INVALID_PARAMETER         ((NTSTATUS)0xC000000D)
#define STATUS_NO_SUCH_DEVICE            ((NTSTATUS)0xC000000E)
#define STATUS_NO_SUCH_FILE              ((NTSTATUS)0xC000000F)
#define STATUS_END_OF_FILE               ((NTSTATUS)0xC0000011)
#define STATUS_WRONG_VOLUME              ((NTSTATUS)0xC0000012)
#define STATUS_NO_MEDIA_IN_DEVICE        ((NTSTATUS)0xC0000013)
#define STATUS_UNRECOGNIZED_MEDIA        ((NTSTATUS)0xC0000014)
#define STATUS_NONEXISTENT_SECTOR        ((NTSTATUS)0xC0000015)
#define STATUS_MORE_PROCESSING_REQUIRED  ((NTSTATUS)0xC0000016)
#define STATUS_CONFLICTING_ADDRESSES     ((NTSTATUS)0xC0000018)
#define STATUS_NOT_MAPPED_VIEW           ((NTSTATUS)0xC0000019)
#define STATUS_UNABLE_TO_FREE_VM         ((NTSTATUS)0xC000001A)
#define STATUS_UNABLE_TO_DELETE_SECTION  ((NTSTATUS)0xC000001B)
#define STATUS_INVALID_SYSTEM_SERVICE    ((NTSTATUS)0xC000001C)
#define STATUS_INVALID_LOCK_SEQUENCE     ((NTSTATUS)0xC000001E)
#define STATUS_INVALID_VIEW_SIZE         ((NTSTATUS)0xC000001F)
#define STATUS_INVALID_FILE_FOR_SECTION  ((NTSTATUS)0xC0000020)
#define STATUS_ALREADY_COMMITTED         ((NTSTATUS)0xC0000021)
#define STATUS_ACCESS_DENIED             ((NTSTATUS)0xC0000022)
#define STATUS_BUFFER_TOO_SMALL          ((NTSTATUS)0xC0000023)
#define STATUS_OBJECT_TYPE_MISMATCH      ((NTSTATUS)0xC0000024)
#define STATUS_UNWIND                    ((NTSTATUS)0xC0000027)
#define STATUS_BAD_STACK                 ((NTSTATUS)0xC0000028)
#define STATUS_INVALID_UNWIND_TARGET     ((NTSTATUS)0xC0000029)
#define STATUS_NOT_LOCKED                ((NTSTATUS)0xC000002A)
#define STATUS_PARITY_ERROR              ((NTSTATUS)0xC000002B)
#define STATUS_UNABLE_TO_DECOMMIT_VM     ((NTSTATUS)0xC000002C)
#define STATUS_NOT_COMMITTED             ((NTSTATUS)0xC000002D)
#define STATUS_INVALID_PORT_ATTRIBUTES   ((NTSTATUS)0xC000002E)
#define STATUS_PORT_MESSAGE_TOO_LONG     ((NTSTATUS)0xC000002F)
#define STATUS_INVALID_PARAMETER_MIX     ((NTSTATUS)0xC0000030)
#define STATUS_INVALID_QUOTA_LOWER       ((NTSTATUS)0xC0000031)
#define STATUS_DISK_CORRUPT_ERROR        ((NTSTATUS)0xC0000032)
#define STATUS_OBJECT_NAME_INVALID       ((NTSTATUS)0xC0000033)
#define STATUS_OBJECT_NAME_NOT_FOUND     ((NTSTATUS)0xC0000034)
#define STATUS_OBJECT_NAME_COLLISION     ((NTSTATUS)0xC0000035)
#define STATUS_PORT_DISCONNECTED         ((NTSTATUS)0xC0000037)
#define STATUS_DEVICE_ALREADY_ATTACHED   ((NTSTATUS)0xC0000038)
#define STATUS_OBJECT_PATH_INVALID       ((NTSTATUS)0xC0000039)
#define STATUS_OBJECT_PATH_NOT_FOUND     ((NTSTATUS)0xC000003A)
#define STATUS_OBJECT_PATH_SYNTAX_BAD    ((NTSTATUS)0xC000003B)
#define STATUS_DATA_OVERRUN              ((NTSTATUS)0xC000003C)
#define STATUS_DATA_LATE_ERROR           ((NTSTATUS)0xC000003D)
#define STATUS_DATA_ERROR                ((NTSTATUS)0xC000003E)
#define STATUS_CRC_ERROR                 ((NTSTATUS)0xC000003F)
#define STATUS_SECTION_TOO_BIG           ((NTSTATUS)0xC0000040)
#define STATUS_PORT_CONNECTION_REFUSED   ((NTSTATUS)0xC0000041)
#define STATUS_INVALID_PORT_HANDLE       ((NTSTATUS)0xC0000042)
#define STATUS_SHARING_VIOLATION         ((NTSTATUS)0xC0000043)
#define STATUS_QUOTA_EXCEEDED            ((NTSTATUS)0xC0000044)
#define STATUS_INVALID_PAGE_PROTECTION   ((NTSTATUS)0xC0000045)
#define STATUS_MUTANT_NOT_OWNED          ((NTSTATUS)0xC0000046)
#define STATUS_SEMAPHORE_LIMIT_EXCEEDED  ((NTSTATUS)0xC0000047)
#define STATUS_PORT_ALREADY_SET          ((NTSTATUS)0xC0000048)
#define STATUS_SECTION_NOT_IMAGE         ((NTSTATUS)0xC0000049)
#define STATUS_SUSPEND_COUNT_EXCEEDED    ((NTSTATUS)0xC000004A)
#define STATUS_THREAD_IS_TERMINATING     ((NTSTATUS)0xC000004B)
#define STATUS_BAD_WORKING_SET_LIMIT     ((NTSTATUS)0xC000004C)
#define STATUS_INCOMPATIBLE_FILE_MAP     ((NTSTATUS)0xC000004D)
#define STATUS_SECTION_PROTECTION        ((NTSTATUS)0xC000004E)
#define STATUS_EAS_NOT_SUPPORTED         ((NTSTATUS)0xC000004F)
#define STATUS_EA_TOO_LARGE              ((NTSTATUS)0xC0000050)
#define STATUS_NONEXISTENT_EA_ENTRY      ((NTSTATUS)0xC0000051)
#define STATUS_NO_EAS_ON_FILE            ((NTSTATUS)0xC0000052)
#define STATUS_EA_CORRUPT_ERROR          ((NTSTATUS)0xC0000053)
#define STATUS_FILE_LOCK_CONFLICT        ((NTSTATUS)0xC0000054)
#define STATUS_LOCK_NOT_GRANTED          ((NTSTATUS)0xC0000055)
#define STATUS_DELETE_PENDING            ((NTSTATUS)0xC0000056)
#define STATUS_CTL_FILE_NOT_SUPPORTED    ((NTSTATUS)0xC0000057)
#define STATUS_UNKNOWN_REVISION          ((NTSTATUS)0xC0000058)
#define STATUS_REVISION_MISMATCH         ((NTSTATUS)0xC0000059)
#define STATUS_INVALID_OWNER             ((NTSTATUS)0xC000005A)
#define STATUS_INVALID_PRIMARY_GROUP     ((NTSTATUS)0xC000005B)
#define STATUS_NO_IMPERSONATION_TOKEN    ((NTSTATUS)0xC000005C)
#define STATUS_CANT_DISABLE_MANDATORY    ((NTSTATUS)0xC000005D)
#define STATUS_NO_LOGON_SERVERS          ((NTSTATUS)0xC000005E)
#define STATUS_NO_SUCH_LOGON_SESSION     ((NTSTATUS)0xC000005F)
#define STATUS_NO_SUCH_PRIVILEGE         ((NTSTATUS)0xC0000060)
#define STATUS_PRIVILEGE_NOT_HELD        ((NTSTATUS)0xC0000061)
#define STATUS_INVALID_ACCOUNT_NAME      ((NTSTATUS)0xC0000062)
#define STATUS_USER_EXISTS               ((NTSTATUS)0xC0000063)
#define STATUS_NO_SUCH_USER              ((NTSTATUS)0xC0000064)
#define STATUS_GROUP_EXISTS              ((NTSTATUS)0xC0000065)
#define STATUS_NO_SUCH_GROUP             ((NTSTATUS)0xC0000066)
#define STATUS_MEMBER_IN_GROUP           ((NTSTATUS)0xC0000067)
#define STATUS_MEMBER_NOT_IN_GROUP       ((NTSTATUS)0xC0000068)
#define STATUS_LAST_ADMIN                ((NTSTATUS)0xC0000069)
#define STATUS_WRONG_PASSWORD            ((NTSTATUS)0xC000006A)
#define STATUS_ILL_FORMED_PASSWORD       ((NTSTATUS)0xC000006B)
#define STATUS_PASSWORD_RESTRICTION      ((NTSTATUS)0xC000006C)
#define STATUS_LOGON_FAILURE             ((NTSTATUS)0xC000006D)
#define STATUS_ACCOUNT_RESTRICTION       ((NTSTATUS)0xC000006E)
#define STATUS_INVALID_LOGON_HOURS       ((NTSTATUS)0xC000006F)
#define STATUS_INVALID_WORKSTATION       ((NTSTATUS)0xC0000070)
#define STATUS_PASSWORD_EXPIRED          ((NTSTATUS)0xC0000071)
#define STATUS_ACCOUNT_DISABLED          ((NTSTATUS)0xC0000072)
#define STATUS_NONE_MAPPED               ((NTSTATUS)0xC0000073)
#define STATUS_TOO_MANY_LUIDS_REQUESTED  ((NTSTATUS)0xC0000074)
#define STATUS_LUIDS_EXHAUSTED           ((NTSTATUS)0xC0000075)
#define STATUS_INVALID_SUB_AUTHORITY     ((NTSTATUS)0xC0000076)
#define STATUS_INVALID_ACL               ((NTSTATUS)0xC0000077)
#define STATUS_INVALID_SID               ((NTSTATUS)0xC0000078)
#define STATUS_INVALID_SECURITY_DESCR    ((NTSTATUS)0xC0000079)
#define STATUS_PROCEDURE_NOT_FOUND       ((NTSTATUS)0xC000007A)
#define STATUS_INVALID_IMAGE_FORMAT      ((NTSTATUS)0xC000007B)
#define STATUS_NO_TOKEN                  ((NTSTATUS)0xC000007C)
#define STATUS_BAD_INHERITANCE_ACL       ((NTSTATUS)0xC000007D)
#define STATUS_RANGE_NOT_LOCKED          ((NTSTATUS)0xC000007E)
#define STATUS_DISK_FULL                 ((NTSTATUS)0xC000007F)
#define STATUS_SERVER_DISABLED           ((NTSTATUS)0xC0000080)
#define STATUS_SERVER_NOT_DISABLED       ((NTSTATUS)0xC0000081)
#define STATUS_TOO_MANY_GUIDS_REQUESTED  ((NTSTATUS)0xC0000082)
#define STATUS_GUIDS_EXHAUSTED           ((NTSTATUS)0xC0000083)
#define STATUS_INVALID_ID_AUTHORITY      ((NTSTATUS)0xC0000084)
#define STATUS_AGENTS_EXHAUSTED          ((NTSTATUS)0xC0000085)
#define STATUS_INVALID_VOLUME_LABEL      ((NTSTATUS)0xC0000086)
#define STATUS_SECTION_NOT_EXTENDED      ((NTSTATUS)0xC0000087)
#define STATUS_NOT_MAPPED_DATA           ((NTSTATUS)0xC0000088)
#define STATUS_RESOURCE_DATA_NOT_FOUND   ((NTSTATUS)0xC0000089)
#define STATUS_RESOURCE_TYPE_NOT_FOUND   ((NTSTATUS)0xC000008A)
#define STATUS_RESOURCE_NAME_NOT_FOUND   ((NTSTATUS)0xC000008B)
#define STATUS_TOO_MANY_PAGING_FILES     ((NTSTATUS)0xC0000097)
#define STATUS_FILE_INVALID              ((NTSTATUS)0xC0000098)
#define STATUS_ALLOTTED_SPACE_EXCEEDED   ((NTSTATUS)0xC0000099)
#define STATUS_INSUFFICIENT_RESOURCES    ((NTSTATUS)0xC000009A)
#define STATUS_DFS_EXIT_PATH_FOUND       ((NTSTATUS)0xC000009B)
#define STATUS_DEVICE_DATA_ERROR         ((NTSTATUS)0xC000009C)
#define STATUS_DEVICE_NOT_CONNECTED      ((NTSTATUS)0xC000009D)
#define STATUS_DEVICE_POWER_FAILURE      ((NTSTATUS)0xC000009E)
#define STATUS_FREE_VM_NOT_AT_BASE       ((NTSTATUS)0xC000009F)
#define STATUS_MEMORY_NOT_ALLOCATED      ((NTSTATUS)0xC00000A0)
#define STATUS_WORKING_SET_QUOTA         ((NTSTATUS)0xC00000A1)
#define STATUS_MEDIA_WRITE_PROTECTED     ((NTSTATUS)0xC00000A2)
#define STATUS_DEVICE_NOT_READY          ((NTSTATUS)0xC00000A3)
#define STATUS_INVALID_GROUP_ATTRIBUTES  ((NTSTATUS)0xC00000A4)
#define STATUS_BAD_IMPERSONATION_LEVEL   ((NTSTATUS)0xC00000A5)
#define STATUS_CANT_OPEN_ANONYMOUS       ((NTSTATUS)0xC00000A6)
#define STATUS_BAD_VALIDATION_CLASS      ((NTSTATUS)0xC00000A7)
#define STATUS_BAD_TOKEN_TYPE            ((NTSTATUS)0xC00000A8)
#define STATUS_BAD_MASTER_BOOT_RECORD    ((NTSTATUS)0xC00000A9)
#define STATUS_INSTRUCTION_MISALIGNMENT  ((NTSTATUS)0xC00000AA)
#define STATUS_INSTANCE_NOT_AVAILABLE    ((NTSTATUS)0xC00000AB)
#define STATUS_PIPE_NOT_AVAILABLE        ((NTSTATUS)0xC00000AC)
#define STATUS_INVALID_PIPE_STATE        ((NTSTATUS)0xC00000AD)
#define STATUS_PIPE_BUSY                 ((NTSTATUS)0xC00000AE)
#define STATUS_ILLEGAL_FUNCTION          ((NTSTATUS)0xC00000AF)
#define STATUS_PIPE_DISCONNECTED         ((NTSTATUS)0xC00000B0)
#define STATUS_PIPE_CLOSING              ((NTSTATUS)0xC00000B1)
#define STATUS_PIPE_CONNECTED            ((NTSTATUS)0xC00000B2)
#define STATUS_PIPE_LISTENING            ((NTSTATUS)0xC00000B3)
#define STATUS_INVALID_READ_MODE         ((NTSTATUS)0xC00000B4)
#define STATUS_IO_TIMEOUT                ((NTSTATUS)0xC00000B5)
#define STATUS_FILE_FORCED_CLOSED        ((NTSTATUS)0xC00000B6)
#define STATUS_PROFILING_NOT_STARTED     ((NTSTATUS)0xC00000B7)
#define STATUS_PROFILING_NOT_STOPPED     ((NTSTATUS)0xC00000B8)
#define STATUS_COULD_NOT_INTERPRET       ((NTSTATUS)0xC00000B9)
#define STATUS_FILE_IS_A_DIRECTORY       ((NTSTATUS)0xC00000BA)
#define STATUS_NOT_SUPPORTED             ((NTSTATUS)0xC00000BB)
#define STATUS_REMOTE_NOT_LISTENING      ((NTSTATUS)0xC00000BC)
#define STATUS_DUPLICATE_NAME            ((NTSTATUS)0xC00000BD)
#define STATUS_BAD_NETWORK_PATH          ((NTSTATUS)0xC00000BE)
#define STATUS_NETWORK_BUSY              ((NTSTATUS)0xC00000BF)
#define STATUS_DEVICE_DOES_NOT_EXIST     ((NTSTATUS)0xC00000C0)
#define STATUS_TOO_MANY_COMMANDS         ((NTSTATUS)0xC00000C1)
#define STATUS_ADAPTER_HARDWARE_ERROR    ((NTSTATUS)0xC00000C2)
#define STATUS_INVALID_NETWORK_RESPONSE  ((NTSTATUS)0xC00000C3)
#define STATUS_UNEXPECTED_NETWORK_ERROR  ((NTSTATUS)0xC00000C4)
#define STATUS_BAD_REMOTE_ADAPTER        ((NTSTATUS)0xC00000C5)
#define STATUS_PRINT_QUEUE_FULL          ((NTSTATUS)0xC00000C6)
#define STATUS_NO_SPOOL_SPACE            ((NTSTATUS)0xC00000C7)
#define STATUS_PRINT_CANCELLED           ((NTSTATUS)0xC00000C8)
#define STATUS_NETWORK_NAME_DELETED      ((NTSTATUS)0xC00000C9)
#define STATUS_NETWORK_ACCESS_DENIED     ((NTSTATUS)0xC00000CA)
#define STATUS_BAD_DEVICE_TYPE           ((NTSTATUS)0xC00000CB)
#define STATUS_BAD_NETWORK_NAME          ((NTSTATUS)0xC00000CC)
#define STATUS_TOO_MANY_NAMES            ((NTSTATUS)0xC00000CD)
#define STATUS_TOO_MANY_SESSIONS         ((NTSTATUS)0xC00000CE)
#define STATUS_SHARING_PAUSED            ((NTSTATUS)0xC00000CF)
#define STATUS_REQUEST_NOT_ACCEPTED      ((NTSTATUS)0xC00000D0)
#define STATUS_REDIRECTOR_PAUSED         ((NTSTATUS)0xC00000D1)
#define STATUS_NET_WRITE_FAULT           ((NTSTATUS)0xC00000D2)
#define STATUS_PROFILING_AT_LIMIT        ((NTSTATUS)0xC00000D3)
#define STATUS_NOT_SAME_DEVICE           ((NTSTATUS)0xC00000D4)
#define STATUS_FILE_RENAMED              ((NTSTATUS)0xC00000D5)
#define STATUS_VIRTUAL_CIRCUIT_CLOSED    ((NTSTATUS)0xC00000D6)
#define STATUS_NO_SECURITY_ON_OBJECT     ((NTSTATUS)0xC00000D7)
#define STATUS_CANT_WAIT                 ((NTSTATUS)0xC00000D8)
#define STATUS_PIPE_EMPTY                ((NTSTATUS)0xC00000D9)
#define STATUS_CANT_ACCESS_DOMAIN_INFO   ((NTSTATUS)0xC00000DA)
#define STATUS_CANT_TERMINATE_SELF       ((NTSTATUS)0xC00000DB)
#define STATUS_INVALID_SERVER_STATE      ((NTSTATUS)0xC00000DC)
#define STATUS_INVALID_DOMAIN_STATE      ((NTSTATUS)0xC00000DD)
#define STATUS_INVALID_DOMAIN_ROLE       ((NTSTATUS)0xC00000DE)
#define STATUS_NO_SUCH_DOMAIN            ((NTSTATUS)0xC00000DF)
#define STATUS_DOMAIN_EXISTS             ((NTSTATUS)0xC00000E0)
#define STATUS_DOMAIN_LIMIT_EXCEEDED     ((NTSTATUS)0xC00000E1)
#define STATUS_OPLOCK_NOT_GRANTED        ((NTSTATUS)0xC00000E2)
#define STATUS_INVALID_OPLOCK_PROTOCOL   ((NTSTATUS)0xC00000E3)
#define STATUS_INTERNAL_DB_CORRUPTION    ((NTSTATUS)0xC00000E4)
#define STATUS_INTERNAL_ERROR            ((NTSTATUS)0xC00000E5)
#define STATUS_GENERIC_NOT_MAPPED        ((NTSTATUS)0xC00000E6)
#define STATUS_BAD_DESCRIPTOR_FORMAT     ((NTSTATUS)0xC00000E7)
#define STATUS_INVALID_USER_BUFFER       ((NTSTATUS)0xC00000E8)
#define STATUS_UNEXPECTED_IO_ERROR       ((NTSTATUS)0xC00000E9)
#define STATUS_UNEXPECTED_MM_CREATE_ERR  ((NTSTATUS)0xC00000EA)
#define STATUS_UNEXPECTED_MM_MAP_ERROR   ((NTSTATUS)0xC00000EB)
#define STATUS_UNEXPECTED_MM_EXTEND_ERR  ((NTSTATUS)0xC00000EC)
#define STATUS_NOT_LOGON_PROCESS         ((NTSTATUS)0xC00000ED)
#define STATUS_LOGON_SESSION_EXISTS      ((NTSTATUS)0xC00000EE)
#define STATUS_INVALID_PARAMETER_1       ((NTSTATUS)0xC00000EF)
#define STATUS_INVALID_PARAMETER_2       ((NTSTATUS)0xC00000F0)
#define STATUS_INVALID_PARAMETER_3       ((NTSTATUS)0xC00000F1)
#define STATUS_INVALID_PARAMETER_4       ((NTSTATUS)0xC00000F2)
#define STATUS_INVALID_PARAMETER_5       ((NTSTATUS)0xC00000F3)
#define STATUS_INVALID_PARAMETER_6       ((NTSTATUS)0xC00000F4)
#define STATUS_INVALID_PARAMETER_7       ((NTSTATUS)0xC00000F5)
#define STATUS_INVALID_PARAMETER_8       ((NTSTATUS)0xC00000F6)
#define STATUS_INVALID_PARAMETER_9       ((NTSTATUS)0xC00000F7)
#define STATUS_INVALID_PARAMETER_10      ((NTSTATUS)0xC00000F8)
#define STATUS_INVALID_PARAMETER_11      ((NTSTATUS)0xC00000F9)
#define STATUS_INVALID_PARAMETER_12      ((NTSTATUS)0xC00000FA)
#define STATUS_REDIRECTOR_NOT_STARTED    ((NTSTATUS)0xC00000FB)
#define STATUS_REDIRECTOR_STARTED        ((NTSTATUS)0xC00000FC)
#define STATUS_NO_SUCH_PACKAGE           ((NTSTATUS)0xC00000FE)
#define STATUS_BAD_FUNCTION_TABLE        ((NTSTATUS)0xC00000FF)
#define STATUS_VARIABLE_NOT_FOUND        ((NTSTATUS)0xC0000100)
#define STATUS_DIRECTORY_NOT_EMPTY       ((NTSTATUS)0xC0000101)
#define STATUS_FILE_CORRUPT_ERROR        ((NTSTATUS)0xC0000102)
#define STATUS_NOT_A_DIRECTORY           ((NTSTATUS)0xC0000103)
#define STATUS_BAD_LOGON_SESSION_STATE   ((NTSTATUS)0xC0000104)
#define STATUS_LOGON_SESSION_COLLISION   ((NTSTATUS)0xC0000105)
#define STATUS_NAME_TOO_LONG             ((NTSTATUS)0xC0000106)
#define STATUS_FILES_OPEN                ((NTSTATUS)0xC0000107)
#define STATUS_CONNECTION_IN_USE         ((NTSTATUS)0xC0000108)
#define STATUS_MESSAGE_NOT_FOUND         ((NTSTATUS)0xC0000109)
#define STATUS_PROCESS_IS_TERMINATING    ((NTSTATUS)0xC000010A)
#define STATUS_INVALID_LOGON_TYPE        ((NTSTATUS)0xC000010B)
#define STATUS_NO_GUID_TRANSLATION       ((NTSTATUS)0xC000010C)
#define STATUS_CANNOT_IMPERSONATE        ((NTSTATUS)0xC000010D)
#define STATUS_IMAGE_ALREADY_LOADED      ((NTSTATUS)0xC000010E)
#define STATUS_ABIOS_NOT_PRESENT         ((NTSTATUS)0xC000010F)
#define STATUS_ABIOS_LID_NOT_EXIST       ((NTSTATUS)0xC0000110)
#define STATUS_ABIOS_LID_ALREADY_OWNED   ((NTSTATUS)0xC0000111)
#define STATUS_ABIOS_NOT_LID_OWNER       ((NTSTATUS)0xC0000112)
#define STATUS_ABIOS_INVALID_COMMAND     ((NTSTATUS)0xC0000113)
#define STATUS_ABIOS_INVALID_LID         ((NTSTATUS)0xC0000114)
#define STATUS_ABIOS_SELECTOR_NOT_AVAILABLE ((NTSTATUS)0xC0000115)
#define STATUS_ABIOS_INVALID_SELECTOR    ((NTSTATUS)0xC0000116)
#define STATUS_NO_LDT                    ((NTSTATUS)0xC0000117)
#define STATUS_INVALID_LDT_SIZE          ((NTSTATUS)0xC0000118)
#define STATUS_INVALID_LDT_OFFSET        ((NTSTATUS)0xC0000119)
#define STATUS_INVALID_LDT_DESCRIPTOR    ((NTSTATUS)0xC000011A)
#define STATUS_INVALID_IMAGE_NE_FORMAT   ((NTSTATUS)0xC000011B)
#define STATUS_RXACT_INVALID_STATE       ((NTSTATUS)0xC000011C)
#define STATUS_RXACT_COMMIT_FAILURE      ((NTSTATUS)0xC000011D)
#define STATUS_MAPPED_FILE_SIZE_ZERO     ((NTSTATUS)0xC000011E)
#define STATUS_TOO_MANY_OPENED_FILES     ((NTSTATUS)0xC000011F)
#define STATUS_CANCELLED                 ((NTSTATUS)0xC0000120)
#define STATUS_CANNOT_DELETE             ((NTSTATUS)0xC0000121)
#define STATUS_INVALID_COMPUTER_NAME     ((NTSTATUS)0xC0000122)
#define STATUS_FILE_DELETED              ((NTSTATUS)0xC0000123)
#define STATUS_SPECIAL_ACCOUNT           ((NTSTATUS)0xC0000124)
#define STATUS_SPECIAL_GROUP             ((NTSTATUS)0xC0000125)
#define STATUS_SPECIAL_USER              ((NTSTATUS)0xC0000126)
#define STATUS_MEMBERS_PRIMARY_GROUP     ((NTSTATUS)0xC0000127)
#define STATUS_FILE_CLOSED               ((NTSTATUS)0xC0000128)
#define STATUS_TOO_MANY_THREADS          ((NTSTATUS)0xC0000129)
#define STATUS_THREAD_NOT_IN_PROCESS     ((NTSTATUS)0xC000012A)
#define STATUS_TOKEN_ALREADY_IN_USE      ((NTSTATUS)0xC000012B)
#define STATUS_PAGEFILE_QUOTA_EXCEEDED   ((NTSTATUS)0xC000012C)
#define STATUS_COMMITMENT_LIMIT          ((NTSTATUS)0xC000012D)
#define STATUS_INVALID_IMAGE_LE_FORMAT   ((NTSTATUS)0xC000012E)
#define STATUS_INVALID_IMAGE_NOT_MZ      ((NTSTATUS)0xC000012F)
#define STATUS_INVALID_IMAGE_PROTECT     ((NTSTATUS)0xC0000130)
#define STATUS_INVALID_IMAGE_WIN_16      ((NTSTATUS)0xC0000131)
#define STATUS_LOGON_SERVER_CONFLICT     ((NTSTATUS)0xC0000132)
#define STATUS_TIME_DIFFERENCE_AT_DC     ((NTSTATUS)0xC0000133)
#define STATUS_SYNCHRONIZATION_REQUIRED  ((NTSTATUS)0xC0000134)
#define STATUS_DLL_NOT_FOUND             ((NTSTATUS)0xC0000135)
#define STATUS_OPEN_FAILED               ((NTSTATUS)0xC0000136)
#define STATUS_IO_PRIVILEGE_FAILED       ((NTSTATUS)0xC0000137)
#define STATUS_ORDINAL_NOT_FOUND         ((NTSTATUS)0xC0000138)
#define STATUS_ENTRYPOINT_NOT_FOUND      ((NTSTATUS)0xC0000139)
#define STATUS_LOCAL_DISCONNECT          ((NTSTATUS)0xC000013B)
#define STATUS_REMOTE_DISCONNECT         ((NTSTATUS)0xC000013C)
#define STATUS_REMOTE_RESOURCES          ((NTSTATUS)0xC000013D)
#define STATUS_LINK_FAILED               ((NTSTATUS)0xC000013E)
#define STATUS_LINK_TIMEOUT              ((NTSTATUS)0xC000013F)
#define STATUS_INVALID_CONNECTION        ((NTSTATUS)0xC0000140)
#define STATUS_INVALID_ADDRESS           ((NTSTATUS)0xC0000141)
#define STATUS_DLL_INIT_FAILED           ((NTSTATUS)0xC0000142)
#define STATUS_MISSING_SYSTEMFILE        ((NTSTATUS)0xC0000143)
#define STATUS_UNHANDLED_EXCEPTION       ((NTSTATUS)0xC0000144)
#define STATUS_APP_INIT_FAILURE          ((NTSTATUS)0xC0000145)
#define STATUS_PAGEFILE_CREATE_FAILED    ((NTSTATUS)0xC0000146)
#define STATUS_NO_PAGEFILE               ((NTSTATUS)0xC0000147)
#define STATUS_INVALID_LEVEL             ((NTSTATUS)0xC0000148)
#define STATUS_WRONG_PASSWORD_CORE       ((NTSTATUS)0xC0000149)
#define STATUS_ILLEGAL_FLOAT_CONTEXT     ((NTSTATUS)0xC000014A)
#define STATUS_PIPE_BROKEN               ((NTSTATUS)0xC000014B)
#define STATUS_REGISTRY_CORRUPT          ((NTSTATUS)0xC000014C)
#define STATUS_REGISTRY_IO_FAILED        ((NTSTATUS)0xC000014D)
#define STATUS_NO_EVENT_PAIR             ((NTSTATUS)0xC000014E)
#define STATUS_UNRECOGNIZED_VOLUME       ((NTSTATUS)0xC000014F)
#define STATUS_SERIAL_NO_DEVICE_INITED   ((NTSTATUS)0xC0000150)
#define STATUS_NO_SUCH_ALIAS             ((NTSTATUS)0xC0000151)
#define STATUS_MEMBER_NOT_IN_ALIAS       ((NTSTATUS)0xC0000152)
#define STATUS_MEMBER_IN_ALIAS           ((NTSTATUS)0xC0000153)
#define STATUS_ALIAS_EXISTS              ((NTSTATUS)0xC0000154)
#define STATUS_LOGON_NOT_GRANTED         ((NTSTATUS)0xC0000155)
#define STATUS_TOO_MANY_SECRETS          ((NTSTATUS)0xC0000156)
#define STATUS_SECRET_TOO_LONG           ((NTSTATUS)0xC0000157)
#define STATUS_INTERNAL_DB_ERROR         ((NTSTATUS)0xC0000158)
#define STATUS_FULLSCREEN_MODE           ((NTSTATUS)0xC0000159)
#define STATUS_TOO_MANY_CONTEXT_IDS      ((NTSTATUS)0xC000015A)
#define STATUS_LOGON_TYPE_NOT_GRANTED    ((NTSTATUS)0xC000015B)
#define STATUS_NOT_REGISTRY_FILE         ((NTSTATUS)0xC000015C)
#define STATUS_NT_CROSS_ENCRYPTION_REQUIRED ((NTSTATUS)0xC000015D)
#define STATUS_DOMAIN_CTRLR_CONFIG_ERROR ((NTSTATUS)0xC000015E)
#define STATUS_FT_MISSING_MEMBER         ((NTSTATUS)0xC000015F)
#define STATUS_ILL_FORMED_SERVICE_ENTRY  ((NTSTATUS)0xC0000160)
#define STATUS_ILLEGAL_CHARACTER         ((NTSTATUS)0xC0000161)
#define STATUS_UNMAPPABLE_CHARACTER      ((NTSTATUS)0xC0000162)
#define STATUS_UNDEFINED_CHARACTER       ((NTSTATUS)0xC0000163)
#define STATUS_FLOPPY_VOLUME             ((NTSTATUS)0xC0000164)
#define STATUS_FLOPPY_ID_MARK_NOT_FOUND  ((NTSTATUS)0xC0000165)
#define STATUS_FLOPPY_WRONG_CYLINDER     ((NTSTATUS)0xC0000166)
#define STATUS_FLOPPY_UNKNOWN_ERROR      ((NTSTATUS)0xC0000167)
#define STATUS_FLOPPY_BAD_REGISTERS      ((NTSTATUS)0xC0000168)
#define STATUS_DISK_RECALIBRATE_FAILED   ((NTSTATUS)0xC0000169)
#define STATUS_DISK_OPERATION_FAILED     ((NTSTATUS)0xC000016A)
#define STATUS_DISK_RESET_FAILED         ((NTSTATUS)0xC000016B)
#define STATUS_SHARED_IRQ_BUSY           ((NTSTATUS)0xC000016C)
#define STATUS_FT_ORPHANING              ((NTSTATUS)0xC000016D)
#define STATUS_BIOS_FAILED_TO_CONNECT_INTERRUPT ((NTSTATUS)0xC000016E)

#define STATUS_PARTITION_FAILURE         ((NTSTATUS)0xC0000172)
#define STATUS_INVALID_BLOCK_LENGTH      ((NTSTATUS)0xC0000173)
#define STATUS_DEVICE_NOT_PARTITIONED    ((NTSTATUS)0xC0000174)
#define STATUS_UNABLE_TO_LOCK_MEDIA      ((NTSTATUS)0xC0000175)
#define STATUS_UNABLE_TO_UNLOAD_MEDIA    ((NTSTATUS)0xC0000176)
#define STATUS_EOM_OVERFLOW              ((NTSTATUS)0xC0000177)
#define STATUS_NO_MEDIA                  ((NTSTATUS)0xC0000178)
#define STATUS_NO_SUCH_MEMBER            ((NTSTATUS)0xC000017A)
#define STATUS_INVALID_MEMBER            ((NTSTATUS)0xC000017B)
#define STATUS_KEY_DELETED               ((NTSTATUS)0xC000017C)
#define STATUS_NO_LOG_SPACE              ((NTSTATUS)0xC000017D)
#define STATUS_TOO_MANY_SIDS             ((NTSTATUS)0xC000017E)
#define STATUS_LM_CROSS_ENCRYPTION_REQUIRED ((NTSTATUS)0xC000017F)
#define STATUS_KEY_HAS_CHILDREN          ((NTSTATUS)0xC0000180)
#define STATUS_CHILD_MUST_BE_VOLATILE    ((NTSTATUS)0xC0000181)
#define STATUS_DEVICE_CONFIGURATION_ERROR ((NTSTATUS)0xC0000182)
#define STATUS_DRIVER_INTERNAL_ERROR     ((NTSTATUS)0xC0000183)
#define STATUS_INVALID_DEVICE_STATE      ((NTSTATUS)0xC0000184)
#define STATUS_IO_DEVICE_ERROR           ((NTSTATUS)0xC0000185)
#define STATUS_DEVICE_PROTOCOL_ERROR     ((NTSTATUS)0xC0000186)
#define STATUS_BACKUP_CONTROLLER         ((NTSTATUS)0xC0000187)
#define STATUS_LOG_FILE_FULL             ((NTSTATUS)0xC0000188)
#define STATUS_TOO_LATE                  ((NTSTATUS)0xC0000189)
#define STATUS_NO_TRUST_LSA_SECRET       ((NTSTATUS)0xC000018A)
#define STATUS_NO_TRUST_SAM_ACCOUNT      ((NTSTATUS)0xC000018B)
#define STATUS_TRUSTED_DOMAIN_FAILURE    ((NTSTATUS)0xC000018C)
#define STATUS_TRUSTED_RELATIONSHIP_FAILURE ((NTSTATUS)0xC000018D)
#define STATUS_EVENTLOG_FILE_CORRUPT     ((NTSTATUS)0xC000018E)
#define STATUS_EVENTLOG_CANT_START       ((NTSTATUS)0xC000018F)
#define STATUS_TRUST_FAILURE             ((NTSTATUS)0xC0000190)
#define STATUS_MUTANT_LIMIT_EXCEEDED     ((NTSTATUS)0xC0000191)
#define STATUS_NETLOGON_NOT_STARTED      ((NTSTATUS)0xC0000192)
#define STATUS_ACCOUNT_EXPIRED           ((NTSTATUS)0xC0000193)
#define STATUS_POSSIBLE_DEADLOCK         ((NTSTATUS)0xC0000194)
#define STATUS_NETWORK_CREDENTIAL_CONFLICT ((NTSTATUS)0xC0000195)
#define STATUS_REMOTE_SESSION_LIMIT      ((NTSTATUS)0xC0000196)
#define STATUS_EVENTLOG_FILE_CHANGED     ((NTSTATUS)0xC0000197)
#define STATUS_NOLOGON_INTERDOMAIN_TRUST_ACCOUNT ((NTSTATUS)0xC0000198)
#define STATUS_NOLOGON_WORKSTATION_TRUST_ACCOUNT ((NTSTATUS)0xC0000199)
#define STATUS_NOLOGON_SERVER_TRUST_ACCOUNT ((NTSTATUS)0xC000019A)
#define STATUS_DOMAIN_TRUST_INCONSISTENT ((NTSTATUS)0xC000019B)
#define STATUS_FS_DRIVER_REQUIRED        ((NTSTATUS)0xC000019C)
#define STATUS_NO_USER_SESSION_KEY       ((NTSTATUS)0xC0000202)
#define STATUS_USER_SESSION_DELETED      ((NTSTATUS)0xC0000203)
#define STATUS_RESOURCE_LANG_NOT_FOUND   ((NTSTATUS)0xC0000204)
#define STATUS_INSUFF_SERVER_RESOURCES   ((NTSTATUS)0xC0000205)
#define STATUS_INVALID_BUFFER_SIZE       ((NTSTATUS)0xC0000206)
#define STATUS_INVALID_ADDRESS_COMPONENT ((NTSTATUS)0xC0000207)
#define STATUS_INVALID_ADDRESS_WILDCARD  ((NTSTATUS)0xC0000208)
#define STATUS_TOO_MANY_ADDRESSES        ((NTSTATUS)0xC0000209)
#define STATUS_ADDRESS_ALREADY_EXISTS    ((NTSTATUS)0xC000020A)
#define STATUS_ADDRESS_CLOSED            ((NTSTATUS)0xC000020B)
#define STATUS_CONNECTION_DISCONNECTED   ((NTSTATUS)0xC000020C)
#define STATUS_CONNECTION_RESET          ((NTSTATUS)0xC000020D)
#define STATUS_TOO_MANY_NODES            ((NTSTATUS)0xC000020E)
#define STATUS_TRANSACTION_ABORTED       ((NTSTATUS)0xC000020F)
#define STATUS_TRANSACTION_TIMED_OUT     ((NTSTATUS)0xC0000210)
#define STATUS_TRANSACTION_NO_RELEASE    ((NTSTATUS)0xC0000211)
#define STATUS_TRANSACTION_NO_MATCH      ((NTSTATUS)0xC0000212)
#define STATUS_TRANSACTION_RESPONDED     ((NTSTATUS)0xC0000213)
#define STATUS_TRANSACTION_INVALID_ID    ((NTSTATUS)0xC0000214)
#define STATUS_TRANSACTION_INVALID_TYPE  ((NTSTATUS)0xC0000215)
#define STATUS_NOT_SERVER_SESSION        ((NTSTATUS)0xC0000216)
#define STATUS_NOT_CLIENT_SESSION        ((NTSTATUS)0xC0000217)
#define STATUS_CANNOT_LOAD_REGISTRY_FILE ((NTSTATUS)0xC0000218)
#define STATUS_DEBUG_ATTACH_FAILED       ((NTSTATUS)0xC0000219)
#define STATUS_SYSTEM_PROCESS_TERMINATED ((NTSTATUS)0xC000021A)
#define STATUS_DATA_NOT_ACCEPTED         ((NTSTATUS)0xC000021B)
#define STATUS_NO_BROWSER_SERVERS_FOUND  ((NTSTATUS)0xC000021C)
#define STATUS_VDM_HARD_ERROR            ((NTSTATUS)0xC000021D)
#define STATUS_DRIVER_CANCEL_TIMEOUT     ((NTSTATUS)0xC000021E)
#define STATUS_REPLY_MESSAGE_MISMATCH    ((NTSTATUS)0xC000021F)
#define STATUS_MAPPED_ALIGNMENT          ((NTSTATUS)0xC0000220)
#define STATUS_IMAGE_CHECKSUM_MISMATCH   ((NTSTATUS)0xC0000221)
#define STATUS_LOST_WRITEBEHIND_DATA     ((NTSTATUS)0xC0000222)
#define STATUS_CLIENT_SERVER_PARAMETERS_INVALID ((NTSTATUS)0xC0000223)
#define STATUS_PASSWORD_MUST_CHANGE      ((NTSTATUS)0xC0000224)
#define STATUS_NOT_FOUND                 ((NTSTATUS)0xC0000225)
#define STATUS_NOT_TINY_STREAM           ((NTSTATUS)0xC0000226)
#define STATUS_RECOVERY_FAILURE          ((NTSTATUS)0xC0000227)
#define STATUS_STACK_OVERFLOW_READ       ((NTSTATUS)0xC0000228)
#define STATUS_FAIL_CHECK                ((NTSTATUS)0xC0000229)
#define STATUS_DUPLICATE_OBJECTID        ((NTSTATUS)0xC000022A)
#define STATUS_OBJECTID_EXISTS           ((NTSTATUS)0xC000022B)
#define STATUS_CONVERT_TO_LARGE          ((NTSTATUS)0xC000022C)
#define STATUS_RETRY                     ((NTSTATUS)0xC000022D)
#define STATUS_FOUND_OUT_OF_SCOPE        ((NTSTATUS)0xC000022E)
#define STATUS_ALLOCATE_BUCKET           ((NTSTATUS)0xC000022F)
#define STATUS_PROPSET_NOT_FOUND         ((NTSTATUS)0xC0000230)
#define STATUS_MARSHALL_OVERFLOW         ((NTSTATUS)0xC0000231)
#define STATUS_INVALID_VARIANT           ((NTSTATUS)0xC0000232)
#define STATUS_DOMAIN_CONTROLLER_NOT_FOUND ((NTSTATUS)0xC0000233)
#define STATUS_ACCOUNT_LOCKED_OUT        ((NTSTATUS)0xC0000234)
#define STATUS_HANDLE_NOT_CLOSABLE       ((NTSTATUS)0xC0000235)
#define STATUS_CONNECTION_REFUSED        ((NTSTATUS)0xC0000236)
#define STATUS_GRACEFUL_DISCONNECT       ((NTSTATUS)0xC0000237)
#define STATUS_ADDRESS_ALREADY_ASSOCIATED ((NTSTATUS)0xC0000238)
#define STATUS_ADDRESS_NOT_ASSOCIATED    ((NTSTATUS)0xC0000239)
#define STATUS_CONNECTION_INVALID        ((NTSTATUS)0xC000023A)
#define STATUS_CONNECTION_ACTIVE         ((NTSTATUS)0xC000023B)
#define STATUS_NETWORK_UNREACHABLE       ((NTSTATUS)0xC000023C)
#define STATUS_HOST_UNREACHABLE          ((NTSTATUS)0xC000023D)
#define STATUS_PROTOCOL_UNREACHABLE      ((NTSTATUS)0xC000023E)
#define STATUS_PORT_UNREACHABLE          ((NTSTATUS)0xC000023F)
#define STATUS_REQUEST_ABORTED           ((NTSTATUS)0xC0000240)
#define STATUS_CONNECTION_ABORTED        ((NTSTATUS)0xC0000241)
#define STATUS_BAD_COMPRESSION_BUFFER    ((NTSTATUS)0xC0000242)
#define STATUS_USER_MAPPED_FILE          ((NTSTATUS)0xC0000243)
#define STATUS_AUDIT_FAILED              ((NTSTATUS)0xC0000244)
#define STATUS_TIMER_RESOLUTION_NOT_SET  ((NTSTATUS)0xC0000245)
#define STATUS_CONNECTION_COUNT_LIMIT    ((NTSTATUS)0xC0000246)
#define STATUS_LOGIN_TIME_RESTRICTION    ((NTSTATUS)0xC0000247)
#define STATUS_LOGIN_WKSTA_RESTRICTION   ((NTSTATUS)0xC0000248)
#define STATUS_IMAGE_MP_UP_MISMATCH      ((NTSTATUS)0xC0000249)
#define STATUS_INSUFFICIENT_LOGON_INFO   ((NTSTATUS)0xC0000250)
#define STATUS_BAD_DLL_ENTRYPOINT        ((NTSTATUS)0xC0000251)
#define STATUS_BAD_SERVICE_ENTRYPOINT    ((NTSTATUS)0xC0000252)
#define STATUS_LPC_REPLY_LOST            ((NTSTATUS)0xC0000253)
#define STATUS_IP_ADDRESS_CONFLICT1      ((NTSTATUS)0xC0000254)
#define STATUS_IP_ADDRESS_CONFLICT2      ((NTSTATUS)0xC0000255)
#define STATUS_REGISTRY_QUOTA_LIMIT      ((NTSTATUS)0xC0000256)
#define STATUS_PATH_NOT_COVERED          ((NTSTATUS)0xC0000257)
#define STATUS_NO_CALLBACK_ACTIVE        ((NTSTATUS)0xC0000258)
#define STATUS_LICENSE_QUOTA_EXCEEDED    ((NTSTATUS)0xC0000259)
#define STATUS_PWD_TOO_SHORT             ((NTSTATUS)0xC000025A)
#define STATUS_PWD_TOO_RECENT            ((NTSTATUS)0xC000025B)
#define STATUS_PWD_HISTORY_CONFLICT      ((NTSTATUS)0xC000025C)
#define STATUS_PLUGPLAY_NO_DEVICE        ((NTSTATUS)0xC000025E)
#define STATUS_UNSUPPORTED_COMPRESSION   ((NTSTATUS)0xC000025F)
#define STATUS_INVALID_HW_PROFILE        ((NTSTATUS)0xC0000260)
#define STATUS_INVALID_PLUGPLAY_DEVICE_PATH ((NTSTATUS)0xC0000261)
#define STATUS_DRIVER_ORDINAL_NOT_FOUND  ((NTSTATUS)0xC0000262)
#define STATUS_DRIVER_ENTRYPOINT_NOT_FOUND ((NTSTATUS)0xC0000263)
#define STATUS_RESOURCE_NOT_OWNED        ((NTSTATUS)0xC0000264)
#define STATUS_TOO_MANY_LINKS            ((NTSTATUS)0xC0000265)
#define STATUS_QUOTA_LIST_INCONSISTENT   ((NTSTATUS)0xC0000266)
#define STATUS_FILE_IS_OFFLINE           ((NTSTATUS)0xC0000267)
#define STATUS_EVALUATION_EXPIRATION     ((NTSTATUS)0xC0000268)
#define STATUS_ILLEGAL_DLL_RELOCATION    ((NTSTATUS)0xC0000269)
#define STATUS_LICENSE_VIOLATION         ((NTSTATUS)0xC000026A)
#define STATUS_DLL_INIT_FAILED_LOGOFF    ((NTSTATUS)0xC000026B)
#define STATUS_DRIVER_UNABLE_TO_LOAD     ((NTSTATUS)0xC000026C)
#define STATUS_DFS_UNAVAILABLE           ((NTSTATUS)0xC000026D)
#define STATUS_VOLUME_DISMOUNTED         ((NTSTATUS)0xC000026E)
#define STATUS_WX86_INTERNAL_ERROR       ((NTSTATUS)0xC000026F)
#define STATUS_WX86_FLOAT_STACK_CHECK    ((NTSTATUS)0xC0000270)
#define STATUS_VALIDATE_CONTINUE         ((NTSTATUS)0xC0000271)
#define STATUS_NO_MATCH                  ((NTSTATUS)0xC0000272)
#define STATUS_NO_MORE_MATCHES           ((NTSTATUS)0xC0000273)
#define STATUS_NOT_A_REPARSE_POINT       ((NTSTATUS)0xC0000275)
#define STATUS_IO_REPARSE_TAG_INVALID    ((NTSTATUS)0xC0000276)
#define STATUS_IO_REPARSE_TAG_MISMATCH   ((NTSTATUS)0xC0000277)
#define STATUS_IO_REPARSE_DATA_INVALID   ((NTSTATUS)0xC0000278)
#define STATUS_IO_REPARSE_TAG_NOT_HANDLED       ((NTSTATUS)0xC0000279)
#define STATUS_REPARSE_POINT_NOT_RESOLVED       ((NTSTATUS)0xC0000280)
#define STATUS_DIRECTORY_IS_A_REPARSE_POINT     ((NTSTATUS)0xC0000281)
#define STATUS_RANGE_LIST_CONFLICT       ((NTSTATUS)0xC0000282)
#define STATUS_SOURCE_ELEMENT_EMPTY      ((NTSTATUS)0xC0000283)
#define STATUS_DESTINATION_ELEMENT_FULL  ((NTSTATUS)0xC0000284)
#define STATUS_ILLEGAL_ELEMENT_ADDRESS   ((NTSTATUS)0xC0000285)
#define STATUS_MAGAZINE_NOT_PRESENT      ((NTSTATUS)0xC0000286)
#define STATUS_REINITIALIZATION_NEEDED   ((NTSTATUS)0xC0000287)
#define STATUS_ENCRYPTION_FAILED         ((NTSTATUS)0xC000028A)
#define STATUS_DECRYPTION_FAILED         ((NTSTATUS)0xC000028B)
#define STATUS_RANGE_NOT_FOUND           ((NTSTATUS)0xC000028C)
#define STATUS_NO_RECOVERY_POLICY        ((NTSTATUS)0xC000028D)
#define STATUS_NO_EFS                    ((NTSTATUS)0xC000028E)
#define STATUS_WRONG_EFS                 ((NTSTATUS)0xC000028F)
#define STATUS_NO_USER_KEYS              ((NTSTATUS)0xC0000290)
#define STATUS_FILE_NOT_ENCRYPTED        ((NTSTATUS)0xC0000291)
#define STATUS_NOT_EXPORT_FORMAT         ((NTSTATUS)0xC0000292)
#define STATUS_FILE_ENCRYPTED            ((NTSTATUS)0xC0000293)
#define STATUS_WMI_GUID_NOT_FOUND        ((NTSTATUS)0xC0000295)
#define STATUS_WMI_INSTANCE_NOT_FOUND    ((NTSTATUS)0xC0000296)
#define STATUS_WMI_ITEMID_NOT_FOUND      ((NTSTATUS)0xC0000297)
#define STATUS_WMI_TRY_AGAIN             ((NTSTATUS)0xC0000298)
#define STATUS_SHARED_POLICY             ((NTSTATUS)0xC0000299)
#define STATUS_POLICY_OBJECT_NOT_FOUND   ((NTSTATUS)0xC000029A)
#define STATUS_POLICY_ONLY_IN_DS         ((NTSTATUS)0xC000029B)
#define STATUS_VOLUME_NOT_UPGRADED       ((NTSTATUS)0xC000029C)
#define STATUS_REMOTE_STORAGE_NOT_ACTIVE ((NTSTATUS)0xC000029D)
#define STATUS_REMOTE_STORAGE_MEDIA_ERROR       ((NTSTATUS)0xC000029E)
#define STATUS_NO_TRACKING_SERVICE       ((NTSTATUS)0xC000029F)
#define STATUS_SERVER_SID_MISMATCH       ((NTSTATUS)0xC00002A0)
#define STATUS_DS_NO_ATTRIBUTE_OR_VALUE  ((NTSTATUS)0xC00002A1)
#define STATUS_DS_INVALID_ATTRIBUTE_SYNTAX      ((NTSTATUS)0xC00002A2)
#define STATUS_DS_ATTRIBUTE_TYPE_UNDEFINED      ((NTSTATUS)0xC00002A3)
#define STATUS_DS_ATTRIBUTE_OR_VALUE_EXISTS     ((NTSTATUS)0xC00002A4)
#define STATUS_DS_BUSY                   ((NTSTATUS)0xC00002A5)
#define STATUS_DS_UNAVAILABLE            ((NTSTATUS)0xC00002A6)
#define STATUS_DS_NO_RIDS_ALLOCATED      ((NTSTATUS)0xC00002A7)
#define STATUS_DS_NO_MORE_RIDS           ((NTSTATUS)0xC00002A8)
#define STATUS_DS_INCORRECT_ROLE_OWNER   ((NTSTATUS)0xC00002A9)
#define STATUS_DS_RIDMGR_INIT_ERROR      ((NTSTATUS)0xC00002AA)
#define STATUS_DS_OBJ_CLASS_VIOLATION    ((NTSTATUS)0xC00002AB)
#define STATUS_DS_CANT_ON_NON_LEAF       ((NTSTATUS)0xC00002AC)
#define STATUS_DS_CANT_ON_RDN            ((NTSTATUS)0xC00002AD)
#define STATUS_DS_CANT_MOD_OBJ_CLASS     ((NTSTATUS)0xC00002AE)
#define STATUS_DS_CROSS_DOM_MOVE_FAILED  ((NTSTATUS)0xC00002AF)
#define STATUS_DS_GC_NOT_AVAILABLE       ((NTSTATUS)0xC00002B0)
#define STATUS_DIRECTORY_SERVICE_REQUIRED       ((NTSTATUS)0xC00002B1)
#define STATUS_REPARSE_ATTRIBUTE_CONFLICT       ((NTSTATUS)0xC00002B2)
#define STATUS_CANT_ENABLE_DENY_ONLY     ((NTSTATUS)0xC00002B3)
#define STATUS_DEVICE_REMOVED            ((NTSTATUS)0xC00002B6)
#define STATUS_JOURNAL_DELETE_IN_PROGRESS       ((NTSTATUS)0xC00002B7)
#define STATUS_JOURNAL_NOT_ACTIVE        ((NTSTATUS)0xC00002B8)
#define STATUS_NOINTERFACE               ((NTSTATUS)0xC00002B9)
#define STATUS_DS_ADMIN_LIMIT_EXCEEDED   ((NTSTATUS)0xC00002C1)
#define STATUS_DRIVER_FAILED_SLEEP       ((NTSTATUS)0xC00002C2)
#define STATUS_MUTUAL_AUTHENTICATION_FAILED     ((NTSTATUS)0xC00002C3)
#define STATUS_CORRUPT_SYSTEM_FILE       ((NTSTATUS)0xC00002C4)
#define STATUS_DATATYPE_MISALIGNMENT_ERROR      ((NTSTATUS)0xC00002C5)
#define STATUS_WMI_READ_ONLY             ((NTSTATUS)0xC00002C6)
#define STATUS_WMI_SET_FAILURE           ((NTSTATUS)0xC00002C7)
#define STATUS_COMMITMENT_MINIMUM        ((NTSTATUS)0xC00002C8)
#define STATUS_TRANSPORT_FULL            ((NTSTATUS)0xC00002CA)
#define STATUS_DS_SAM_INIT_FAILURE       ((NTSTATUS)0xC00002CB)
#define STATUS_ONLY_IF_CONNECTED         ((NTSTATUS)0xC00002CC)
#define STATUS_DS_SENSITIVE_GROUP_VIOLATION     ((NTSTATUS)0xC00002CD)
#define STATUS_PNP_RESTART_ENUMERATION   ((NTSTATUS)0xC00002CE)
#define STATUS_JOURNAL_ENTRY_DELETED     ((NTSTATUS)0xC00002CF)
#define STATUS_DS_CANT_MOD_PRIMARYGROUPID       ((NTSTATUS)0xC00002D0)
#define STATUS_SYSTEM_IMAGE_BAD_SIGNATURE ((NTSTATUS)0xC00002D1)
#define STATUS_PNP_REBOOT_REQUIRED       ((NTSTATUS)0xC00002D2)
#define STATUS_POWER_STATE_INVALID       ((NTSTATUS)0xC00002D3)
#define STATUS_DS_INVALID_GROUP_TYPE     ((NTSTATUS)0xC00002D4)
#define STATUS_DS_NO_NEST_GLOBALGROUP_IN_MIXEDDOMAIN    ((NTSTATUS)0xC00002D5)
#define STATUS_DS_NO_NEST_LOCALGROUP_IN_MIXEDDOMAIN     ((NTSTATUS)0xC00002D6)
#define STATUS_DS_GLOBAL_CANT_HAVE_LOCAL_MEMBER ((NTSTATUS)0xC00002D7)
#define STATUS_DS_GLOBAL_CANT_HAVE_UNIVERSAL_MEMBER     ((NTSTATUS)0xC00002D8)
#define STATUS_DS_UNIVERSAL_CANT_HAVE_LOCAL_MEMBER      ((NTSTATUS)0xC00002D9)
#define STATUS_DS_GLOBAL_CANT_HAVE_CROSSDOMAIN_MEMBER   ((NTSTATUS)0xC00002DA)
#define STATUS_DS_LOCAL_CANT_HAVE_CROSSDOMAIN_LOCAL_MEMBER      ((NTSTATUS)0xC00002DB)
#define STATUS_DS_HAVE_PRIMARY_MEMBERS   ((NTSTATUS)0xC00002DC)
#define STATUS_WMI_NOT_SUPPORTED         ((NTSTATUS)0xC00002DD)
#define STATUS_INSUFFICIENT_POWER        ((NTSTATUS)0xC00002DE)
#define STATUS_SAM_NEED_BOOTKEY_PASSWORD ((NTSTATUS)0xC00002DF)
#define STATUS_SAM_NEED_BOOTKEY_FLOPPY   ((NTSTATUS)0xC00002E0)
#define STATUS_DS_CANT_START             ((NTSTATUS)0xC00002E1)
#define STATUS_DS_INIT_FAILURE           ((NTSTATUS)0xC00002E2)
#define STATUS_SAM_INIT_FAILURE          ((NTSTATUS)0xC00002E3)
#define STATUS_DS_GC_REQUIRED            ((NTSTATUS)0xC00002E4)
#define STATUS_DS_LOCAL_MEMBER_OF_LOCAL_ONLY    ((NTSTATUS)0xC00002E5)
#define STATUS_DS_NO_FPO_IN_UNIVERSAL_GROUPS    ((NTSTATUS)0xC00002E6)
#define STATUS_DS_MACHINE_ACCOUNT_QUOTA_EXCEEDED        ((NTSTATUS)0xC00002E7)
#define STATUS_MULTIPLE_FAULT_VIOLATION  ((NTSTATUS)0xC00002E8)
#define STATUS_CURRENT_DOMAIN_NOT_ALLOWED       ((NTSTATUS)0xC00002E9)
#define STATUS_CANNOT_MAKE               ((NTSTATUS)0xC00002EA)
#define STATUS_SYSTEM_SHUTDOWN           ((NTSTATUS)0xC00002EB)
#define STATUS_DS_INIT_FAILURE_CONSOLE   ((NTSTATUS)0xC00002EC)
#define STATUS_DS_SAM_INIT_FAILURE_CONSOLE      ((NTSTATUS)0xC00002ED)
#define STATUS_UNFINISHED_CONTEXT_DELETED       ((NTSTATUS)0xC00002EE)
#define STATUS_NO_TGT_REPLY              ((NTSTATUS)0xC00002EF)
#define STATUS_OBJECTID_NOT_FOUND        ((NTSTATUS)0xC00002F0)
#define STATUS_NO_IP_ADDRESSES           ((NTSTATUS)0xC00002F1)
#define STATUS_WRONG_CREDENTIAL_HANDLE   ((NTSTATUS)0xC00002F2)
#define STATUS_CRYPTO_SYSTEM_INVALID     ((NTSTATUS)0xC00002F3)
#define STATUS_MAX_REFERRALS_EXCEEDED    ((NTSTATUS)0xC00002F4)
#define STATUS_MUST_BE_KDC               ((NTSTATUS)0xC00002F5)
#define STATUS_STRONG_CRYPTO_NOT_SUPPORTED      ((NTSTATUS)0xC00002F6)
#define STATUS_TOO_MANY_PRINCIPALS       ((NTSTATUS)0xC00002F7)
#define STATUS_NO_PA_DATA                ((NTSTATUS)0xC00002F8)
#define STATUS_PKINIT_NAME_MISMATCH      ((NTSTATUS)0xC00002F9)
#define STATUS_SMARTCARD_LOGON_REQUIRED  ((NTSTATUS)0xC00002FA)
#define STATUS_KDC_INVALID_REQUEST       ((NTSTATUS)0xC00002FB)
#define STATUS_KDC_UNABLE_TO_REFER       ((NTSTATUS)0xC00002FC)
#define STATUS_KDC_UNKNOWN_ETYPE         ((NTSTATUS)0xC00002FD)
#define STATUS_SHUTDOWN_IN_PROGRESS      ((NTSTATUS)0xC00002FE)
#define STATUS_SERVER_SHUTDOWN_IN_PROGRESS      ((NTSTATUS)0xC00002FF)
#define STATUS_NOT_SUPPORTED_ON_SBS      ((NTSTATUS)0xC0000300)
#define STATUS_WMI_GUID_DISCONNECTED     ((NTSTATUS)0xC0000301)
#define STATUS_WMI_ALREADY_DISABLED      ((NTSTATUS)0xC0000302)
#define STATUS_WMI_ALREADY_ENABLED       ((NTSTATUS)0xC0000303)
#define STATUS_MFT_TOO_FRAGMENTED        ((NTSTATUS)0xC0000304)
#define STATUS_COPY_PROTECTION_FAILURE   ((NTSTATUS)0xC0000305)
#define STATUS_CSS_AUTHENTICATION_FAILURE       ((NTSTATUS)0xC0000306)
#define STATUS_CSS_KEY_NOT_PRESENT       ((NTSTATUS)0xC0000307)
#define STATUS_CSS_KEY_NOT_ESTABLISHED   ((NTSTATUS)0xC0000308)
#define STATUS_CSS_SCRAMBLED_SECTOR      ((NTSTATUS)0xC0000309)
#define STATUS_CSS_REGION_MISMATCH       ((NTSTATUS)0xC000030A)
#define STATUS_CSS_RESETS_EXHAUSTED      ((NTSTATUS)0xC000030B)
#define STATUS_PKINIT_FAILURE            ((NTSTATUS)0xC0000320)
#define STATUS_SMARTCARD_SUBSYSTEM_FAILURE      ((NTSTATUS)0xC0000321)
#define STATUS_NO_KERB_KEY               ((NTSTATUS)0xC0000322)
#define STATUS_HOST_DOWN                 ((NTSTATUS)0xC0000350)
#define STATUS_UNSUPPORTED_PREAUTH       ((NTSTATUS)0xC0000351)
#define STATUS_EFS_ALG_BLOB_TOO_BIG      ((NTSTATUS)0xC0000352)
#define STATUS_PORT_NOT_SET              ((NTSTATUS)0xC0000353)
#define STATUS_DEBUGGER_INACTIVE         ((NTSTATUS)0xC0000354)
#define STATUS_DS_VERSION_CHECK_FAILURE  ((NTSTATUS)0xC0000355)
#define STATUS_AUDITING_DISABLED         ((NTSTATUS)0xC0000356)
#define STATUS_PRENT4_MACHINE_ACCOUNT    ((NTSTATUS)0xC0000357)
#define STATUS_DS_AG_CANT_HAVE_UNIVERSAL_MEMBER ((NTSTATUS)0xC0000358)
#define STATUS_INVALID_IMAGE_WIN_32      ((NTSTATUS)0xC0000359)
#define STATUS_INVALID_IMAGE_WIN_64      ((NTSTATUS)0xC000035A)
#define STATUS_BAD_BINDINGS              ((NTSTATUS)0xC000035B)
#define STATUS_NETWORK_SESSION_EXPIRED   ((NTSTATUS)0xC000035C)
#define STATUS_APPHELP_BLOCK             ((NTSTATUS)0xC000035D)
#define STATUS_ALL_SIDS_FILTERED         ((NTSTATUS)0xC000035E)
#define STATUS_NOT_SAFE_MODE_DRIVER      ((NTSTATUS)0xC000035F)
#define STATUS_ACCESS_DISABLED_BY_POLICY_DEFAULT        ((NTSTATUS)0xC0000361)
#define STATUS_ACCESS_DISABLED_BY_POLICY_PATH   ((NTSTATUS)0xC0000362)
#define STATUS_ACCESS_DISABLED_BY_POLICY_PUBLISHER      ((NTSTATUS)0xC0000363)
#define STATUS_ACCESS_DISABLED_BY_POLICY_OTHER  ((NTSTATUS)0xC0000364)
#define STATUS_FAILED_DRIVER_ENTRY       ((NTSTATUS)0xC0000365)
#define STATUS_DEVICE_ENUMERATION_ERROR  ((NTSTATUS)0xC0000366)
#define STATUS_WAIT_FOR_OPLOCK           ((NTSTATUS)0x00000367)
#define STATUS_MOUNT_POINT_NOT_RESOLVED  ((NTSTATUS)0xC0000368)
#define STATUS_INVALID_DEVICE_OBJECT_PARAMETER ((NTSTATUS)0xC0000369)
#define STATUS_MCA_OCCURED               ((NTSTATUS)0xC000036A)
#define STATUS_DRIVER_BLOCKED_CRITICAL   ((NTSTATUS)0xC000036B)
#define STATUS_DRIVER_BLOCKED            ((NTSTATUS)0xC000036C)
#define STATUS_DRIVER_DATABASE_ERROR     ((NTSTATUS)0xC000036D)
#define STATUS_SYSTEM_HIVE_TOO_LARGE     ((NTSTATUS)0xC000036E)
#define STATUS_INVALID_IMPORT_OF_NON_DLL ((NTSTATUS)0xC000036F)
#define STATUS_SMARTCARD_WRONG_PIN       ((NTSTATUS)0xC0000380)
#define STATUS_SMARTCARD_CARD_BLOCKED    ((NTSTATUS)0xC0000381)
#define STATUS_SMARTCARD_CARD_NOT_AUTHENTICATED ((NTSTATUS)0xC0000382)
#define STATUS_SMARTCARD_NO_CARD         ((NTSTATUS)0xC0000383)
#define STATUS_SMARTCARD_NO_KEY_CONTAINER       ((NTSTATUS)0xC0000384)
#define STATUS_SMARTCARD_NO_CERTIFICATE  ((NTSTATUS)0xC0000385)
#define STATUS_SMARTCARD_NO_KEYSET       ((NTSTATUS)0xC0000386)
#define STATUS_SMARTCARD_IO_ERROR        ((NTSTATUS)0xC0000387)
#define STATUS_DOWNGRADE_DETECTED        ((NTSTATUS)0xC0000388)
#define STATUS_SMARTCARD_CERT_REVOKED    ((NTSTATUS)0xC0000389)
#define STATUS_ISSUING_CA_UNTRUSTED      ((NTSTATUS)0xC000038A)
#define STATUS_REVOCATION_OFFLINE_C      ((NTSTATUS)0xC000038B)
#define STATUS_PKINIT_CLIENT_FAILURE     ((NTSTATUS)0xC000038C)
#define STATUS_SMARTCARD_CERT_EXPIRED    ((NTSTATUS)0xC000038D)
#define STATUS_DRIVER_FAILED_PRIOR_UNLOAD ((NTSTATUS)0xC000038E)
#define STATUS_SMARTCARD_SILENT_CONTEXT  ((NTSTATUS)0xC000038F)
#define STATUS_PER_USER_TRUST_QUOTA_EXCEEDED ((NTSTATUS)0xC0000401)
#define STATUS_ALL_USER_TRUST_QUOTA_EXCEEDED ((NTSTATUS)0xC0000402)
#define STATUS_USER_DELETE_TRUST_QUOTA_EXCEEDED ((NTSTATUS)0xC0000403)
#define STATUS_DS_NAME_NOT_UNIQUE        ((NTSTATUS)0xC0000404)
#define STATUS_DS_DUPLICATE_ID_FOUND     ((NTSTATUS)0xC0000405)
#define STATUS_DS_GROUP_CONVERSION_ERROR ((NTSTATUS)0xC0000406)
#define STATUS_VOLSNAP_PREPARE_HIBERNATE ((NTSTATUS)0xC0000407)
#define STATUS_USER2USER_REQUIRED        ((NTSTATUS)0xC0000408)
#define STATUS_STACK_BUFFER_OVERRUN      ((NTSTATUS)0xC0000409)
#define STATUS_NO_S4U_PROT_SUPPORT       ((NTSTATUS)0xC000040A)
#define STATUS_CROSSREALM_DELEGATION_FAILURE ((NTSTATUS)0xC000040B)
#define STATUS_REVOCATION_OFFLINE_KDC    ((NTSTATUS)0xC000040C)
#define STATUS_ISSUING_CA_UNTRUSTED_KDC  ((NTSTATUS)0xC000040D)
#define STATUS_KDC_CERT_EXPIRED          ((NTSTATUS)0xC000040E)
#define STATUS_KDC_CERT_REVOKED          ((NTSTATUS)0xC000040F)
#define STATUS_PARAMETER_QUOTA_EXCEEDED  ((NTSTATUS)0xC0000410)
#define STATUS_HIBERNATION_FAILURE       ((NTSTATUS)0xC0000411)
#define STATUS_DELAY_LOAD_FAILED         ((NTSTATUS)0xC0000412)
#define STATUS_AUTHENTICATION_FIREWALL_FAILED ((NTSTATUS)0xC0000413)
#define STATUS_VDM_DISALLOWED            ((NTSTATUS)0xC0000414)
#define STATUS_HUNG_DISPLAY_DRIVER_THREAD ((NTSTATUS)0xC0000415)
#define STATUS_WOW_ASSERTION             ((NTSTATUS)0xC0009898)

#define RPC_NT_INVALID_STRING_BINDING    ((NTSTATUS)0xC0020001)
#define RPC_NT_WRONG_KIND_OF_BINDING     ((NTSTATUS)0xC0020002)
#define RPC_NT_INVALID_BINDING           ((NTSTATUS)0xC0020003)
#define RPC_NT_PROTSEQ_NOT_SUPPORTED     ((NTSTATUS)0xC0020004)
#define RPC_NT_INVALID_RPC_PROTSEQ       ((NTSTATUS)0xC0020005)
#define RPC_NT_INVALID_STRING_UUID       ((NTSTATUS)0xC0020006)
#define RPC_NT_INVALID_ENDPOINT_FORMAT   ((NTSTATUS)0xC0020007)
#define RPC_NT_INVALID_NET_ADDR          ((NTSTATUS)0xC0020008)
#define RPC_NT_NO_ENDPOINT_FOUND         ((NTSTATUS)0xC0020009)
#define RPC_NT_INVALID_TIMEOUT           ((NTSTATUS)0xC002000A)
#define RPC_NT_OBJECT_NOT_FOUND          ((NTSTATUS)0xC002000B)
#define RPC_NT_ALREADY_REGISTERED        ((NTSTATUS)0xC002000C)
#define RPC_NT_TYPE_ALREADY_REGISTERED   ((NTSTATUS)0xC002000D)
#define RPC_NT_ALREADY_LISTENING         ((NTSTATUS)0xC002000E)
#define RPC_NT_NO_PROTSEQS_REGISTERED    ((NTSTATUS)0xC002000F)
#define RPC_NT_NOT_LISTENING             ((NTSTATUS)0xC0020010)
#define RPC_NT_UNKNOWN_MGR_TYPE          ((NTSTATUS)0xC0020011)
#define RPC_NT_UNKNOWN_IF                ((NTSTATUS)0xC0020012)
#define RPC_NT_NO_BINDINGS               ((NTSTATUS)0xC0020013)
#define RPC_NT_NO_PROTSEQS               ((NTSTATUS)0xC0020014)
#define RPC_NT_CANT_CREATE_ENDPOINT      ((NTSTATUS)0xC0020015)
#define RPC_NT_OUT_OF_RESOURCES          ((NTSTATUS)0xC0020016)
#define RPC_NT_SERVER_UNAVAILABLE        ((NTSTATUS)0xC0020017)
#define RPC_NT_SERVER_TOO_BUSY           ((NTSTATUS)0xC0020018)
#define RPC_NT_INVALID_NETWORK_OPTIONS   ((NTSTATUS)0xC0020019)
#define RPC_NT_NO_CALL_ACTIVE            ((NTSTATUS)0xC002001A)
#define RPC_NT_CALL_FAILED               ((NTSTATUS)0xC002001B)
#define RPC_NT_CALL_FAILED_DNE           ((NTSTATUS)0xC002001C)
#define RPC_NT_PROTOCOL_ERROR            ((NTSTATUS)0xC002001D)
#define RPC_NT_UNSUPPORTED_TRANS_SYN     ((NTSTATUS)0xC002001F)
#define RPC_NT_UNSUPPORTED_TYPE          ((NTSTATUS)0xC0020021)
#define RPC_NT_INVALID_TAG               ((NTSTATUS)0xC0020022)
#define RPC_NT_INVALID_BOUND             ((NTSTATUS)0xC0020023)
#define RPC_NT_NO_ENTRY_NAME             ((NTSTATUS)0xC0020024)
#define RPC_NT_INVALID_NAME_SYNTAX       ((NTSTATUS)0xC0020025)
#define RPC_NT_UNSUPPORTED_NAME_SYNTAX   ((NTSTATUS)0xC0020026)
#define RPC_NT_UUID_NO_ADDRESS           ((NTSTATUS)0xC0020028)
#define RPC_NT_DUPLICATE_ENDPOINT        ((NTSTATUS)0xC0020029)
#define RPC_NT_UNKNOWN_AUTHN_TYPE        ((NTSTATUS)0xC002002A)
#define RPC_NT_MAX_CALLS_TOO_SMALL       ((NTSTATUS)0xC002002B)
#define RPC_NT_STRING_TOO_LONG           ((NTSTATUS)0xC002002C)
#define RPC_NT_PROTSEQ_NOT_FOUND         ((NTSTATUS)0xC002002D)
#define RPC_NT_PROCNUM_OUT_OF_RANGE      ((NTSTATUS)0xC002002E)
#define RPC_NT_BINDING_HAS_NO_AUTH       ((NTSTATUS)0xC002002F)
#define RPC_NT_UNKNOWN_AUTHN_SERVICE     ((NTSTATUS)0xC0020030)
#define RPC_NT_UNKNOWN_AUTHN_LEVEL       ((NTSTATUS)0xC0020031)
#define RPC_NT_INVALID_AUTH_IDENTITY     ((NTSTATUS)0xC0020032)
#define RPC_NT_UNKNOWN_AUTHZ_SERVICE     ((NTSTATUS)0xC0020033)
#define EPT_NT_INVALID_ENTRY             ((NTSTATUS)0xC0020034)
#define EPT_NT_CANT_PERFORM_OP           ((NTSTATUS)0xC0020035)
#define EPT_NT_NOT_REGISTERED            ((NTSTATUS)0xC0020036)
#define RPC_NT_NOTHING_TO_EXPORT         ((NTSTATUS)0xC0020037)
#define RPC_NT_INCOMPLETE_NAME           ((NTSTATUS)0xC0020038)
#define RPC_NT_INVALID_VERS_OPTION       ((NTSTATUS)0xC0020039)
#define RPC_NT_NO_MORE_MEMBERS           ((NTSTATUS)0xC002003A)
#define RPC_NT_NOT_ALL_OBJS_UNEXPORTED   ((NTSTATUS)0xC002003B)
#define RPC_NT_INTERFACE_NOT_FOUND       ((NTSTATUS)0xC002003C)
#define RPC_NT_ENTRY_ALREADY_EXISTS      ((NTSTATUS)0xC002003D)
#define RPC_NT_ENTRY_NOT_FOUND           ((NTSTATUS)0xC002003E)
#define RPC_NT_NAME_SERVICE_UNAVAILABLE  ((NTSTATUS)0xC002003F)
#define RPC_NT_INVALID_NAF_ID            ((NTSTATUS)0xC0020040)
#define RPC_NT_CANNOT_SUPPORT            ((NTSTATUS)0xC0020041)
#define RPC_NT_NO_CONTEXT_AVAILABLE      ((NTSTATUS)0xC0020042)
#define RPC_NT_INTERNAL_ERROR            ((NTSTATUS)0xC0020043)
#define RPC_NT_ZERO_DIVIDE               ((NTSTATUS)0xC0020044)
#define RPC_NT_ADDRESS_ERROR             ((NTSTATUS)0xC0020045)
#define RPC_NT_FP_DIV_ZERO               ((NTSTATUS)0xC0020046)
#define RPC_NT_FP_UNDERFLOW              ((NTSTATUS)0xC0020047)
#define RPC_NT_FP_OVERFLOW               ((NTSTATUS)0xC0020048)
#define RPC_NT_CALL_IN_PROGRESS          ((NTSTATUS)0xC0020049)
#define RPC_NT_NO_MORE_BINDINGS          ((NTSTATUS)0xC002004A)
#define RPC_NT_GROUP_MEMBER_NOT_FOUND    ((NTSTATUS)0xC002004B)
#define EPT_NT_CANT_CREATE               ((NTSTATUS)0xC002004C)
#define RPC_NT_INVALID_OBJECT            ((NTSTATUS)0xC002004D)
#define RPC_NT_NO_INTERFACES             ((NTSTATUS)0xC002004F)
#define RPC_NT_CALL_CANCELLED            ((NTSTATUS)0xC0020050)
#define RPC_NT_BINDING_INCOMPLETE        ((NTSTATUS)0xC0020051)
#define RPC_NT_COMM_FAILURE              ((NTSTATUS)0xC0020052)
#define RPC_NT_UNSUPPORTED_AUTHN_LEVEL   ((NTSTATUS)0xC0020053)
#define RPC_NT_NO_PRINC_NAME             ((NTSTATUS)0xC0020054)
#define RPC_NT_NOT_RPC_ERROR             ((NTSTATUS)0xC0020055)
#define RPC_NT_SEC_PKG_ERROR             ((NTSTATUS)0xC0020057)
#define RPC_NT_NOT_CANCELLED             ((NTSTATUS)0xC0020058)
#define RPC_NT_INVALID_ASYNC_HANDLE      ((NTSTATUS)0xC0020062)
#define RPC_NT_INVALID_ASYNC_CALL        ((NTSTATUS)0xC0020063)

#define RPC_NT_NO_MORE_ENTRIES           ((NTSTATUS)0xC0030001)
#define RPC_NT_SS_CHAR_TRANS_OPEN_FAIL   ((NTSTATUS)0xC0030002)
#define RPC_NT_SS_CHAR_TRANS_SHORT_FILE  ((NTSTATUS)0xC0030003)
#define RPC_NT_SS_IN_NULL_CONTEXT        ((NTSTATUS)0xC0030004)
#define RPC_NT_SS_CONTEXT_MISMATCH       ((NTSTATUS)0xC0030005)
#define RPC_NT_SS_CONTEXT_DAMAGED        ((NTSTATUS)0xC0030006)
#define RPC_NT_SS_HANDLES_MISMATCH       ((NTSTATUS)0xC0030007)
#define RPC_NT_SS_CANNOT_GET_CALL_HANDLE ((NTSTATUS)0xC0030008)
#define RPC_NT_NULL_REF_POINTER          ((NTSTATUS)0xC0030009)
#define RPC_NT_ENUM_VALUE_OUT_OF_RANGE   ((NTSTATUS)0xC003000A)
#define RPC_NT_BYTE_COUNT_TOO_SMALL      ((NTSTATUS)0xC003000B)
#define RPC_NT_BAD_STUB_DATA             ((NTSTATUS)0xC003000C)
#define RPC_NT_INVALID_ES_ACTION         ((NTSTATUS)0xC0030059)
#define RPC_NT_WRONG_ES_VERSION          ((NTSTATUS)0xC003005A)
#define RPC_NT_WRONG_STUB_VERSION        ((NTSTATUS)0xC003005B)
#define RPC_NT_INVALID_PIPE_OBJECT       ((NTSTATUS)0xC003005C)
#define RPC_NT_INVALID_PIPE_OPERATION    ((NTSTATUS)0xC003005D)
#define RPC_NT_WRONG_PIPE_VERSION        ((NTSTATUS)0xC003005E)
#define RPC_NT_PIPE_CLOSED               ((NTSTATUS)0xC003005F)
#define RPC_NT_PIPE_DISCIPLINE_ERROR     ((NTSTATUS)0xC0030060)
#define RPC_NT_PIPE_EMPTY                ((NTSTATUS)0xC0030061)

#define STATUS_PNP_BAD_MPS_TABLE         ((NTSTATUS)0xC0040035)
#define STATUS_PNP_TRANSLATION_FAILED    ((NTSTATUS)0xC0040036)
#define STATUS_PNP_IRQ_TRANSLATION_FAILED ((NTSTATUS)0xC0040037)
#define STATUS_PNP_INVALID_ID            ((NTSTATUS)0xC0040038)

#define STATUS_CTX_WINSTATION_NAME_INVALID      ((NTSTATUS)0xC00A0001)
#define STATUS_CTX_INVALID_PD            ((NTSTATUS)0xC00A0002)
#define STATUS_CTX_PD_NOT_FOUND          ((NTSTATUS)0xC00A0003)
#define STATUS_CTX_CLOSE_PENDING         ((NTSTATUS)0xC00A0006)
#define STATUS_CTX_NO_OUTBUF             ((NTSTATUS)0xC00A0007)
#define STATUS_CTX_MODEM_INF_NOT_FOUND   ((NTSTATUS)0xC00A0008)
#define STATUS_CTX_INVALID_MODEMNAME     ((NTSTATUS)0xC00A0009)
#define STATUS_CTX_RESPONSE_ERROR        ((NTSTATUS)0xC00A000A)
#define STATUS_CTX_MODEM_RESPONSE_TIMEOUT       ((NTSTATUS)0xC00A000B)
#define STATUS_CTX_MODEM_RESPONSE_NO_CARRIER    ((NTSTATUS)0xC00A000C)
#define STATUS_CTX_MODEM_RESPONSE_NO_DIALTONE   ((NTSTATUS)0xC00A000D)
#define STATUS_CTX_MODEM_RESPONSE_BUSY   ((NTSTATUS)0xC00A000E)
#define STATUS_CTX_MODEM_RESPONSE_VOICE  ((NTSTATUS)0xC00A000F)
#define STATUS_CTX_TD_ERROR              ((NTSTATUS)0xC00A0010)
#define STATUS_CTX_LICENSE_CLIENT_INVALID       ((NTSTATUS)0xC00A0012)
#define STATUS_CTX_LICENSE_NOT_AVAILABLE ((NTSTATUS)0xC00A0013)
#define STATUS_CTX_LICENSE_EXPIRED       ((NTSTATUS)0xC00A0014)
#define STATUS_CTX_WINSTATION_NOT_FOUND  ((NTSTATUS)0xC00A0015)
#define STATUS_CTX_WINSTATION_NAME_COLLISION    ((NTSTATUS)0xC00A0016)
#define STATUS_CTX_WINSTATION_BUSY       ((NTSTATUS)0xC00A0017)
#define STATUS_CTX_BAD_VIDEO_MODE        ((NTSTATUS)0xC00A0018)
#define STATUS_CTX_GRAPHICS_INVALID      ((NTSTATUS)0xC00A0022)
#define STATUS_CTX_NOT_CONSOLE           ((NTSTATUS)0xC00A0024)
#define STATUS_CTX_CLIENT_QUERY_TIMEOUT  ((NTSTATUS)0xC00A0026)
#define STATUS_CTX_CONSOLE_DISCONNECT    ((NTSTATUS)0xC00A0027)
#define STATUS_CTX_CONSOLE_CONNECT       ((NTSTATUS)0xC00A0028)
#define STATUS_CTX_SHADOW_DENIED         ((NTSTATUS)0xC00A002A)
#define STATUS_CTX_WINSTATION_ACCESS_DENIED     ((NTSTATUS)0xC00A002B)
#define STATUS_CTX_INVALID_WD            ((NTSTATUS)0xC00A002E)
#define STATUS_CTX_WD_NOT_FOUND          ((NTSTATUS)0xC00A002F)
#define STATUS_CTX_SHADOW_INVALID        ((NTSTATUS)0xC00A0030)
#define STATUS_CTX_SHADOW_DISABLED       ((NTSTATUS)0xC00A0031)
#define STATUS_RDP_PROTOCOL_ERROR        ((NTSTATUS)0xC00A0032)
#define STATUS_CTX_CLIENT_LICENSE_NOT_SET       ((NTSTATUS)0xC00A0033)
#define STATUS_CTX_CLIENT_LICENSE_IN_USE ((NTSTATUS)0xC00A0034)
#define STATUS_CTX_SHADOW_ENDED_BY_MODE_CHANGE  ((NTSTATUS)0xC00A0035)
#define STATUS_CTX_SHADOW_NOT_RUNNING    ((NTSTATUS)0xC00A0036)

#define STATUS_CLUSTER_INVALID_NODE      ((NTSTATUS)0xC0130001)
#define STATUS_CLUSTER_NODE_EXISTS       ((NTSTATUS)0xC0130002)
#define STATUS_CLUSTER_JOIN_IN_PROGRESS  ((NTSTATUS)0xC0130003)
#define STATUS_CLUSTER_NODE_NOT_FOUND    ((NTSTATUS)0xC0130004)
#define STATUS_CLUSTER_LOCAL_NODE_NOT_FOUND     ((NTSTATUS)0xC0130005)
#define STATUS_CLUSTER_NETWORK_EXISTS    ((NTSTATUS)0xC0130006)
#define STATUS_CLUSTER_NETWORK_NOT_FOUND ((NTSTATUS)0xC0130007)
#define STATUS_CLUSTER_NETINTERFACE_EXISTS      ((NTSTATUS)0xC0130008)
#define STATUS_CLUSTER_NETINTERFACE_NOT_FOUND   ((NTSTATUS)0xC0130009)
#define STATUS_CLUSTER_INVALID_REQUEST   ((NTSTATUS)0xC013000A)
#define STATUS_CLUSTER_INVALID_NETWORK_PROVIDER ((NTSTATUS)0xC013000B)
#define STATUS_CLUSTER_NODE_DOWN         ((NTSTATUS)0xC013000C)
#define STATUS_CLUSTER_NODE_UNREACHABLE  ((NTSTATUS)0xC013000D)
#define STATUS_CLUSTER_NODE_NOT_MEMBER   ((NTSTATUS)0xC013000E)
#define STATUS_CLUSTER_JOIN_NOT_IN_PROGRESS     ((NTSTATUS)0xC013000F)
#define STATUS_CLUSTER_INVALID_NETWORK   ((NTSTATUS)0xC0130010)
#define STATUS_CLUSTER_NO_NET_ADAPTERS   ((NTSTATUS)0xC0130011)
#define STATUS_CLUSTER_NODE_UP           ((NTSTATUS)0xC0130012)
#define STATUS_CLUSTER_NODE_PAUSED       ((NTSTATUS)0xC0130013)
#define STATUS_CLUSTER_NODE_NOT_PAUSED   ((NTSTATUS)0xC0130014)
#define STATUS_CLUSTER_NO_SECURITY_CONTEXT      ((NTSTATUS)0xC0130015)
#define STATUS_CLUSTER_NETWORK_NOT_INTERNAL     ((NTSTATUS)0xC0130016)
#define STATUS_CLUSTER_POISONED          ((NTSTATUS)0xC0130017)

#define STATUS_SXS_SECTION_NOT_FOUND     ((NTSTATUS)0xC0150001)
#define STATUS_SXS_CANT_GEN_ACTCTX       ((NTSTATUS)0xC0150002)
#define STATUS_SXS_INVALID_ACTCTXDATA_FORMAT    ((NTSTATUS)0xC0150003)
#define STATUS_SXS_ASSEMBLY_NOT_FOUND    ((NTSTATUS)0xC0150004)
#define STATUS_SXS_MANIFEST_FORMAT_ERROR ((NTSTATUS)0xC0150005)
#define STATUS_SXS_MANIFEST_PARSE_ERROR  ((NTSTATUS)0xC0150006)
#define STATUS_SXS_ACTIVATION_CONTEXT_DISABLED  ((NTSTATUS)0xC0150007)
#define STATUS_SXS_KEY_NOT_FOUND         ((NTSTATUS)0xC0150008)
#define STATUS_SXS_VERSION_CONFLICT      ((NTSTATUS)0xC0150009)
#define STATUS_SXS_WRONG_SECTION_TYPE    ((NTSTATUS)0xC015000A)
#define STATUS_SXS_THREAD_QUERIES_DISABLED      ((NTSTATUS)0xC015000B)
#define STATUS_SXS_ASSEMBLY_MISSING      ((NTSTATUS)0xC015000C)
#define STATUS_SXS_PROCESS_DEFAULT_ALREADY_SET  ((NTSTATUS)0xC015000E)
#define STATUS_SXS_MULTIPLE_DEACTIVATION ((NTSTATUS)0xC0150011)
#define STATUS_SXS_SYSTEM_DEFAULT_ACTIVATION_CONTEXT_EMPTY ((NTSTATUS)0xC0150012)
#define STATUS_SXS_PROCESS_TERMINATION_REQUESTED ((NTSTATUS)0xC0150013)
#define STATUS_SXS_CORRUPT_ACTIVATION_STACK ((NTSTATUS)0xC0150014)
#define STATUS_SXS_CORRUPTION            ((NTSTATUS)0xC0150015)
#define STATUS_DISCONNECTED 55
#define STATUS_NONEXISTENT_NET_NAME 55
#define STATUS_ENDPOINT_CLOSED ((NTSTATUS) 0x00000037)

#endif /* WIN32_NO_STATUS */

#endif /* _NTSTATUS_ */

#define STATUS_INVALID_DEVICE_REQUEST    ((NTSTATUS)0xC0000010L)
#define PAGE_SIZE (ULONG)0x1000
typedef enum _POOL_TYPE {
  NonPagedPool,
  PagedPool,
  NonPagedPoolMustSucceed,
  DontUseThisType,
  NonPagedPoolCacheAligned,
  PagedPoolCacheAligned,
  NonPagedPoolCacheAlignedMustS,
	MaxPoolType,
	NonPagedPoolSession = 32,
	PagedPoolSession,
	NonPagedPoolMustSucceedSession,
	DontUseThisTypeSession,
	NonPagedPoolCacheAlignedSession,
	PagedPoolCacheAlignedSession,
	NonPagedPoolCacheAlignedMustSSession
} POOL_TYPE;
typedef struct _OBJECT_NAME_INFORMATION {


  UNICODE_STRING          Name;
  WCHAR                   NameBuffer[0];
	
} OBJECT_NAME_INFORMATION, *POBJECT_NAME_INFORMATION;
typedef struct _USER_STACK{
	PVOID	FixedStackBase;
	PVOID	FixedStackLimit;
	PVOID	ExpandableStackBase;
	PVOID	ExpandableStackLimit;
	PVOID	ExpandableStackBottom;
}USER_STACK,*PUSER_STACK;
/***********************************************************************
 * PEB data structure
 */
typedef struct _PEB
{
    BOOLEAN                      InheritedAddressSpace;             /*  00 */
    BOOLEAN                      ReadImageFileExecOptions;          /*  01 */
    BOOLEAN                      BeingDebugged;                     /*  02 */
    BOOLEAN                      SpareBool;                         /*  03 */
    HANDLE                       Mutant;                            /*  04 */
    HMODULE                      ImageBaseAddress;                  /*  08 */
    PPEB_LDR_DATA                LdrData;                           /*  0c */
    RTL_USER_PROCESS_PARAMETERS *ProcessParameters;                 /*  10 */
    PVOID                        SubSystemData;                     /*  14 */
    HANDLE                       ProcessHeap;                       /*  18 */
    PRTL_CRITICAL_SECTION        FastPebLock;                       /*  1c */
    PVOID /*PPEBLOCKROUTINE*/    FastPebLockRoutine;                /*  20 */
    PVOID /*PPEBLOCKROUTINE*/    FastPebUnlockRoutine;              /*  24 */
    ULONG                        EnvironmentUpdateCount;            /*  28 */
    PVOID                        KernelCallbackTable;               /*  2c */
    PVOID                        EventLogSection;                   /*  30 */
    PVOID                        EventLog;                          /*  34 */
    PVOID /*PPEB_FREE_BLOCK*/    FreeList;                          /*  38 */
    ULONG                        TlsExpansionCounter;               /*  3c */
    PRTL_BITMAP                  TlsBitmap;                         /*  40 */
    ULONG                        TlsBitmapBits[2];                  /*  44 */
    PVOID                        ReadOnlySharedMemoryBase;          /*  4c */
    PVOID                        ReadOnlySharedMemoryHeap;          /*  50 */
    PVOID                       *ReadOnlyStaticServerData;          /*  54 */
    PVOID                        AnsiCodePageData;                  /*  58 */
    PVOID                        OemCodePageData;                   /*  5c */
    PVOID                        UnicodeCaseTableData;              /*  60 */
    ULONG                        NumberOfProcessors;                /*  64 */
    ULONG                        NtGlobalFlag;                      /*  68 */
    BYTE                         Spare2[4];                         /*  6c */
    LARGE_INTEGER                CriticalSectionTimeout;            /*  70 */
    ULONG                        HeapSegmentReserve;                /*  78 */
    ULONG                        HeapSegmentCommit;                 /*  7c */
    ULONG                        HeapDeCommitTotalFreeThreshold;    /*  80 */
    ULONG                        HeapDeCommitFreeBlockThreshold;    /*  84 */
    ULONG                        NumberOfHeaps;                     /*  88 */
    ULONG                        MaximumNumberOfHeaps;              /*  8c */
    PVOID                       *ProcessHeaps;                      /*  90 */
    PVOID                        GdiSharedHandleTable;              /*  94 */
    PVOID                        ProcessStarterHelper;              /*  98 */
    PVOID                        GdiDCAttributeList;                /*  9c */
    PVOID                        LoaderLock;                        /*  a0 */
    ULONG                        OSMajorVersion;                    /*  a4 */
    ULONG                        OSMinorVersion;                    /*  a8 */
    ULONG                        OSBuildNumber;                     /*  ac */
    ULONG                        OSPlatformId;                      /*  b0 */
    ULONG                        ImageSubSystem;                    /*  b4 */
    ULONG                        ImageSubSystemMajorVersion;        /*  b8 */
    ULONG                        ImageSubSystemMinorVersion;        /*  bc */
    ULONG                        ImageProcessAffinityMask;          /*  c0 */
    ULONG                        GdiHandleBuffer[34];               /*  c4 */
    ULONG                        PostProcessInitRoutine;            /* 14c */
    PRTL_BITMAP                  TlsExpansionBitmap;                /* 150 */
    ULONG                        TlsExpansionBitmapBits[32];        /* 154 */
    ULONG                        SessionId;                         /* 1d4 */
} PEB, *PPEB;


/***********************************************************************
 * TEB data structure
 */
#ifndef WINE_NO_TEB  /* don't define TEB if included from thread.h */
# ifndef WINE_TEB_DEFINED
# define WINE_TEB_DEFINED
typedef struct _TEB
{
    NT_TIB          Tib;                        /* 000 */
    PVOID           EnvironmentPointer;         /* 01c */
    CLIENT_ID       ClientId;                   /* 020 */
    PVOID           ActiveRpcHandle;            /* 028 */
    PVOID           ThreadLocalStoragePointer;  /* 02c */
    PPEB            Peb;                        /* 030 */
    ULONG           LastErrorValue;             /* 034 */
    ULONG           CountOfOwnedCriticalSections;/* 038 */
    PVOID           CsrClientThread;            /* 03c */
    PVOID           Win32ThreadInfo;            /* 040 */
    ULONG           Win32ClientInfo[31];        /* 044 used for user32 private data in Wine */
    PVOID           WOW32Reserved;              /* 0c0 */
    ULONG           CurrentLocale;              /* 0c4 */
    ULONG           FpSoftwareStatusRegister;   /* 0c8 */
    PVOID           SystemReserved1[54];        /* 0cc used for kernel32 private data in Wine */
    PVOID           Spare1;                     /* 1a4 */
    LONG            ExceptionCode;              /* 1a8 */
    BYTE            SpareBytes1[40];            /* 1ac */
    PVOID           SystemReserved2[10];        /* 1d4 used for ntdll private data in Wine */
    GDI_TEB_BATCH   GdiTebBatch;                /* 1fc */
    ULONG           gdiRgn;                     /* 6dc */
    ULONG           gdiPen;                     /* 6e0 */
    ULONG           gdiBrush;                   /* 6e4 */
    CLIENT_ID       RealClientId;               /* 6e8 */
    HANDLE          GdiCachedProcessHandle;     /* 6f0 */
    ULONG           GdiClientPID;               /* 6f4 */
    ULONG           GdiClientTID;               /* 6f8 */
    PVOID           GdiThreadLocaleInfo;        /* 6fc */
    PVOID           UserReserved[5];            /* 700 */
    PVOID           glDispachTable[280];        /* 714 */
    ULONG           glReserved1[26];            /* b74 */
    PVOID           glReserved2;                /* bdc */
    PVOID           glSectionInfo;              /* be0 */
    PVOID           glSection;                  /* be4 */
    PVOID           glTable;                    /* be8 */
    PVOID           glCurrentRC;                /* bec */
    PVOID           glContext;                  /* bf0 */
    ULONG           LastStatusValue;            /* bf4 */
    UNICODE_STRING  StaticUnicodeString;        /* bf8 used by advapi32 */
    WCHAR           StaticUnicodeBuffer[261];   /* c00 used by advapi32 */
    PVOID           DeallocationStack;          /* e0c */
    PVOID           TlsSlots[64];               /* e10 */
    LIST_ENTRY      TlsLinks;                   /* f10 */
    PVOID           Vdm;                        /* f18 */
    PVOID           ReservedForNtRpc;           /* f1c */
    PVOID           DbgSsReserved[2];           /* f20 */
    ULONG           HardErrorDisabled;          /* f28 */
    PVOID           Instrumentation[16];        /* f2c */
    PVOID           WinSockData;                /* f6c */
    ULONG           GdiBatchCount;              /* f70 */
    ULONG           Spare2;                     /* f74 */
    ULONG           Spare3;                     /* f78 */
    ULONG           Spare4;                     /* f7c */
    PVOID           ReservedForOle;             /* f80 */
    ULONG           WaitingOnLoaderLock;        /* f84 */
    PVOID           Reserved5[3];               /* f88 */
    PVOID          *TlsExpansionSlots;          /* f94 */
} TEB, *PTEB;
# endif /* WINE_TEB_DEFINED */
#endif  /* WINE_NO_TEB */

/***********************************************************************
 * Enums
 */
typedef enum _FILE_INFORMATION_CLASS {
	FileDirectoryInformation         = 1,
	FileFullDirectoryInformation,   // 2
	FileBothDirectoryInformation,   // 3
	FileBasicInformation,           // 4
	FileStandardInformation,        // 5
	FileInternalInformation,        // 6
	FileEaInformation,              // 7
	FileAccessInformation,          // 8
	FileNameInformation,            // 9
	FileRenameInformation,          // 10
	FileLinkInformation,            // 11
	FileNamesInformation,           // 12
	FileDispositionInformation,     // 13
	FilePositionInformation,        // 14
	FileFullEaInformation,          // 15
	FileModeInformation,            // 16
	FileAlignmentInformation,       // 17
	FileAllInformation,             // 18
	FileAllocationInformation,      // 19
	FileEndOfFileInformation,       // 20
	FileAlternateNameInformation,   // 21
	FileStreamInformation,          // 22
	FilePipeInformation,            // 23
	FilePipeLocalInformation,       // 24
	FilePipeRemoteInformation,      // 25
	FileMailslotQueryInformation,   // 26
	FileMailslotSetInformation,     // 27
	FileCompressionInformation,     // 28
	FileObjectIdInformation,        // 29
	FileCompletionInformation,      // 30
	FileMoveClusterInformation,     // 31
	FileQuotaInformation,           // 32
	FileReparsePointInformation,    // 33
	FileNetworkOpenInformation,     // 34
	FileAttributeTagInformation,    // 35
	FileTrackingInformation,        // 36
	FileIdBothDirectoryInformation, // 37
	FileIdFullDirectoryInformation, // 38
	FileValidDataLengthInformation, // 39
	FileShortNameInformation,       // 40
	FileIoCompletionNotificationInformation, // 41
	FileIoStatusBlockRangeInformation,       // 42
	FileIoPriorityHintInformation,           // 43
	FileSfioReserveInformation,              // 44
	FileSfioVolumeInformation,               // 45
	FileHardLinkInformation,                 // 46
	FileProcessIdsUsingFileInformation,      // 47
	FileNormalizedNameInformation,           // 48
	FileNetworkPhysicalNameInformation,      // 49
	FileIdGlobalTxDirectoryInformation,      // 50
	FileIsRemoteDeviceInformation,           // 51
	FileAttributeCacheInformation,           // 52
	FileNumaNodeInformation,                 // 53
	FileStandardLinkInformation,             // 54
	FileRemoteProtocolInformation,           // 55
	FileMaximumInformation
} FILE_INFORMATION_CLASS, *PFILE_INFORMATION_CLASS;

//typedef enum _FILE_INFORMATION_CLASS {
//    FileDirectoryInformation = 1,
//    FileFullDirectoryInformation,
//    FileBothDirectoryInformation,
//    FileBasicInformation,
//    FileStandardInformation,
//    FileInternalInformation,
//    FileEaInformation,
//    FileAccessInformation,
//    FileNameInformation,
//    FileRenameInformation,
//    FileLinkInformation,
//    FileNamesInformation,
//    FileDispositionInformation,
//    FilePositionInformation,
//    FileFullEaInformation,
//    FileModeInformation,
//    FileAlignmentInformation,
//    FileAllInformation,
//    FileAllocationInformation,
//    FileEndOfFileInformation,
//    FileAlternateNameInformation,
//    FileStreamInformation,
//    FilePipeInformation,
//    FilePipeLocalInformation,
//    FilePipeRemoteInformation,
//    FileMailslotQueryInformation,
//    FileMailslotSetInformation,
//    FileCompressionInformation,
//    FileObjectIdInformation,
//    FileCompletionInformation,
//    FileMoveClusterInformation,
//    FileQuotaInformation,
//    FileReparsePointInformation,
//    FileNetworkOpenInformation,
//    FileAttributeTagInformation,
//    FileTrackingInformation,
//    FileMaximumInformation
//} FILE_INFORMATION_CLASS, *PFILE_INFORMATION_CLASS;

typedef struct _FILE_DIRECTORY_INFORMATION {
    ULONG               NextEntryOffset;
    ULONG               FileIndex;
    LARGE_INTEGER       CreationTime;
    LARGE_INTEGER       LastAccessTime;
    LARGE_INTEGER       LastWriteTime;
    LARGE_INTEGER       ChangeTime;
    LARGE_INTEGER       EndOfFile;
    LARGE_INTEGER       AllocationSize;
    ULONG               FileAttributes;
    ULONG               FileNameLength;
    WCHAR               FileName[ANYSIZE_ARRAY];
} FILE_DIRECTORY_INFORMATION, *PFILE_DIRECTORY_INFORMATION;

typedef struct _FILE_FULL_DIRECTORY_INFORMATION {
    ULONG               NextEntryOffset;
    ULONG               FileIndex;
    LARGE_INTEGER       CreationTime;
    LARGE_INTEGER       LastAccessTime;
    LARGE_INTEGER       LastWriteTime;
    LARGE_INTEGER       ChangeTime;
    LARGE_INTEGER       EndOfFile;
    LARGE_INTEGER       AllocationSize;
    ULONG               FileAttributes;
    ULONG               FileNameLength;
    ULONG               EaSize;
    WCHAR               FileName[ANYSIZE_ARRAY];
} FILE_FULL_DIRECTORY_INFORMATION, *PFILE_FULL_DIRECTORY_INFORMATION,
  FILE_FULL_DIR_INFORMATION, *PFILE_FULL_DIR_INFORMATION;
typedef struct _FILE_ID_FULL_DIR_INFORMATION {
	ULONG NextEntryOffset;
	ULONG FileIndex;
	LARGE_INTEGER CreationTime;
	LARGE_INTEGER LastAccessTime;
	LARGE_INTEGER LastWriteTime;
	LARGE_INTEGER ChangeTime;
	LARGE_INTEGER EndOfFile;
	LARGE_INTEGER AllocationSize;
	ULONG FileAttributes;
	ULONG FileNameLength;
	ULONG EaSize;
	LARGE_INTEGER FileId;
	WCHAR FileName[1];
} FILE_ID_FULL_DIR_INFORMATION, *PFILE_ID_FULL_DIR_INFORMATION;
typedef struct _FILE_BOTH_DIRECTORY_INFORMATION {
    ULONG               NextEntryOffset;
    ULONG               FileIndex;
    LARGE_INTEGER       CreationTime;
    LARGE_INTEGER       LastAccessTime;
    LARGE_INTEGER       LastWriteTime;
    LARGE_INTEGER       ChangeTime;
    LARGE_INTEGER       EndOfFile;
    LARGE_INTEGER       AllocationSize;
    ULONG               FileAttributes;
    ULONG               FileNameLength;
    ULONG               EaSize;
    CHAR                ShortNameLength;
    WCHAR               ShortName[12];
    WCHAR               FileName[ANYSIZE_ARRAY];
} FILE_BOTH_DIRECTORY_INFORMATION, *PFILE_BOTH_DIRECTORY_INFORMATION,
  FILE_BOTH_DIR_INFORMATION, *PFILE_BOTH_DIR_INFORMATION;
typedef struct _FILE_ID_BOTH_DIR_INFORMATION {
	ULONG NextEntryOffset;
	ULONG FileIndex;
	LARGE_INTEGER CreationTime;
	LARGE_INTEGER LastAccessTime;
	LARGE_INTEGER LastWriteTime;
	LARGE_INTEGER ChangeTime;
	LARGE_INTEGER EndOfFile;
	LARGE_INTEGER AllocationSize;
	ULONG FileAttributes;
	ULONG FileNameLength;
	ULONG EaSize;
	CCHAR ShortNameLength;
	WCHAR ShortName[12];
	LARGE_INTEGER FileId;
	WCHAR FileName[1];
} FILE_ID_BOTH_DIR_INFORMATION, *PFILE_ID_BOTH_DIR_INFORMATION;
typedef struct _FILE_BASIC_INFORMATION {
    LARGE_INTEGER CreationTime;
    LARGE_INTEGER LastAccessTime;
    LARGE_INTEGER LastWriteTime;
    LARGE_INTEGER ChangeTime;
    ULONG FileAttributes;
} FILE_BASIC_INFORMATION, *PFILE_BASIC_INFORMATION;

typedef struct _FILE_STANDARD_INFORMATION {
    LARGE_INTEGER AllocationSize;
    LARGE_INTEGER EndOfFile;
    ULONG NumberOfLinks;
    BOOLEAN DeletePending;
    BOOLEAN Directory;
} FILE_STANDARD_INFORMATION, *PFILE_STANDARD_INFORMATION;

typedef struct _FILE_INTERNAL_INFORMATION {
    LARGE_INTEGER IndexNumber;
} FILE_INTERNAL_INFORMATION, *PFILE_INTERNAL_INFORMATION;

typedef struct _FILE_EA_INFORMATION {
    ULONG EaSize;
} FILE_EA_INFORMATION, *PFILE_EA_INFORMATION;

typedef struct _FILE_ACCESS_INFORMATION {
    ACCESS_MASK AccessFlags;
} FILE_ACCESS_INFORMATION, *PFILE_ACCESS_INFORMATION;

typedef struct _FILE_NAME_INFORMATION {
    ULONG FileNameLength;
    WCHAR FileName[1];
} FILE_NAME_INFORMATION, *PFILE_NAME_INFORMATION;

typedef struct _FILE_RENAME_INFORMATION {
    BOOLEAN Replace;
    HANDLE RootDir;
    ULONG FileNameLength;
    WCHAR FileName[1];
} FILE_RENAME_INFORMATION, *PFILE_RENAME_INFORMATION;

typedef struct _FILE_NAMES_INFORMATION {
    ULONG NextEntryOffset;
    ULONG FileIndex;
    ULONG FileNameLength;
    WCHAR FileName[1];
} FILE_NAMES_INFORMATION, *PFILE_NAMES_INFORMATION;

typedef struct _FILE_DISPOSITION_INFORMATION {
    BOOLEAN DoDeleteFile;
} FILE_DISPOSITION_INFORMATION, *PFILE_DISPOSITION_INFORMATION;

typedef struct _FILE_POSITION_INFORMATION {
    LARGE_INTEGER CurrentByteOffset;
} FILE_POSITION_INFORMATION, *PFILE_POSITION_INFORMATION;

typedef struct _FILE_ALIGNMENT_INFORMATION {
    ULONG AlignmentRequirement;
} FILE_ALIGNMENT_INFORMATION, *PFILE_ALIGNMENT_INFORMATION;

typedef struct _FILE_ALLOCATION_INFORMATION {
    LARGE_INTEGER AllocationSize;
} FILE_ALLOCATION_INFORMATION, *PFILE_ALLOCATION_INFORMATION;

typedef struct _FILE_END_OF_FILE_INFORMATION {
    LARGE_INTEGER EndOfFile;
} FILE_END_OF_FILE_INFORMATION, *PFILE_END_OF_FILE_INFORMATION;

typedef struct _FILE_NETWORK_OPEN_INFORMATION {
    LARGE_INTEGER CreationTime;
    LARGE_INTEGER LastAccessTime;
    LARGE_INTEGER LastWriteTime;
    LARGE_INTEGER ChangeTime;
    LARGE_INTEGER AllocationSize;
    LARGE_INTEGER EndOfFile;
    ULONG FileAttributes;
} FILE_NETWORK_OPEN_INFORMATION, *PFILE_NETWORK_OPEN_INFORMATION;

typedef struct _FILE_FULL_EA_INFORMATION {
    ULONG NextEntryOffset;
    UCHAR Flags;
    UCHAR EaNameLength;
    USHORT EaValueLength;
    CHAR EaName[1];
} FILE_FULL_EA_INFORMATION, *PFILE_FULL_EA_INFORMATION;

typedef struct _FILE_MODE_INFORMATION {
    ULONG Mode;
} FILE_MODE_INFORMATION, *PFILE_MODE_INFORMATION;

typedef struct _FILE_STREAM_INFORMATION
{
    ULONG NextEntryOffset;
    ULONG StreamNameLength;
    LARGE_INTEGER StreamSize;
    LARGE_INTEGER StreamAllocationSize;
    WCHAR StreamName[1];
} FILE_STREAM_INFORMATION, *PFILE_STREAM_INFORMATION;

typedef struct _FILE_ATTRIBUTE_TAG_INFORMATION
{
    ULONG FileAttributes;
    ULONG ReparseTag;
} FILE_ATTRIBUTE_TAG_INFORMATION, *PFILE_ATTRIBUTE_TAG_INFORMATION;

typedef struct _FILE_MAILSLOT_QUERY_INFORMATION {
    ULONG MaximumMessageSize;
    ULONG MailslotQuota;
    ULONG NextMessageSize;
    ULONG MessagesAvailable;
    LARGE_INTEGER ReadTimeout;
} FILE_MAILSLOT_QUERY_INFORMATION, *PFILE_MAILSLOT_QUERY_INFORMATION;

typedef struct _FILE_MAILSLOT_SET_INFORMATION {
    LARGE_INTEGER ReadTimeout;
} FILE_MAILSLOT_SET_INFORMATION, *PFILE_MAILSLOT_SET_INFORMATION;

typedef struct _FILE_ALL_INFORMATION
{
    FILE_BASIC_INFORMATION     BasicInformation;
    FILE_STANDARD_INFORMATION  StandardInformation;
    FILE_INTERNAL_INFORMATION  InternalInformation;
    FILE_EA_INFORMATION        EaInformation;
    FILE_ACCESS_INFORMATION    AccessInformation;
    FILE_POSITION_INFORMATION  PositionInformation;
    FILE_MODE_INFORMATION      ModeInformation;
    FILE_ALIGNMENT_INFORMATION AlignmentInformation;
    FILE_NAME_INFORMATION      NameInformation;
} FILE_ALL_INFORMATION, *PFILE_ALL_INFORMATION;

typedef enum _FSINFOCLASS {
    FileFsVolumeInformation = 1,
    FileFsLabelInformation,
    FileFsSizeInformation,
    FileFsDeviceInformation,
    FileFsAttributeInformation,
    FileFsControlInformation,
    FileFsFullSizeInformation,
    FileFsObjectIdInformation,
    FileFsMaximumInformation
} FS_INFORMATION_CLASS, *PFS_INFORMATION_CLASS;

typedef enum _KEY_INFORMATION_CLASS {
    KeyBasicInformation,
    KeyNodeInformation,
    KeyFullInformation
} KEY_INFORMATION_CLASS;

typedef enum _KEY_VALUE_INFORMATION_CLASS {
    KeyValueBasicInformation,
    KeyValueFullInformation,
    KeyValuePartialInformation,
    KeyValueFullInformationAlign64,
    KeyValuePartialInformationAlign64
} KEY_VALUE_INFORMATION_CLASS;

typedef enum _OBJECT_INFORMATION_CLASS {
    ObjectBasicInformation,
    ObjectNameInformation,
    ObjectTypeInformation,
    ObjectAllInformation,
    ObjectDataInformation
} OBJECT_INFORMATION_CLASS, *POBJECT_INFORMATION_CLASS;

typedef enum _PROCESSINFOCLASS {
    ProcessBasicInformation = 0,
    ProcessQuotaLimits = 1,
    ProcessIoCounters = 2,
    ProcessVmCounters = 3,
    ProcessTimes = 4,
    ProcessBasePriority = 5,
    ProcessRaisePriority = 6,
    ProcessDebugPort = 7,
    ProcessExceptionPort = 8,
    ProcessAccessToken = 9,
    ProcessLdtInformation = 10,
    ProcessLdtSize = 11,
    ProcessDefaultHardErrorMode = 12,
    ProcessIoPortHandlers = 13,
    ProcessPooledUsageAndLimits = 14,
    ProcessWorkingSetWatch = 15,
    ProcessUserModeIOPL = 16,
    ProcessEnableAlignmentFaultFixup = 17,
    ProcessPriorityClass = 18,
    ProcessWx86Information = 19,
    ProcessHandleCount = 20,
    ProcessAffinityMask = 21,
    ProcessPriorityBoost = 22,
    ProcessDeviceMap = 23,
    ProcessSessionInformation = 24,
    ProcessForegroundInformation = 25,
    ProcessWow64Information = 26,
    ProcessImageFileName = 27,
    ProcessLUIDDeviceMapsEnabled = 28,
    ProcessBreakOnTermination = 29,
    ProcessDebugObjectHandle = 30,
    ProcessDebugFlags = 31,
    ProcessHandleTracing = 32,
		ProcessExecuteFlags = 0x22,
    MaxProcessInfoClass
} PROCESSINFOCLASS, PROCESS_INFORMATION_CLASS;
#define MEM_EXECUTE_OPTION_ENABLE 0x2
#define MEM_EXECUTE_OPTION_DISABLE 0x1
typedef enum _SECTION_INHERIT {
    ViewShare = 1,
    ViewUnmap = 2
} SECTION_INHERIT;

//ZwQuerySystemInformation enum type
typedef enum _SYSTEM_INFORMATION_CLASS {           //Query Set
        SystemBasicInformation,                        //  0 Y N
        SystemProcessorInformation,                    //  1 Y N
        SystemPerformanceInformation,                  //  2 Y N
        SystemTimeOfDayInformation,                    //  3 Y N
        SystemPathInformation,                         //  4 Y N
        SystemProcessesAndThreadsInformation,          //  5 Y N
        SystemCallCounts,                              //  6 Y N
        SystemConfigurationInformation,                //  7 Y N
        SystemProcessorTimes,                          //  8 Y N
        SystemGlobalFlag,                              //  9 Y Y
        SystemCallTimeInformation,                     // 10 Y N
        SystemModuleInformation,                       // 11 Y N
        SystemLockInformation,                         // 12 Y N
        SystemStackTraceInformation,                   // 13 Y N
        SystemPagedPoolInformation,                    // 14 Y N
        SystemNonPagedPoolInformation,                 // 15 Y N
        SystemHandleInformation,                       // 16 Y N
        SystemObjectInformation,                       // 17 Y N
        SystemPagefileInformation,                     // 18 Y N
        SystemInstructionEmulationCounts,              // 19 Y N
        SystemVdmBopInformation,                       // 20
        SystemCacheInformation,                        // 21 Y Y
        SystemPoolTagInformation,                      // 22 Y N
        SystemProcessorStatistics,                     // 23 Y N
        SystemDpcInformation,                          // 24 Y Y
        SystemMemoryUsageInformation,                  // 25 Y N
        SystemLoadImage,                               // 26 N Y
        SystemUnloadImage,                             // 27 N Y
        SystemTimeAdjustment,                          // 28 Y Y
        SystemPoolBlocksInformation,                   // 29 Y N
        SystemNextEventIdInformation,                  // 30 Y N
        SystemEventIdsInformation,                     // 31 Y N
        SystemCrashDumpInformation,                    // 32 Y N
        SystemExceptionInformation,                    // 33 Y N
        SystemCrashDumpStateInformation,               // 34 Y Y/N
        SystemKernelDebuggerInformation,               // 35 Y N
        SystemContextSwitchInformation,                // 36 Y N
        SystemRegistryQuotaInformation,                // 37 Y Y
        SystemLoadAndCallImage,                        // 38 N Y
        SystemPrioritySeparation,                      // 39 N Y
        SystemPlugPlayBusInformation,                  // 40 Y N
        SystemDockInformation,                         // 41 Y N
        SystemPowerInformation2,                       // 42
        SystemProcessorSpeedInformation,               // 43
        SystemTimeZoneInformation,                     // 44 Y N
        SystemLookasideInformation,                    // 45 Y N
        SystemSetTimeSlipEvent,                        // 46 N Y
        SystemCreateSession,                           // 47 N Y
        SystemDeleteSession,                           // 48 N Y
        SystemInvalidInfoClass4,                       // 49
        SystemRangeStartInformation,                   // 50 Y N //sizeof = 4
        SystemVerifierInformation,                     // 51 Y Y
        SystemAddVerifier,                             // 52 N Y
        SystemSessionProcessesInformation,             // 53 Y N
        SystemInformation54,                           // 54
        SystemNumaNodeInformation,                     // 55 Y   //GetNumaProcessorNode,...
        SystemInformation56,                           // 56
        SystemUnknownInformation57,                    // 57 Y
        SystemInformation58,                           // 58
        SystemComPlusPackageInstallStatusInformation,  // 59 Y  Y  //sizeof = 4, GetComPlusPackageInstallStatus
        SystemNumaMemoryInformation,                   // 60 Y     //sizeof = 0x88, GetNumaAvailableMemoryNode
        SystemInformation61,                           // 61
        SystemInformation62,                           // 62
        SystemInformation63,                           // 63
        SystemInformation64,                           // 64
        SystemInformation65,                           // 65
        SystemInformation66,                           // 66
        SystemInformation67,                           // 67
        SystemInformation68,                           // 68
        SystemInformation69,                           // 69   Y
        SystemInformation70,                           // 70
        SystemInformation71,                           // 71
        SystemInformation72,                           // 72
        SystemLogicalProcessorInformation              // 73 Y
} SYSTEM_INFORMATION_CLASS;

typedef enum _TIMER_TYPE {
    NotificationTimer,
    SynchronizationTimer
} TIMER_TYPE;

typedef enum _THREADINFOCLASS {
    ThreadBasicInformation,
    ThreadTimes,
    ThreadPriority,
    ThreadBasePriority,
    ThreadAffinityMask,
    ThreadImpersonationToken,
    ThreadDescriptorTableEntry,
    ThreadEnableAlignmentFaultFixup,
    ThreadEventPair_Reusable,
    ThreadQuerySetWin32StartAddress,
    ThreadZeroTlsCell,
    ThreadPerformanceCount,
    ThreadAmILastThread,
    ThreadIdealProcessor,
    ThreadPriorityBoost,
    ThreadSetTlsArrayAddress,
    ThreadIsIoPending,
    MaxThreadInfoClass
} THREADINFOCLASS;


typedef struct _SYSTEM_PROCESSES_INFORMATION 
{
   ULONG NextEntryDelta;
   ULONG ThreadCount;
   ULONG Reserved1[6];
   LARGE_INTEGER CreateTime;
   LARGE_INTEGER UserTime;
   LARGE_INTEGER KernelTime;
   UNICODE_STRING ProcessName;
   LONG BasePriority;
   ULONG ProcessId;
   ULONG InheritedFromProcessId;
   ULONG HandleCount;
   ULONG Reserved[2];
   //VM_COUNTERS VmCounters;
   IO_COUNTERS IoCounters; // Windows 2000 only
   THREADINFOCLASS Threads[1];
}SYSTEM_PROCESSES_INFORMATION,*PSYSTEM_PROCESSES_INFORMATION;

typedef struct _THREAD_BASIC_INFORMATION
{
    NTSTATUS  ExitStatus;
    PVOID     TebBaseAddress;
    CLIENT_ID ClientId;
    ULONG     AffinityMask;
    LONG      Priority;
    LONG      BasePriority;
} THREAD_BASIC_INFORMATION, *PTHREAD_BASIC_INFORMATION;
///////////////////////////////////////////
//ONLY XP!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
///////////////////////////////////////////
typedef enum _SYSTEM_OBJECT_TYPE
{
	Undef=0,
	Type,
  Directory,
  SymbolicLink,
  Token,
  Process,
  Thread,
  Job,
  DebugObject,
  Event,
  EventPair,
  Mutant,
  Callback,
  Semaphore,
  Timer,
  Profile,
  KeyedEvent,
  WindowStation,
  Desktop,
  Section,
  Key,
  Port,
  WaitablePort,
  Adapter,
  Controller,
  Device,
  Driver,
  IoCompletion,
  File,
  WmiGuid
}SYSTEM_OBJECT_TYPE;
typedef struct _KERNEL_USER_TIMES {
    LARGE_INTEGER  CreateTime;
    LARGE_INTEGER  ExitTime;
    LARGE_INTEGER  KernelTime;
    LARGE_INTEGER  UserTime;
} KERNEL_USER_TIMES, *PKERNEL_USER_TIMES;

typedef enum _WINSTATIONINFOCLASS {
    WinStationInformation = 8
} WINSTATIONINFOCLASS;

typedef enum _MEMORY_INFORMATION_CLASS {
    MemoryBasicInformation,
    MemoryWorkingSetList,
    MemorySectionName,
    MemoryBasicVlmInformation
} MEMORY_INFORMATION_CLASS;

typedef enum _MUTANT_INFORMATION_CLASS
{
    MutantBasicInformation
} MUTANT_INFORMATION_CLASS, *PMUTANT_INFORMATION_CLASS;

typedef struct _MUTANT_BASIC_INFORMATION {
    LONG        CurrentCount;
    BOOLEAN     OwnedByCaller;
    BOOLEAN     AbandonedState;
} MUTANT_BASIC_INFORMATION, *PMUTANT_BASIC_INFORMATION;

typedef enum _TIMER_INFORMATION_CLASS
{
    TimerBasicInformation = 0
} TIMER_INFORMATION_CLASS;

typedef struct _TIMER_BASIC_INFORMATION
{
    LARGE_INTEGER RemainingTime;
    BOOLEAN       TimerState;
} TIMER_BASIC_INFORMATION, *PTIMER_BASIC_INFORMATION;


/* return type of RtlDetermineDosPathNameType_U (FIXME: not the correct names) */
typedef enum
{
    INVALID_PATH = 0,
    UNC_PATH,              /* "//foo" */
    ABSOLUTE_DRIVE_PATH,   /* "c:/foo" */
    RELATIVE_DRIVE_PATH,   /* "c:foo" */
    ABSOLUTE_PATH,         /* "/foo" */
    RELATIVE_PATH,         /* "foo" */
    DEVICE_PATH,           /* "//./foo" */
    UNC_DOT_PATH           /* "//." */
} DOS_PATHNAME_TYPE;

/***********************************************************************
 * IA64 specific types and data structures
 */

#ifdef __ia64__

typedef struct _FRAME_POINTERS {
  ULONGLONG MemoryStackFp;
  ULONGLONG BackingStoreFp;
} FRAME_POINTERS, *PFRAME_POINTERS;

#define UNWIND_HISTORY_TABLE_SIZE 12

typedef struct _RUNTIME_FUNCTION {
  ULONG BeginAddress;
  ULONG EndAddress;
  ULONG UnwindInfoAddress;
} RUNTIME_FUNCTION, *PRUNTIME_FUNCTION;

typedef struct _UNWIND_HISTORY_TABLE_ENTRY {
  ULONG64 ImageBase;
  ULONG64 Gp;
  PRUNTIME_FUNCTION FunctionEntry;
} UNWIND_HISTORY_TABLE_ENTRY, *PUNWIND_HISTORY_TABLE_ENTRY;

typedef struct _UNWIND_HISTORY_TABLE {
  ULONG Count;
  UCHAR Search;
  ULONG64 LowAddress;
  ULONG64 HighAddress;
  UNWIND_HISTORY_TABLE_ENTRY Entry[UNWIND_HISTORY_TABLE_SIZE];
} UNWIND_HISTORY_TABLE, *PUNWIND_HISTORY_TABLE;

#endif /* defined(__ia64__) */

/***********************************************************************
 * Types and data structures
 */

/* This is used by NtQuerySystemInformation */
typedef struct _SYSTEM_THREAD_INFORMATION{
    FILETIME    ftKernelTime;
    FILETIME    ftUserTime;
    FILETIME    ftCreateTime;
    DWORD       dwTickCount;
    DWORD       dwStartAddress;
    DWORD       dwOwningPID;
    DWORD       dwThreadID;
    DWORD       dwCurrentPriority;
    DWORD       dwBasePriority;
    DWORD       dwContextSwitches;
    DWORD       dwThreadState;
    DWORD       dwWaitReason;
    DWORD       dwUnknown;
} SYSTEM_THREAD_INFORMATION, *PSYSTEM_THREAD_INFORMATION;

typedef struct _IO_STATUS_BLOCK {
    NTSTATUS Status;
    PVOID Pointer;
	  ULONG_PTR Information;
} IO_STATUS_BLOCK, *PIO_STATUS_BLOCK;

typedef void (WINAPI * PIO_APC_ROUTINE)(PVOID,PIO_STATUS_BLOCK,ULONG);

typedef struct _KEY_BASIC_INFORMATION {
    LARGE_INTEGER LastWriteTime;
    ULONG         TitleIndex;
    ULONG         NameLength;
    WCHAR         Name[1];
} KEY_BASIC_INFORMATION, *PKEY_BASIC_INFORMATION;

typedef struct _KEY_NODE_INFORMATION
{
    LARGE_INTEGER LastWriteTime;
    ULONG         TitleIndex;
    ULONG         ClassOffset;
    ULONG         ClassLength;
    ULONG         NameLength;
    WCHAR         Name[1];
   /* Class[1]; */
} KEY_NODE_INFORMATION, *PKEY_NODE_INFORMATION;

typedef struct _KEY_FULL_INFORMATION
{
    LARGE_INTEGER LastWriteTime;
    ULONG         TitleIndex;
    ULONG         ClassOffset;
    ULONG         ClassLength;
    ULONG         SubKeys;
    ULONG         MaxNameLen;
    ULONG         MaxClassLen;
    ULONG         Values;
    ULONG         MaxValueNameLen;
    ULONG         MaxValueDataLen;
    WCHAR         Class[1];
} KEY_FULL_INFORMATION, *PKEY_FULL_INFORMATION;


typedef struct _KEY_VALUE_ENTRY
{
    PUNICODE_STRING ValueName;
    ULONG           DataLength;
    ULONG           DataOffset;
    ULONG           Type;
} KEY_VALUE_ENTRY, *PKEY_VALUE_ENTRY;

typedef struct _KEY_VALUE_BASIC_INFORMATION {
    ULONG TitleIndex;
    ULONG Type;
    ULONG NameLength;
    WCHAR Name[1];
} KEY_VALUE_BASIC_INFORMATION, *PKEY_VALUE_BASIC_INFORMATION;

typedef struct _KEY_VALUE_FULL_INFORMATION {
    ULONG TitleIndex;
    ULONG Type;
    ULONG DataOffset;
    ULONG DataLength;
    ULONG NameLength;
    WCHAR Name[1];
} KEY_VALUE_FULL_INFORMATION, *PKEY_VALUE_FULL_INFORMATION;

typedef struct _KEY_VALUE_PARTIAL_INFORMATION {
    ULONG TitleIndex;
    ULONG Type;
    ULONG DataLength;
    UCHAR Data[1];
} KEY_VALUE_PARTIAL_INFORMATION, *PKEY_VALUE_PARTIAL_INFORMATION;

typedef struct _OBJECT_ATTRIBUTES {
  ULONG Length;
  HANDLE RootDirectory;
  PUNICODE_STRING ObjectName;
  ULONG Attributes;
  PSECURITY_DESCRIPTOR SecurityDescriptor;       /* type SECURITY_DESCRIPTOR */
  PSECURITY_QUALITY_OF_SERVICE SecurityQualityOfService; /* type SECURITY_QUALITY_OF_SERVICE */
} OBJECT_ATTRIBUTES, *POBJECT_ATTRIBUTES;

typedef struct _OBJECT_DATA_INFORMATION {
    BOOLEAN InheritHandle;
    BOOLEAN ProtectFromClose;
} OBJECT_DATA_INFORMATION, *POBJECT_DATA_INFORMATION;

typedef struct _PROCESS_BASIC_INFORMATION {
#ifdef __WINESRC__
    DWORD ExitStatus;
    PPEB PebBaseAddress;
    DWORD AffinityMask;
    DWORD BasePriority;
    ULONG UniqueProcessId;
    ULONG InheritedFromUniqueProcessId;
#else
    PVOID Reserved1;
    PPEB PebBaseAddress;
    PVOID Reserved2[2];
    ULONG_PTR UniqueProcessId;
    PVOID Reserved3;
#endif
} PROCESS_BASIC_INFORMATION, *PPROCESS_BASIC_INFORMATION;

typedef struct _RTL_HEAP_DEFINITION {
    ULONG Length; /* = sizeof(RTL_HEAP_DEFINITION) */

    ULONG Unknown[11];
} RTL_HEAP_DEFINITION, *PRTL_HEAP_DEFINITION;

typedef struct _RTL_RWLOCK {
    RTL_CRITICAL_SECTION rtlCS;

    HANDLE hSharedReleaseSemaphore;
    UINT   uSharedWaiters;

    HANDLE hExclusiveReleaseSemaphore;
    UINT   uExclusiveWaiters;

    INT    iNumberActive;
    HANDLE hOwningThreadId;
    DWORD  dwTimeoutBoost;
    PVOID  pDebugInfo;
} RTL_RWLOCK, *LPRTL_RWLOCK;

/* System Information Class 0x00 */

typedef struct _SYSTEM_BASIC_INFORMATION {
#ifdef __WINESRC__
    DWORD dwUnknown1;
    ULONG uKeMaximumIncrement;
    ULONG uPageSize;
    ULONG uMmNumberOfPhysicalPages;
    ULONG uMmLowestPhysicalPage;
    ULONG uMmHighestPhysicalPage;
    ULONG uAllocationGranularity;
    PVOID pLowestUserAddress;
    PVOID pMmHighestUserAddress;
    ULONG uKeActiveProcessors;
    BYTE bKeNumberProcessors;
    BYTE bUnknown2;
    WORD wUnknown3;
#else
    BYTE Reserved1[24];
    PVOID Reserved2[4];
    CCHAR NumberOfProcessors;
#endif
} SYSTEM_BASIC_INFORMATION, *PSYSTEM_BASIC_INFORMATION;

/* System Information Class 0x01 */

typedef struct _SYSTEM_CPU_INFORMATION {
    WORD Architecture;
    WORD Level;
    WORD Revision;       /* combination of CPU model and stepping */
    WORD Reserved;       /* always zero */
    DWORD FeatureSet;    /* see bit flags below */
} SYSTEM_CPU_INFORMATION, *PSYSTEM_CPU_INFORMATION;

/* definitions of bits in the Feature set for the x86 processors */
#define CPU_FEATURE_VME    0x00000005   /* Virtual 86 Mode Extensions */
#define CPU_FEATURE_TSC    0x00000002   /* Time Stamp Counter available */
#define CPU_FEATURE_CMOV   0x00000008   /* Conditional Move instruction*/
#define CPU_FEATURE_PGE    0x00000014   /* Page table Entry Global bit */ 
#define CPU_FEATURE_PSE    0x00000024   /* Page Size Extension */
#define CPU_FEATURE_MTRR   0x00000040   /* Memory Type Range Registers */
#define CPU_FEATURE_CX8    0x00000080   /* Compare and eXchange 8 byte instr. */
#define CPU_FEATURE_MMX    0x00000100   /* Multi Media eXtensions */
#define CPU_FEATURE_X86    0x00000200   /* seems to be alway ON, on the '86 */
#define CPU_FEATURE_PAT    0x00000400   /* Page Attribute Table */
#define CPU_FEATURE_FXSR   0x00000800   /* FXSAVE and FXSTORE instructions */
#define CPU_FEATURE_SEP    0x00001000   /* SYSENTER and SYSEXIT instructions */
#define CPU_FEATURE_SSE    0x00002000   /* SSE extenstions (ext. MMX) */
#define CPU_FEATURE_3DNOW  0x00008000   /* 3DNOW instructions available 
                                           (FIXME: needs to be confirmed) */
#define CPU_FEATURE_SSE2   0x00010000   /* SSE2 extensions (XMMI64) */
#define CPU_FEATURE_DS     0x00020000   /* Debug Store */
#define CPU_FEATURE_HTT    0x00040000   /* Hyper Threading Technology */

/* System Information Class 0x02 */

typedef struct _SYSTEM_PERFORMANCE_INFORMATION
{ 
    LARGE_INTEGER    liIdleTime; 
    DWORD        dwSpare[76]; 
} SYSTEM_PERFORMANCE_INFORMATION,* PSYSTEM_PERFORMANCE_INFORMATION;

/* System Information Class 0x03 */

typedef struct _SYSTEM_TIMEOFDAY_INFORMATION {
#ifdef __WINESRC__
    LARGE_INTEGER liKeBootTime;
    LARGE_INTEGER liKeSystemTime;
    LARGE_INTEGER liExpTimeZoneBias;
    ULONG uCurrentTimeZoneId;
    DWORD dwUnknown1[5];
#else
    BYTE Reserved1[48];
#endif
} SYSTEM_TIMEOFDAY_INFORMATION, *PSYSTEM_TIMEOFDAY_INFORMATION; /* was SYSTEM_TIME_INFORMATION */

/* System Information Class 0x08 */

typedef struct _SYSTEM_PROCESSOR_PERFORMANCE_INFORMATION {
#ifdef __WINESRC__
    LARGE_INTEGER liIdleTime;
    LARGE_INTEGER liKernelTime;
    LARGE_INTEGER liUserTime;
    DWORD dwSpare[5];
#else
    LARGE_INTEGER IdleTime;
    LARGE_INTEGER KernelTime;
    LARGE_INTEGER UserTime;
    LARGE_INTEGER Reserved1[2];
    ULONG Reserved2;
#endif
} SYSTEM_PROCESSOR_PERFORMANCE_INFORMATION, *PSYSTEM_PROCESSOR_PERFORMANCE_INFORMATION;

/* System Information Class 0x0b */

typedef struct _SYSTEM_DRIVER_INFORMATION {
    PVOID pvAddress;
    DWORD dwUnknown1;
    DWORD dwUnknown2;
    DWORD dwEntryIndex;
    DWORD dwUnknown3;
    char szName[MAX_PATH + 1];
} SYSTEM_DRIVER_INFORMATION, *PSYSTEM_DRIVER_INFORMATION;

/* System Information Class 0x10 */

typedef struct _SYSTEM_HANDLE_ENTRY {
    ULONG  OwnerPid;
    BYTE   ObjectType;
    BYTE   HandleFlags;
    USHORT HandleValue;
    PVOID  ObjectPointer;
    ULONG  AccessMask;
} SYSTEM_HANDLE_ENTRY, *PSYSTEM_HANDLE_ENTRY;

typedef struct _SYSTEM_HANDLE_INFORMATION {
    ULONG               Count;
    SYSTEM_HANDLE_ENTRY Handle[1];
} SYSTEM_HANDLE_INFORMATION, *PSYSTEM_HANDLE_INFORMATION;

/* System Information Class 0x15 */

typedef struct _SYSTEM_CACHE_INFORMATION {
    ULONG CurrentSize;
    ULONG PeakSize;
    ULONG PageFaultCount;
    ULONG MinimumWorkingSet;
    ULONG MaximumWorkingSet;
    ULONG unused[4];
} SYSTEM_CACHE_INFORMATION, *PSYSTEM_CACHE_INFORMATION;

/* System Information Class 0x17 */

typedef struct _SYSTEM_INTERRUPT_INFORMATION {
    BYTE Reserved1[24];
} SYSTEM_INTERRUPT_INFORMATION, *PSYSTEM_INTERRUPT_INFORMATION;

typedef struct _SYSTEM_CONFIGURATION_INFO {
    union {
        ULONG	OemId;
        struct {
	    WORD ProcessorArchitecture;
	    WORD Reserved;
	} tag1;
    } tag2;
    ULONG PageSize;
    PVOID MinimumApplicationAddress;
    PVOID MaximumApplicationAddress;
    ULONG ActiveProcessorMask;
    ULONG NumberOfProcessors;
    ULONG ProcessorType;
    ULONG AllocationGranularity;
    WORD  ProcessorLevel;
    WORD  ProcessorRevision;
} SYSTEM_CONFIGURATION_INFO, *PSYSTEM_CONFIGURATION_INFO;

typedef struct _SYSTEM_EXCEPTION_INFORMATION {
    BYTE Reserved1[16];
} SYSTEM_EXCEPTION_INFORMATION, *PSYSTEM_EXCEPTION_INFORMATION;

typedef struct _SYSTEM_LOOKASIDE_INFORMATION {
    BYTE Reserved1[32];
} SYSTEM_LOOKASIDE_INFORMATION, *PSYSTEM_LOOKASIDE_INFORMATION;

typedef struct _SYSTEM_KERNEL_DEBUGGER_INFORMATION {
	BOOLEAN  DebuggerEnabled;
	BOOLEAN  DebuggerNotPresent;
} SYSTEM_KERNEL_DEBUGGER_INFORMATION, *PSYSTEM_KERNEL_DEBUGGER_INFORMATION;

/* System Information Class 0x05 */

typedef struct _VM_COUNTERS_ {
    SIZE_T PeakVirtualSize;
    SIZE_T VirtualSize;
    ULONG  PageFaultCount;
    SIZE_T PeakWorkingSetSize;
    SIZE_T WorkingSetSize;
    SIZE_T QuotaPeakPagedPoolUsage;
    SIZE_T QuotaPagedPoolUsage;
    SIZE_T QuotaPeakNonPagedPoolUsage;
    SIZE_T QuotaNonPagedPoolUsage;
    SIZE_T PagefileUsage;
    SIZE_T PeakPagefileUsage;
} VM_COUNTERS, *PVM_COUNTERS;

//
// Wait reasons
//

typedef enum _KWAIT_REASON {
    Executive,
    FreePage,
    PageIn,
    PoolAllocation,
    DelayExecution,
    Suspended,
    UserRequest,
    WrExecutive,
    WrFreePage,
    WrPageIn,
    WrPoolAllocation,
    WrDelayExecution,
    WrSuspended,
    WrUserRequest,
    WrEventPair,
    WrQueue,
    WrLpcReceive,
    WrLpcReply,
    WrVirtualMemory,
    WrPageOut,
    WrRendezvous,
    Spare2,
    Spare3,
    Spare4,
    Spare5,
    Spare6,
    WrKernel,
    MaximumWaitReason
    } KWAIT_REASON;


//
// Thread priority
//

typedef LONG KPRIORITY;

typedef struct _SYSTEM_THREAD
    {
    QWORD        qKernelTime;       // 100 nsec units
    QWORD        qUserTime;         // 100 nsec units
    QWORD        qCreateTime;       // relative to 01-01-1601
    DWORD        d18;
    PVOID        pStartAddress;
    CLIENT_ID    Cid;               // process/thread ids
    DWORD        dPriority;
    DWORD        dBasePriority;
    DWORD        dContextSwitches;
    DWORD        dThreadState;      // 2=running, 5=waiting
    KWAIT_REASON WaitReason;
    DWORD        dReserved01;
    }
        SYSTEM_THREAD,
     * PSYSTEM_THREAD,
    **PPSYSTEM_THREAD;

#define SYSTEM_THREAD_ \
        sizeof (SYSTEM_THREAD)

typedef struct _SYSTEM_PROCESS_INFORMATION
    {
    DWORD          dNext;           // relative offset
    DWORD          dThreadCount;
    DWORD          dReserved01;
    DWORD          dReserved02;
    DWORD          dReserved03;
    DWORD          dReserved04;
    DWORD          dReserved05;
    DWORD          dReserved06;
    QWORD          qCreateTime;     // relative to 01-01-1601
    QWORD          qUserTime;       // 100 nsec units
    QWORD          qKernelTime;     // 100 nsec units
    UNICODE_STRING usName;
    KPRIORITY      BasePriority;
    DWORD          dUniqueProcessId;
    DWORD          dInheritedFromUniqueProcessId;
    DWORD          dHandleCount;
    DWORD          dReserved07;
    DWORD          dReserved08;
    VM_COUNTERS    VmCounters;
    DWORD          dCommitCharge;   // bytes
    SYSTEM_THREAD  ast [];
    }
        SYSTEM_PROCESS_INFORMATION,
     * PSYSTEM_PROCESS_INFORMATION,
    **PPSYSTEM_PROCESS_INFORMATION;

/*#define SYSTEM_PROCESS_INFORMATION_ \
        sizeof (SYSTEM_PROCESS_INFORMATION)
typedef struct _SYSTEM_PROCESS_INFORMATION {
#ifdef __WINESRC__
    DWORD dwOffset;
    DWORD dwThreadCount;
    DWORD dwUnknown1[6];
    FILETIME ftCreationTime;
    FILETIME ftUserTime;
    FILETIME ftKernelTime;
    UNICODE_STRING ProcessName;
    DWORD dwBasePriority;
    DWORD dwProcessID;
    DWORD dwParentProcessID;
    DWORD dwHandleCount;
    DWORD dwUnknown3;
    DWORD dwUnknown4;
    VM_COUNTERS vmCounters;
    IO_COUNTERS ioCounters;
    SYSTEM_THREAD_INFORMATION ti[1];
#else
    ULONG NextEntryOffset;
    BYTE Reserved1[52];
    PVOID Reserved2[3];
    HANDLE UniqueProcessId;
    PVOID Reserved3;
    ULONG HandleCount;
    BYTE Reserved4[4];
    PVOID Reserved5[11];
    SIZE_T PeakPagefileUsage;
    SIZE_T PrivatePageCount;
    LARGE_INTEGER Reserved6[6];
#endif
} SYSTEM_PROCESS_INFORMATION, *PSYSTEM_PROCESS_INFORMATION;*/

typedef struct _SYSTEM_REGISTRY_QUOTA_INFORMATION {
    ULONG RegistryQuotaAllowed;
    ULONG RegistryQuotaUsed;
    PVOID Reserved1;
} SYSTEM_REGISTRY_QUOTA_INFORMATION, *PSYSTEM_REGISTRY_QUOTA_INFORMATION;

typedef struct _SYSTEM_TIME_ADJUSTMENT {
    ULONG   TimeAdjustment;
    BOOLEAN TimeAdjustmentDisabled;
} SYSTEM_TIME_ADJUSTMENT, *PSYSTEM_TIME_ADJUSTMENT;

typedef struct _TIME_FIELDS
{   CSHORT Year;
    CSHORT Month;
    CSHORT Day;
    CSHORT Hour;
    CSHORT Minute;
    CSHORT Second;
    CSHORT Milliseconds;
    CSHORT Weekday;
} TIME_FIELDS, *PTIME_FIELDS;

typedef struct _WINSTATIONINFORMATIONW {
  BYTE Reserved2[70];
  ULONG LogonId;
  BYTE Reserved3[1140];
} WINSTATIONINFORMATIONW, *PWINSTATIONINFORMATIONW;

typedef BOOLEAN (WINAPI * PWINSTATIONQUERYINFORMATIONW)(HANDLE,ULONG,WINSTATIONINFOCLASS,PVOID,ULONG,PULONG);

typedef struct _LDR_RESOURCE_INFO
{
    ULONG Type;
    ULONG Name;
    ULONG Language;
} LDR_RESOURCE_INFO, *PLDR_RESOURCE_INFO;


/* debug buffer definitions */

typedef struct _DEBUG_BUFFER {
  HANDLE SectionHandle;
  PVOID  SectionBase;
  PVOID  RemoteSectionBase;
  ULONG  SectionBaseDelta;
  HANDLE EventPairHandle;
  ULONG  Unknown[2];
  HANDLE RemoteThreadHandle;
  ULONG  InfoClassMask;
  ULONG  SizeOfInfo;
  ULONG  AllocatedSize;
  ULONG  SectionSize;
  PVOID  ModuleInformation;
  PVOID  BackTraceInformation;
  PVOID  HeapInformation;
  PVOID  LockInformation;
  PVOID  Reserved[8];
} DEBUG_BUFFER, *PDEBUG_BUFFER;

#define PDI_MODULES                       0x01
#define PDI_MODULESS                      0x80000001
#define PDI_BACKTRACE                     0x02
#define PDI_HEAPS                         0x04
#define PDI_HEAP_TAGS                     0x08
#define PDI_HEAP_BLOCKS                   0x10
#define PDI_LOCKS                         0x20

typedef struct _DEBUG_MODULE_INFORMATION {
  ULONG  Reserved[2];
  ULONG Base;
	ULONG Size;
	ULONG Flags;
  USHORT Index;
  USHORT Unknown;
  USHORT LoadCount;
  USHORT ModuleNameOffset; //  FullPathImageName     
  CHAR   FullPathImageName[256]; //ImageName=FullPathImageName+ModuleNameOffset
} DEBUG_MODULE_INFORMATION, *PDEBUG_MODULE_INFORMATION;

typedef struct _DEBUG_HEAP_INFORMATION {
  ULONG  Base;
  ULONG  Flags;
  USHORT Granularity;
  USHORT Unknown;
  ULONG  Allocated;
  ULONG  Committed;
  ULONG  TagCount;
  ULONG  BlockCount;
  ULONG  Reserved[7];
  PVOID  Tags;
  PVOID  Blocks;
} DEBUG_HEAP_INFORMATION, *PDEBUG_HEAP_INFORMATION;

typedef struct _DEBUG_LOCK_INFORMATION {
  PVOID  Address;
  USHORT Type;
  USHORT CreatorBackTraceIndex;
  ULONG  OwnerThreadId;
  ULONG  ActiveCount;
  ULONG  ContentionCount;
  ULONG  EntryCount;
  ULONG  RecursionCount;
  ULONG  NumberOfSharedWaiters;
  ULONG  NumberOfExclusiveWaiters;
} DEBUG_LOCK_INFORMATION, *PDEBUG_LOCK_INFORMATION;
struct SCSRSSPORT_MESSAGE
{
	ULONG u1;
	ULONG u2;
	union
	{
		CLIENT_ID ClientId;
		float DoNotUseThisField;
	};
	ULONG MessageId;
	union
	{
		ULONG ClientViewSize;
		ULONG CallbackId;
	};
};
typedef struct _PORT_MESSAGE_HEADER {
  USHORT DataSize;
  USHORT MessageSize;
  USHORT MessageType;
  USHORT VirtualRangesOffset;
  CLIENT_ID ClientId;
  ULONG MessageId;
  ULONG SectionSize;
} PORT_MESSAGE_HEADER, *PPORT_MESSAGE_HEADER, PORT_MESSAGE, *PPORT_MESSAGE;

typedef unsigned short RTL_ATOM, *PRTL_ATOM;

/* Wine doesn't implement atom table as NT does:
 * - in NT, atom tables are user space tables, which ntdll directly accesses
 * - on Wine, (even local) atom tables are wineserver object, hence a HANDLE
 */
typedef struct atom_table *RTL_ATOM_TABLE, **PRTL_ATOM_TABLE;

typedef enum _ATOM_INFORMATION_CLASS {
   AtomBasicInformation         = 0,
   AtomTableInformation         = 1,
} ATOM_INFORMATION_CLASS;

typedef struct _ATOM_BASIC_INFORMATION {
   USHORT       ReferenceCount;
   USHORT       Pinned;
   USHORT       NameLength;
   WCHAR        Name[1];
} ATOM_BASIC_INFORMATION, *PATOM_BASIC_INFORMATION;

/* FIXME: names probably not correct */
typedef struct _RTL_HANDLE
{
    struct _RTL_HANDLE * Next;
} RTL_HANDLE;

/* FIXME: names probably not correct */
typedef struct _RTL_HANDLE_TABLE
{
    ULONG MaxHandleCount;  /* 0x00 */
    ULONG HandleSize;      /* 0x04 */
    ULONG Unused[2];       /* 0x08-0x0c */
    PVOID NextFree;        /* 0x10 */
    PVOID FirstHandle;     /* 0x14 */
    PVOID ReservedMemory;  /* 0x18 */
    PVOID MaxHandle;       /* 0x1c */
} RTL_HANDLE_TABLE;

/***********************************************************************
 * Defines
 */

/* flags for NtCreateFile and NtOpenFile */
#define FILE_DIRECTORY_FILE             0x00000001
#define FILE_WRITE_THROUGH              0x00000002
#define FILE_SEQUENTIAL_ONLY            0x00000004
#define FILE_NO_INTERMEDIATE_BUFFERING  0x00000008
#define FILE_SYNCHRONOUS_IO_ALERT       0x00000010
#define FILE_SYNCHRONOUS_IO_NONALERT    0x00000020
#define FILE_NON_DIRECTORY_FILE         0x00000040
#define FILE_CREATE_TREE_CONNECTION     0x00000080
#define FILE_COMPLETE_IF_OPLOCKED       0x00000100
#define FILE_NO_EA_KNOWLEDGE            0x00000200
#define FILE_OPEN_FOR_RECOVERY          0x00000400
#define FILE_RANDOM_ACCESS              0x00000800
#define FILE_DELETE_ON_CLOSE            0x00001000
#define FILE_OPEN_BY_FILE_ID            0x00002000
#define FILE_OPEN_FOR_BACKUP_INTENT     0x00004000
#define FILE_NO_COMPRESSION             0x00008000
#define FILE_RESERVE_OPFILTER           0x00100000
#define FILE_TRANSACTED_MODE            0x00200000
#define FILE_OPEN_OFFLINE_FILE          0x00400000
#define FILE_OPEN_FOR_FREE_SPACE_QUERY  0x00800000

#define FILE_ATTRIBUTE_VALID_FLAGS      0x00007fb7
#define FILE_ATTRIBUTE_VALID_SET_FLAGS  0x000031a7

/* status for NtCreateFile or NtOpenFile */
#define FILE_SUPERSEDED                 0
#define FILE_OPENED                     1
#define FILE_CREATED                    2
#define FILE_OVERWRITTEN                3
#define FILE_EXISTS                     4
#define FILE_DOES_NOT_EXIST             5

/* disposition for NtCreateFile */
#define FILE_SUPERSEDE                  0
#define FILE_OPEN                       1
#define FILE_CREATE                     2
#define FILE_OPEN_IF                    3
#define FILE_OVERWRITE                  4
#define FILE_OVERWRITE_IF               5
#define FILE_MAXIMUM_DISPOSITION        5

/* Characteristics of a File System */
#define FILE_REMOVABLE_MEDIA            0x00000001
#define FILE_READ_ONLY_DEVICE           0x00000002
#define FILE_FLOPPY_DISKETTE            0x00000004
#define FILE_WRITE_ONE_MEDIA            0x00000008
#define FILE_REMOTE_DEVICE              0x00000010
#define FILE_DEVICE_IS_MOUNTED          0x00000020
#define FILE_VIRTUAL_VOLUME             0x00000040
#define FILE_AUTOGENERATED_DEVICE_NAME  0x00000080
#define FILE_DEVICE_SECURE_OPEN         0x00000100

/* options for NtCreateNamedPipeFile */
#define FILE_PIPE_INBOUND               0x00000000
#define FILE_PIPE_OUTBOUND              0x00000001
#define FILE_PIPE_FULL_DUPLEX           0x00000002

#if (_WIN32_WINNT >= 0x0501)
#define INTERNAL_TS_ACTIVE_CONSOLE_ID ( *((volatile ULONG*)(0x7ffe02d8)) )
#endif /* (_WIN32_WINNT >= 0x0501) */

#define LOGONID_CURRENT    ((ULONG)-1)

#define OBJ_INHERIT          0x00000002L
#define OBJ_PERMANENT        0x00000010L
#define OBJ_EXCLUSIVE        0x00000020L
#define OBJ_CASE_INSENSITIVE 0x00000040L
#define OBJ_OPENIF           0x00000080L
#define OBJ_OPENLINK         0x00000100L
#define OBJ_KERNEL_HANDLE    0x00000200L
#define OBJ_VALID_ATTRIBUTES 0x000003F2L
#define OBJ_FORCE_ACCESS_CHECK  0x00000400L

#define SERVERNAME_CURRENT ((HANDLE)NULL)

typedef void (CALLBACK *PNTAPCFUNC)(ULONG_PTR,ULONG_PTR,ULONG_PTR); /* FIXME: not the right name */
typedef void (CALLBACK *PRTL_THREAD_START_ROUTINE)(LPVOID); /* FIXME: not the right name */


/* DbgPrintEx default levels */
#define DPFLTR_ERROR_LEVEL     0
#define DPFLTR_WARNING_LEVEL   1
#define DPFLTR_TRACE_LEVEL     2
#define DPFLTR_INFO_LEVEL      3
#define DPFLTR_MASK    0x8000000

/* Well-known LUID values */
#define SE_MIN_WELL_KNOWN_PRIVILEGE       2L
#define SE_CREATE_TOKEN_PRIVILEGE         2L
#define SE_ASSIGNPRIMARYTOKEN_PRIVILEGE   3L
#define SE_LOCK_MEMORY_PRIVILEGE          4L
#define SE_INCREASE_QUOTA_PRIVILEGE       5L
#define SE_UNSOLICITED_INPUT_PRIVILEGE    6L /* obsolete */
#define SE_MACHINE_ACCOUNT_PRIVILEGE      6L
#define SE_TCB_PRIVILEGE                  7L
#define SE_SECURITY_PRIVILEGE             8L
#define SE_TAKE_OWNERSHIP_PRIVILEGE       9L
#define SE_LOAD_DRIVER_PRIVILEGE         10L
#define SE_SYSTEM_PROFILE_PRIVILEGE      11L
#define SE_SYSTEMTIME_PRIVILEGE          12L
#define SE_PROF_SINGLE_PROCESS_PRIVILEGE 13L
#define SE_INC_BASE_PRIORITY_PRIVILEGE   14L
#define SE_CREATE_PAGEFILE_PRIVILEGE     15L
#define SE_CREATE_PERMANENT_PRIVILEGE    16L
#define SE_BACKUP_PRIVILEGE              17L
#define SE_RESTORE_PRIVILEGE             18L
#define SE_SHUTDOWN_PRIVILEGE            19L
#define SE_DEBUG_PRIVILEGE               20L
#define SE_AUDIT_PRIVILEGE               21L
#define SE_SYSTEM_ENVIRONMENT_PRIVILEGE  22L
#define SE_CHANGE_NOTIFY_PRIVILLEGE      23L
#define SE_REMOTE_SHUTDOWN_PRIVILEGE     24L
#define SE_UNDOCK_PRIVILEGE              25L
#define SE_SYNC_AGENT_PRIVILEGE          26L
#define SE_ENABLE_DELEGATION_PRIVILEGE   27L
#define SE_MANAGE_VOLUME_PRIVILEGE       28L
#define SE_IMPERSONATE_PRIVILEGE         29L
#define SE_CREATE_GLOBAL_PRIVILEGE       30L
#define SE_MAX_WELL_KNOWN_PRIVILEGE      SE_CREATE_GLOBAL_PRIVILEGE


/* Rtl*Registry* functions structs and defines */
#define RTL_REGISTRY_ABSOLUTE             0
#define RTL_REGISTRY_SERVICES             1
#define RTL_REGISTRY_CONTROL              2
#define RTL_REGISTRY_WINDOWS_NT           3
#define RTL_REGISTRY_DEVICEMAP            4
#define RTL_REGISTRY_USER                 5

#define RTL_REGISTRY_HANDLE       0x40000000
#define RTL_REGISTRY_OPTIONAL     0x80000000

#define RTL_QUERY_REGISTRY_SUBKEY         0x00000001
#define RTL_QUERY_REGISTRY_TOPKEY         0x00000002
#define RTL_QUERY_REGISTRY_REQUIRED       0x00000004
#define RTL_QUERY_REGISTRY_NOVALUE        0x00000008
#define RTL_QUERY_REGISTRY_NOEXPAND       0x00000010
#define RTL_QUERY_REGISTRY_DIRECT         0x00000020
#define RTL_QUERY_REGISTRY_DELETE         0x00000040
#define DIRECTORY_QUERY                 (0x0001)
   #define DIRECTORY_TRAVERSE              (0x0002)
   #define DIRECTORY_CREATE_OBJECT         (0x0004)
   #define DIRECTORY_CREATE_SUBDIRECTORY   (0x0008)
   #define DIRECTORY_ALL_ACCESS (STANDARD_RIGHTS_REQUIRED | 0xF)

typedef NTSTATUS (WINAPI *PRTL_QUERY_REGISTRY_ROUTINE)( PCWSTR ValueName,
                                                        ULONG  ValueType,
                                                        PVOID  ValueData,
                                                        ULONG  ValueLength,
                                                        PVOID  Context,
                                                        PVOID  EntryContext);

typedef struct _RTL_QUERY_REGISTRY_TABLE
{
  PRTL_QUERY_REGISTRY_ROUTINE  QueryRoutine;
  ULONG  Flags;
  PWSTR  Name;
  PVOID  EntryContext;
  ULONG  DefaultType;
  PVOID  DefaultData;
  ULONG  DefaultLength;
} RTL_QUERY_REGISTRY_TABLE, *PRTL_QUERY_REGISTRY_TABLE;

typedef struct _KEY_MULTIPLE_VALUE_INFORMATION
{
  PUNICODE_STRING ValueName;
  ULONG DataLength;
  ULONG DataOffset;
  ULONG Type;
} KEY_MULTIPLE_VALUE_INFORMATION, *PKEY_MULTIPLE_VALUE_INFORMATION;

typedef VOID (*PTIMER_APC_ROUTINE) ( PVOID, ULONG, LONG );

typedef enum _EVENT_TYPE {
  NotificationEvent,
  SynchronizationEvent
} EVENT_TYPE, *PEVENT_TYPE;

typedef enum _EVENT_INFORMATION_CLASS {
  EventBasicInformation
} EVENT_INFORMATION_CLASS, *PEVENT_INFORMATION_CLASS;

typedef struct _EVENT_BASIC_INFORMATION {
  EVENT_TYPE EventType;
  LONG EventState;
} EVENT_BASIC_INFORMATION, *PEVENT_BASIC_INFORMATION;

typedef enum _SEMAPHORE_INFORMATION_CLASS {
  SemaphoreBasicInformation
} SEMAPHORE_INFORMATION_CLASS, *PSEMAPHORE_INFORMATION_CLASS;

typedef struct _SEMAPHORE_BASIC_INFORMATION {
  ULONG CurrentCount;
  ULONG MaximumCount;
} SEMAPHORE_BASIC_INFORMATION, *PSEMAPHORE_BASIC_INFORMATION;

typedef enum _SECTION_INFORMATION_CLASS
{
  SectionBasicInformation,
  SectionImageInformation,
} SECTION_INFORMATION_CLASS;

typedef struct _SECTION_BASIC_INFORMATION {
  ULONG BaseAddress;
  ULONG Attributes;
  LARGE_INTEGER Size;
} SECTION_BASIC_INFORMATION, *PSECTION_BASIC_INFORMATION;

typedef struct _SECTION_IMAGE_INFORMATION {
  PVOID EntryPoint;
  ULONG StackZeroBits;
  ULONG StackReserved;
  ULONG StackCommit;
  ULONG ImageSubsystem;
  WORD SubsystemVersionLow;
  WORD SubsystemVersionHigh;
  ULONG Unknown1;
  ULONG ImageCharacteristics;
  ULONG ImageMachineType;
  ULONG Unknown2[3];
} SECTION_IMAGE_INFORMATION, *PSECTION_IMAGE_INFORMATION;

typedef struct _LPC_SECTION_WRITE {
  ULONG Length;
  HANDLE SectionHandle;
  ULONG SectionOffset;
  ULONG ViewSize;
  PVOID ViewBase;
  PVOID TargetViewBase;
} LPC_SECTION_WRITE, *PLPC_SECTION_WRITE;

typedef struct _LPC_SECTION_READ {
  ULONG Length;
  ULONG ViewSize;
  PVOID ViewBase;
} LPC_SECTION_READ, *PLPC_SECTION_READ;

typedef struct _LPC_MESSAGE {
  USHORT DataSize;
  USHORT MessageSize;
  USHORT MessageType;
  USHORT VirtualRangesOffset;
  CLIENT_ID ClientId;
  ULONG MessageId;
  ULONG SectionSize;
  UCHAR Data[ANYSIZE_ARRAY];
} LPC_MESSAGE, *PLPC_MESSAGE;

typedef enum _SHUTDOWN_ACTION {
  ShutdownNoReboot,
  ShutdownReboot,
  ShutdownPowerOff
} SHUTDOWN_ACTION, *PSHUTDOWN_ACTION;

typedef enum _KPROFILE_SOURCE {
  ProfileTime,
  ProfileAlignmentFixup,
  ProfileTotalIssues,
  ProfilePipelineDry,
  ProfileLoadInstructions,
  ProfilePipelineFrozen,
  ProfileBranchInstructions,
  ProfileTotalNonissues,
  ProfileDcacheMisses,
  ProfileIcacheMisses,
  ProfileCacheMisses,
  ProfileBranchMispredictions,
  ProfileStoreInstructions,
  ProfileFpInstructions,
  ProfileIntegerInstructions,
  Profile2Issue,
  Profile3Issue,
  Profile4Issue,
  ProfileSpecialInstructions,
  ProfileTotalCycles,
  ProfileIcacheIssues,
  ProfileDcacheAccesses,
  ProfileMemoryBarrierCycles,
  ProfileLoadLinkedIssues,
  ProfileMaximum
} KPROFILE_SOURCE, *PKPROFILE_SOURCE;

typedef struct _OBJDIR_INFORMATION {
  UNICODE_STRING ObjectName;
  UNICODE_STRING ObjectTypeName;
  BYTE Data[1];
} OBJDIR_INFORMATION, *POBJDIR_INFORMATION;

typedef struct _INITIAL_TEB {
  PVOID StackBase;
  PVOID StackLimit;
  PVOID StackCommit;
  PVOID StackCommitMax;
  PVOID StackReserved;
} INITIAL_TEB, *PINITIAL_TEB;

typedef enum _PORT_INFORMATION_CLASS {
  PortNoInformation
} PORT_INFORMATION_CLASS, *PPORT_INFORMATION_CLASS;

typedef enum _IO_COMPLETION_INFORMATION_CLASS {
  IoCompletionBasicInformation
} IO_COMPLETION_INFORMATION_CLASS, *PIO_COMPLETION_INFORMATION_CLASS;

typedef enum _HARDERROR_RESPONSE_OPTION {
  OptionAbortRetryIgnore,
  OptionOk,
  OptionOkCancel,
  OptionRetryCancel,
  OptionYesNo,
  OptionYesNoCancel,
  OptionShutdownSystem
} HARDERROR_RESPONSE_OPTION, *PHARDERROR_RESPONSE_OPTION;

typedef enum _HARDERROR_RESPONSE {
  ResponseReturnToCaller,
  ResponseNotHandled,
  ResponseAbort,
  ResponseCancel,
  ResponseIgnore,
  ResponseNo,
  ResponseOk,
  ResponseRetry,
  ResponseYes
} HARDERROR_RESPONSE, *PHARDERROR_RESPONSE;

typedef enum _SYSDBG_COMMAND {
  SysDbgQueryModuleInformation,
  SysDbgQueryTraceInformation,
  SysDbgSetTracepoint,
  SysDbgSetSpecialCall,
  SysDbgClearSpecialCalls,
  SysDbgQuerySpecialCalls
} SYSDBG_COMMAND, *PSYSDBG_COMMAND;
 
/***********************************************************************
 * Function declarations
 */

//extern LPSTR _strlwr(LPSTR str); /* FIXME: Doesn't belong here */
//extern LPSTR _strupr(LPSTR str); /* FIXME: Doesn't belong here */

#if defined(__i386__) && defined(__GNUC__)
static inline void WINAPI DbgBreakPoint(void) { __asm__ __volatile__("int3"); }
static inline void WINAPI DbgUserBreakPoint(void) { __asm__ __volatile__("int3"); }
#else  /* __i386__ && __GNUC__ */
void WINAPI DbgBreakPoint(void);
void WINAPI DbgUserBreakPoint(void);
#endif  /* __i386__ && __GNUC__ */
#if defined(_CTEB_)
PTEB WINAPI NtCurrentTeb();
#endif

NTSTATUS WINAPIV DbgPrint(LPCSTR fmt, ...);
NTSTATUS WINAPIV DbgPrintEx(ULONG iComponentId, ULONG Level, LPCSTR fmt, ...);
NTSTATUS  WINAPI LdrAccessResource(HMODULE,const IMAGE_RESOURCE_DATA_ENTRY*,void**,PULONG);
NTSTATUS  WINAPI LdrFindResourceDirectory_U(HMODULE,const LDR_RESOURCE_INFO*,ULONG,const IMAGE_RESOURCE_DIRECTORY**);
NTSTATUS  WINAPI LdrFindResource_U(HMODULE,const LDR_RESOURCE_INFO*,ULONG,const IMAGE_RESOURCE_DATA_ENTRY**);
NTSTATUS  WINAPI LdrGetDllHandle(ULONG, ULONG, const UNICODE_STRING*, HMODULE*);
NTSTATUS  WINAPI LdrGetProcedureAddress(HMODULE, const ANSI_STRING*, ULONG, void**);
void      WINAPI LdrInitializeThunk(HANDLE,ULONG,ULONG,ULONG);
NTSTATUS  WINAPI LdrLoadDll(LPCWSTR, DWORD, const UNICODE_STRING*, HMODULE*);
void      WINAPI LdrShutdownProcess(void);
void      WINAPI LdrShutdownThread(void);
NTSTATUS  WINAPI NtAcceptConnectPort(PHANDLE,ULONG,PLPC_MESSAGE,BOOLEAN,PLPC_SECTION_WRITE,PLPC_SECTION_READ);
NTSTATUS  WINAPI NtAccessCheck(PSECURITY_DESCRIPTOR,HANDLE,ACCESS_MASK,PGENERIC_MAPPING,PPRIVILEGE_SET,PULONG,PULONG,NTSTATUS*);
NTSTATUS  WINAPI NtAccessCheckAndAuditAlarm(PUNICODE_STRING,HANDLE,PUNICODE_STRING,PUNICODE_STRING,PSECURITY_DESCRIPTOR,ACCESS_MASK,PGENERIC_MAPPING,BOOLEAN,PULONG,PULONG,PBOOLEAN);
NTSTATUS  WINAPI NtAddAtom(const WCHAR*,ULONG,RTL_ATOM*);
NTSTATUS  WINAPI NtAdjustGroupsToken(HANDLE,BOOLEAN,PTOKEN_GROUPS,ULONG,PTOKEN_GROUPS,PULONG);
NTSTATUS  WINAPI NtAdjustPrivilegesToken(HANDLE,BOOLEAN,PTOKEN_PRIVILEGES,DWORD,PTOKEN_PRIVILEGES,PDWORD);
NTSTATUS  WINAPI NtAlertResumeThread(HANDLE,PULONG);
NTSTATUS  WINAPI NtAlertThread(HANDLE ThreadHandle);
NTSTATUS  WINAPI NtAllocateLocallyUniqueId(PLUID lpLuid);
NTSTATUS  WINAPI NtAllocateUuids(PULARGE_INTEGER,PULONG,PULONG);
NTSTATUS  WINAPI NtAllocateVirtualMemory(HANDLE,PVOID*,ULONG,SIZE_T*,ULONG,ULONG);
NTSTATUS  WINAPI NtCallbackReturn(PVOID,ULONG,NTSTATUS);
NTSTATUS  WINAPI NtCancelIoFile(HANDLE,PIO_STATUS_BLOCK);
NTSTATUS  WINAPI NtCancelTimer(HANDLE, BOOLEAN*);
NTSTATUS  WINAPI NtClearEvent(HANDLE);
NTSTATUS  WINAPI NtClose(HANDLE);
NTSTATUS  WINAPI NtCloseObjectAuditAlarm(PUNICODE_STRING,HANDLE,BOOLEAN);
NTSTATUS  WINAPI NtCompleteConnectPort(HANDLE);
NTSTATUS  WINAPI NtConnectPort(PHANDLE,PUNICODE_STRING,PSECURITY_QUALITY_OF_SERVICE,PLPC_SECTION_WRITE,PLPC_SECTION_READ,PULONG,PVOID,PULONG);
NTSTATUS  WINAPI NtContinue(PCONTEXT,BOOLEAN); 
NTSTATUS  WINAPI NtCreateDirectoryObject(PHANDLE,ACCESS_MASK,POBJECT_ATTRIBUTES);
NTSTATUS  WINAPI NtCreateEvent(PHANDLE,ACCESS_MASK,const OBJECT_ATTRIBUTES *,BOOLEAN,BOOLEAN);
NTSTATUS  WINAPI NtCreateEventPair(PHANDLE,ACCESS_MASK,POBJECT_ATTRIBUTES);
NTSTATUS  WINAPI NtCreateFile(PHANDLE,ACCESS_MASK,POBJECT_ATTRIBUTES,PIO_STATUS_BLOCK,PLARGE_INTEGER,ULONG,ULONG,ULONG,ULONG,PVOID,ULONG);
NTSTATUS  WINAPI NtCreateIoCompletion(PHANDLE,ACCESS_MASK,POBJECT_ATTRIBUTES,ULONG);
NTSTATUS  WINAPI NtCreateKey(PHANDLE,ACCESS_MASK,const OBJECT_ATTRIBUTES*,ULONG,const UNICODE_STRING*,ULONG,PULONG);
NTSTATUS  WINAPI NtCreateMailslotFile(PHANDLE,ACCESS_MASK,POBJECT_ATTRIBUTES,PIO_STATUS_BLOCK,ULONG,ULONG,ULONG,PLARGE_INTEGER);
NTSTATUS  WINAPI NtCreateMutant(HANDLE*,ACCESS_MASK,const OBJECT_ATTRIBUTES*,BOOLEAN);
NTSTATUS  WINAPI NtCreateNamedPipeFile(PHANDLE,ULONG,POBJECT_ATTRIBUTES,PIO_STATUS_BLOCK,ULONG,ULONG,ULONG,ULONG,ULONG,ULONG,ULONG,ULONG,ULONG,PLARGE_INTEGER);
NTSTATUS  WINAPI NtCreatePagingFile(PUNICODE_STRING,PLARGE_INTEGER,PLARGE_INTEGER,PLARGE_INTEGER);
NTSTATUS  WINAPI NtCreatePort(PHANDLE,POBJECT_ATTRIBUTES,ULONG,ULONG,PULONG);
NTSTATUS  WINAPI NtCreateProcess(PHANDLE,ACCESS_MASK,POBJECT_ATTRIBUTES,HANDLE,BOOLEAN,HANDLE,HANDLE,HANDLE);
NTSTATUS  WINAPI NtCreateProfile(PHANDLE,HANDLE,PVOID,ULONG,ULONG,PVOID,ULONG,KPROFILE_SOURCE,KAFFINITY);
NTSTATUS  WINAPI NtCreateSection(HANDLE*,ACCESS_MASK,const OBJECT_ATTRIBUTES*,const LARGE_INTEGER*,ULONG,ULONG,HANDLE);
NTSTATUS  WINAPI NtCreateSemaphore(PHANDLE,ACCESS_MASK,const OBJECT_ATTRIBUTES*,LONG,LONG);
NTSTATUS  WINAPI NtCreateSymbolicLinkObject(PHANDLE,ACCESS_MASK,POBJECT_ATTRIBUTES,PUNICODE_STRING);
NTSTATUS  WINAPI NtCreateThread(PHANDLE,ACCESS_MASK,POBJECT_ATTRIBUTES,HANDLE,PCLIENT_ID,PCONTEXT,PINITIAL_TEB,BOOLEAN);
NTSTATUS  WINAPI NtCreateTimer(HANDLE*, ACCESS_MASK, const OBJECT_ATTRIBUTES*, TIMER_TYPE);
NTSTATUS  WINAPI NtCreateToken(PHANDLE,ACCESS_MASK,POBJECT_ATTRIBUTES,TOKEN_TYPE,PLUID,PLARGE_INTEGER,PTOKEN_USER,PTOKEN_GROUPS,PTOKEN_PRIVILEGES,PTOKEN_OWNER,PTOKEN_PRIMARY_GROUP,PTOKEN_DEFAULT_DACL,PTOKEN_SOURCE);
NTSTATUS  WINAPI NtDelayExecution(BOOLEAN,const LARGE_INTEGER*);
NTSTATUS  WINAPI NtDeleteAtom(RTL_ATOM);
NTSTATUS  WINAPI NtDeleteFile(POBJECT_ATTRIBUTES);
NTSTATUS  WINAPI NtDeleteKey(HANDLE);
NTSTATUS  WINAPI NtDeleteValueKey(HANDLE,const UNICODE_STRING *);
NTSTATUS  WINAPI NtDeviceIoControlFile(HANDLE,HANDLE,PIO_APC_ROUTINE,PVOID,PIO_STATUS_BLOCK,ULONG,PVOID,ULONG,PVOID,ULONG);
NTSTATUS  WINAPI NtDisplayString(PUNICODE_STRING); 
NTSTATUS  WINAPI NtDuplicateObject(HANDLE,HANDLE,HANDLE,PHANDLE,ACCESS_MASK,ULONG,ULONG);
NTSTATUS  WINAPI NtDuplicateToken(HANDLE,ACCESS_MASK,POBJECT_ATTRIBUTES,SECURITY_IMPERSONATION_LEVEL,TOKEN_TYPE,PHANDLE);
NTSTATUS  WINAPI NtEnumerateKey(HANDLE,ULONG,KEY_INFORMATION_CLASS,void *,DWORD,DWORD *);
NTSTATUS  WINAPI NtEnumerateValueKey(HANDLE,ULONG,KEY_VALUE_INFORMATION_CLASS,PVOID,ULONG,PULONG);
NTSTATUS  WINAPI NtExtendSection(HANDLE,PLARGE_INTEGER); 
NTSTATUS  WINAPI NtFindAtom(const WCHAR*,ULONG,RTL_ATOM*);
NTSTATUS  WINAPI NtFlushBuffersFile(HANDLE,IO_STATUS_BLOCK*);
NTSTATUS  WINAPI NtFlushInstructionCache(HANDLE,LPCVOID,SIZE_T);
NTSTATUS  WINAPI NtFlushKey(HANDLE);
NTSTATUS  WINAPI NtFlushVirtualMemory(HANDLE,LPCVOID*,SIZE_T*,ULONG);
NTSTATUS  WINAPI NtFlushWriteBuffer(VOID);
NTSTATUS  WINAPI NtFreeVirtualMemory(HANDLE,PVOID*,SIZE_T*,ULONG);
NTSTATUS  WINAPI NtFsControlFile(HANDLE,HANDLE,PIO_APC_ROUTINE,PVOID,PIO_STATUS_BLOCK,ULONG,PVOID,ULONG,PVOID,ULONG);
NTSTATUS  WINAPI NtGetContextThread(HANDLE,CONTEXT*);
PIMAGE_BASE_RELOCATION NTAPI LdrProcessRelocationBlock 	(	IN ULONG_PTR 	Address, 
	IN ULONG 	Count, 
	IN PUSHORT 	TypeOffset, 
	IN LONG_PTR 	Delta	 
	);
typedef enum _PLUGPLAY_EVENT_CATEGORY {
   HardwareProfileChangeEvent,
   TargetDeviceChangeEvent,
   DeviceClassChangeEvent,
   CustomDeviceEvent,
   DeviceInstallEvent,
   DeviceArrivalEvent,
   PowerEvent,
   VetoEvent,
   BlockedDriverEvent,
   MaxPlugEventCategory
} PLUGPLAY_EVENT_CATEGORY;

typedef enum _PNP_VETO_TYPE {
   PNP_VetoTypeUnknown,
   PNP_VetoLegacyDevice,
   PNP_VetoPendingClose,
   PNP_VetoWindowsApp,
   PNP_VetoWindowsService,
   PNP_VetoOutstandingOpen,
   PNP_VetoDevice,
   PNP_VetoDriver,
   PNP_VetoIllegalDeviceRequest,
   PNP_VetoInsufficientPower,
   PNP_VetoNonDisableable,
   PNP_VetoLegacyDriver,
   PNP_VetoInsufficientRights,
} PNP_VETO_TYPE;

/*
 * Plug and Play event structure used by NtGetPlugPlayEvent.
 *
 * EventGuid
 *    Can be one of the following values:
 *       GUID_HWPROFILE_QUERY_CHANGE
 *       GUID_HWPROFILE_CHANGE_CANCELLED
 *       GUID_HWPROFILE_CHANGE_COMPLETE
 *       GUID_TARGET_DEVICE_QUERY_REMOVE
 *       GUID_TARGET_DEVICE_REMOVE_CANCELLED
 *       GUID_TARGET_DEVICE_REMOVE_COMPLETE
 *       GUID_PNP_CUSTOM_NOTIFICATION
 *       GUID_PNP_POWER_NOTIFICATION
 *       GUID_DEVICE_* (see above)
 *
 * EventCategory
 *    Type of the event that happened.
 *
 * Result
 *    ?
 *
 * Flags
 *    ?
 *
 * TotalSize
 *    Size of the event block including the device IDs and other
 *    per category specific fields.
 */
//
// Device Object structure definition

typedef struct _PLUGPLAY_EVENT_BLOCK {
   GUID EventGuid;
   PLUGPLAY_EVENT_CATEGORY EventCategory;
   PULONG Result;
   ULONG Flags;
   ULONG TotalSize;
   PVOID DeviceObject;//PDEVICE_OBJECT
   union 
	 {
      struct _DeviceClass 
			{
         GUID ClassGuid;
         WCHAR SymbolicLinkName[1];
      }DeviceClass;
      struct _TargetDevice 
			{
         WCHAR DeviceIds[1];
      }TargetDevice;
      struct _InstallDevice 
			{
         WCHAR DeviceId[1];
      }InstallDevice;
      struct _CustomNotification 
			{
         PVOID NotificationStructure;
         WCHAR DeviceIds[1];
      }CustomNotification;
      struct _ProfileNotification 
			{
         PVOID Notification;
      }ProfileNotification;
      struct _PowerNotification 
			{
         ULONG NotificationCode;
         ULONG NotificationData;
      }PowerNotification;
      struct _VetoNotification 
			{
         PNP_VETO_TYPE VetoType;
         WCHAR DeviceIdVetoNameBuffer[1];
      }VetoNotification;
      struct _BlockedDriverNotification 
			{
         GUID BlockedDriverGuid;
      }BlockedDriverNotification;
   }PLUGPLAYUNION;
} PLUGPLAY_EVENT_BLOCK, *PPLUGPLAY_EVENT_BLOCK;
NTSTATUS  WINAPI NtGetPlugPlayEvent(ULONG,ULONG,PVOID,ULONG);
//
// Plag and Play Classes
//
typedef enum _PLUGPLAY_CONTROL_CLASS
{
	  ReenumerateDeviceTree=0x00,
	  RegisterNewDevice=0x01,
		DeregisterDevice=0x02,
    InitializeDevice=0x03,
		StartDevice=0x04,
		UnknownX=0x05,
		QueryAndRemoveDevice=0x06,
    PlugPlayControlUserResponse = 0x07,
		GenerateLegacyDevice=0x08,
		GetInterfaceDeviceList=0x09,
    PlugPlayControlProperty = 0x0A,
		DeviceClassAssociationAndRegistration=0x0B,
    PlugPlayControlGetRelatedDevice = 0x0C,
		GetDeviceInterfaceAlias=0x0D,
    PlugPlayControlDeviceStatus = 0x0E,
    PlugPlayControlGetDeviceDepth=0x0F,
		QueryDeviceRelations=0x10,
		QueryTargetDeviceRelation=0x11,
		QueryConflictList=0x12,
		RetrieveDockData=0x13,
    PlugPlayControlResetDevice = 0x14,
		HaltDevice=0x15,
		GetBlockedDriverData=0x16
} PLUGPLAY_CONTROL_CLASS;
//Class 0x0A
typedef struct _PLUGPLAY_CONTROL_PROPERTY_DATA
{
    UNICODE_STRING DeviceInstance;
    ULONG Property;
    PVOID Buffer;
    ULONG BufferSize;
} PLUGPLAY_CONTROL_PROPERTY_DATA, *PPLUGPLAY_CONTROL_PROPERTY_DATA;
NTSTATUS  WINAPI NtPlugPlayControl(PLUGPLAY_CONTROL_CLASS,PVOID Buffer,ULONG BufferSize);
ULONG     WINAPI NtGetTickCount(VOID);
NTSTATUS  WINAPI RtlDecompressBuffer(USHORT, PUCHAR, ULONG, PUCHAR, ULONG, PULONG);
NTSTATUS  WINAPI NtImpersonateAnonymousToken(HANDLE);
NTSTATUS  WINAPI NtImpersonateClientOfPort(HANDLE,PPORT_MESSAGE);
NTSTATUS  WINAPI NtImpersonateThread(HANDLE,HANDLE,PSECURITY_QUALITY_OF_SERVICE);
NTSTATUS  WINAPI NtInitializeRegistry(BOOLEAN);
NTSTATUS  WINAPI NtInitiatePowerAction(POWER_ACTION,SYSTEM_POWER_STATE,ULONG,BOOLEAN);
NTSTATUS  WINAPI NtListenPort(HANDLE,PLPC_MESSAGE);
NTSTATUS  WINAPI NtLoadDriver(const UNICODE_STRING *);
NTSTATUS  WINAPI NtLoadKey(const OBJECT_ATTRIBUTES *,OBJECT_ATTRIBUTES *);
NTSTATUS  WINAPI NtLockFile(HANDLE,HANDLE,PIO_APC_ROUTINE,void*,PIO_STATUS_BLOCK,PLARGE_INTEGER,PLARGE_INTEGER,ULONG*,BOOLEAN,BOOLEAN);
NTSTATUS  WINAPI NtLockVirtualMemory(HANDLE,PVOID*,SIZE_T*,ULONG);
NTSTATUS  WINAPI NtMakeTemporaryObject(HANDLE); 
NTSTATUS  WINAPI NtMapViewOfSection(HANDLE,HANDLE,PVOID*,ULONG,SIZE_T,const LARGE_INTEGER*,SIZE_T*,SECTION_INHERIT,ULONG,ULONG);
NTSTATUS  WINAPI NtNotifyChangeDirectoryFile(HANDLE,HANDLE,PIO_APC_ROUTINE,PVOID,PIO_STATUS_BLOCK,PVOID,ULONG,ULONG,BOOLEAN);
NTSTATUS  WINAPI NtNotifyChangeKey(HANDLE,HANDLE,PIO_APC_ROUTINE,PVOID,PIO_STATUS_BLOCK,ULONG,BOOLEAN,PVOID,ULONG,BOOLEAN);
NTSTATUS  WINAPI NtOpenDirectoryObject(PHANDLE,ACCESS_MASK,POBJECT_ATTRIBUTES);
NTSTATUS  WINAPI NtOpenEvent(PHANDLE,ACCESS_MASK,const OBJECT_ATTRIBUTES *);
NTSTATUS  WINAPI NtOpenEventPair(PHANDLE,ACCESS_MASK,POBJECT_ATTRIBUTES);
NTSTATUS  WINAPI NtOpenFile(PHANDLE,ACCESS_MASK,POBJECT_ATTRIBUTES,PIO_STATUS_BLOCK,ULONG,ULONG);
NTSTATUS  WINAPI NtOpenIoCompletion(PHANDLE,ACCESS_MASK,POBJECT_ATTRIBUTES);
NTSTATUS  WINAPI NtOpenKey(PHANDLE,ACCESS_MASK,const OBJECT_ATTRIBUTES *);
NTSTATUS  WINAPI NtOpenMutant(PHANDLE,ACCESS_MASK,const OBJECT_ATTRIBUTES*);
NTSTATUS  WINAPI NtOpenObjectAuditAlarm(PUNICODE_STRING,PHANDLE,PUNICODE_STRING,PUNICODE_STRING,PSECURITY_DESCRIPTOR,HANDLE,ACCESS_MASK,ACCESS_MASK,PPRIVILEGE_SET,BOOLEAN,BOOLEAN,PBOOLEAN);
NTSTATUS  WINAPI NtOpenProcess(PHANDLE,ACCESS_MASK,const OBJECT_ATTRIBUTES*,const CLIENT_ID*);
NTSTATUS  WINAPI NtOpenProcessToken(HANDLE,DWORD,HANDLE *);
NTSTATUS  WINAPI NtOpenSection(HANDLE*,ACCESS_MASK,const OBJECT_ATTRIBUTES*);
NTSTATUS  WINAPI NtOpenSemaphore(PHANDLE,ACCESS_MASK,const OBJECT_ATTRIBUTES*);
NTSTATUS  WINAPI NtOpenSymbolicLinkObject(PHANDLE,ACCESS_MASK,POBJECT_ATTRIBUTES);
NTSTATUS  WINAPI NtOpenThread(HANDLE*,ACCESS_MASK,const OBJECT_ATTRIBUTES*,const CLIENT_ID*);
NTSTATUS  WINAPI NtOpenThreadToken(HANDLE,DWORD,BOOLEAN,HANDLE *);
NTSTATUS  WINAPI NtOpenTimer(HANDLE*, ACCESS_MASK, const OBJECT_ATTRIBUTES*);
NTSTATUS  WINAPI NtPowerInformation(POWER_INFORMATION_LEVEL,PVOID,ULONG,PVOID,ULONG);
NTSTATUS  WINAPI NtPrivilegeCheck(HANDLE,PPRIVILEGE_SET,PBOOLEAN);
NTSTATUS  WINAPI NtPrivilegeObjectAuditAlarm(PUNICODE_STRING,HANDLE,HANDLE,ULONG,PPRIVILEGE_SET,BOOLEAN);
NTSTATUS  WINAPI NtPrivilegedServiceAuditAlarm(PUNICODE_STRING,PUNICODE_STRING,HANDLE,PPRIVILEGE_SET,BOOLEAN);
NTSTATUS  WINAPI NtProtectVirtualMemory(HANDLE,PVOID*,SIZE_T*,ULONG,ULONG*);
NTSTATUS  WINAPI NtPulseEvent(HANDLE,PULONG);
NTSTATUS  WINAPI NtQueueApcThread(HANDLE,PNTAPCFUNC,ULONG_PTR,ULONG_PTR,ULONG_PTR);
NTSTATUS  WINAPI NtQueryAttributesFile(const OBJECT_ATTRIBUTES*,FILE_BASIC_INFORMATION*);
NTSTATUS  WINAPI NtQueryDefaultLocale(BOOLEAN,LCID*);
NTSTATUS  WINAPI NtQueryDefaultUILanguage(LANGID*);
NTSTATUS  WINAPI NtQueryDirectoryFile(HANDLE,HANDLE,PIO_APC_ROUTINE,PVOID,PIO_STATUS_BLOCK,PVOID,ULONG,FILE_INFORMATION_CLASS,BOOLEAN,PUNICODE_STRING,BOOLEAN);
NTSTATUS  WINAPI NtQueryDirectoryObject(HANDLE,POBJDIR_INFORMATION,ULONG,BOOLEAN,BOOLEAN,PULONG,PULONG);
NTSTATUS  WINAPI NtQueryEaFile(HANDLE,PIO_STATUS_BLOCK,PVOID,ULONG,BOOLEAN,PVOID,ULONG,PVOID,BOOLEAN);
NTSTATUS  WINAPI NtQueryEvent(HANDLE,EVENT_INFORMATION_CLASS,PVOID,ULONG,PULONG); 
NTSTATUS  WINAPI NtQueryFullAttributesFile(const OBJECT_ATTRIBUTES*,FILE_NETWORK_OPEN_INFORMATION*);
NTSTATUS  WINAPI NtQueryInformationAtom(RTL_ATOM,ATOM_INFORMATION_CLASS,RTL_ATOM_TABLE,ULONG,ULONG*);
NTSTATUS  WINAPI NtQueryInformationFile(HANDLE,PIO_STATUS_BLOCK,PVOID,LONG,FILE_INFORMATION_CLASS);
NTSTATUS  WINAPI NtQueryInformationPort(HANDLE,PORT_INFORMATION_CLASS,PVOID,ULONG,PULONG);
NTSTATUS  WINAPI NtQueryInformationProcess(HANDLE,PROCESSINFOCLASS,PVOID,ULONG,PULONG);
NTSTATUS  WINAPI NtQueryInformationThread(HANDLE,THREADINFOCLASS,PVOID,ULONG,PULONG);
NTSTATUS  WINAPI NtQueryInformationToken(HANDLE,DWORD,LPVOID,DWORD,LPDWORD);
NTSTATUS  WINAPI NtQueryInstallUILanguage(LANGID*);
NTSTATUS  WINAPI NtQueryIntervalProfile(KPROFILE_SOURCE,PULONG);
NTSTATUS  WINAPI NtQueryIoCompletion(HANDLE,IO_COMPLETION_INFORMATION_CLASS,PVOID,ULONG,PULONG);
NTSTATUS  WINAPI NtQueryKey(HANDLE,KEY_INFORMATION_CLASS,void *,DWORD,DWORD *);
NTSTATUS  WINAPI NtQueryMultipleValueKey(HANDLE,PKEY_MULTIPLE_VALUE_INFORMATION,ULONG,PVOID,ULONG,PULONG);
NTSTATUS  WINAPI NtQueryMutant(HANDLE,MUTANT_INFORMATION_CLASS,PVOID,ULONG,PULONG); 
NTSTATUS  WINAPI NtQueryObject(HANDLE, OBJECT_INFORMATION_CLASS, PVOID, ULONG, PULONG);
NTSTATUS  WINAPI NtQueryOpenSubKeys(POBJECT_ATTRIBUTES,PULONG);
NTSTATUS  WINAPI NtQueryPerformanceCounter(PLARGE_INTEGER, PLARGE_INTEGER);
NTSTATUS  WINAPI NtQuerySecurityObject(HANDLE,SECURITY_INFORMATION,PSECURITY_DESCRIPTOR,ULONG,PULONG);
NTSTATUS  WINAPI NtQuerySection(HANDLE,SECTION_INFORMATION_CLASS,PVOID,ULONG,PULONG); 
NTSTATUS  WINAPI NtQuerySemaphore(HANDLE,SEMAPHORE_INFORMATION_CLASS,PVOID,ULONG,PULONG);
NTSTATUS  WINAPI NtQuerySymbolicLinkObject(HANDLE,PUNICODE_STRING,PULONG);
NTSTATUS  WINAPI NtQuerySystemEnvironmentValue(PUNICODE_STRING,PWCHAR,ULONG,PULONG);
NTSTATUS  WINAPI NtQuerySystemInformation(SYSTEM_INFORMATION_CLASS,PVOID,ULONG,PULONG);
NTSTATUS  WINAPI NtQuerySystemTime(PLARGE_INTEGER);
NTSTATUS  WINAPI NtQueryTimer(HANDLE,TIMER_INFORMATION_CLASS,PVOID,ULONG,PULONG);
NTSTATUS  WINAPI NtQueryTimerResolution(PULONG,PULONG,PULONG);
NTSTATUS  WINAPI NtQueryValueKey(HANDLE,const UNICODE_STRING *,KEY_VALUE_INFORMATION_CLASS,void *,DWORD,DWORD *);
NTSTATUS  WINAPI NtQueryVirtualMemory(HANDLE,LPCVOID,MEMORY_INFORMATION_CLASS,PVOID,SIZE_T,SIZE_T*);
NTSTATUS  WINAPI NtQueryVolumeInformationFile(HANDLE,PIO_STATUS_BLOCK,PVOID,ULONG,FS_INFORMATION_CLASS);
void      WINAPI NtRaiseException(PEXCEPTION_RECORD,PCONTEXT,BOOL);
NTSTATUS  WINAPI NtRaiseHardError(NTSTATUS,ULONG,PUNICODE_STRING,PVOID*,HARDERROR_RESPONSE_OPTION,PHARDERROR_RESPONSE);
NTSTATUS  WINAPI NtReadFile(HANDLE,HANDLE,PIO_APC_ROUTINE,PVOID,PIO_STATUS_BLOCK,PVOID,ULONG,PLARGE_INTEGER,PULONG);
NTSTATUS  WINAPI NtReadFileScatter(HANDLE,HANDLE,PIO_APC_ROUTINE,PVOID,PIO_STATUS_BLOCK,FILE_SEGMENT_ELEMENT,ULONG,PLARGE_INTEGER,PULONG);
NTSTATUS  WINAPI NtReadRequestData(HANDLE,PLPC_MESSAGE,ULONG,PVOID,ULONG,PULONG);
NTSTATUS  WINAPI NtReadVirtualMemory(HANDLE,const void*,void*,SIZE_T,SIZE_T*);
NTSTATUS  WINAPI NtRegisterThreadTerminatePort(HANDLE); 
NTSTATUS  WINAPI NtReleaseMutant(HANDLE,PLONG);
NTSTATUS  WINAPI NtReleaseSemaphore(HANDLE,ULONG,PULONG);
NTSTATUS  WINAPI NtRemoveIoCompletion(HANDLE,PULONG,PULONG,PIO_STATUS_BLOCK,PLARGE_INTEGER);
NTSTATUS  WINAPI NtReplaceKey(POBJECT_ATTRIBUTES,HANDLE,POBJECT_ATTRIBUTES);
NTSTATUS  WINAPI NtReplyPort(HANDLE,PLPC_MESSAGE);
NTSTATUS  WINAPI NtReplyWaitReceivePort(HANDLE,PULONG,PLPC_MESSAGE,PLPC_MESSAGE);
NTSTATUS  WINAPI NtReplyWaitReceivePortEx(HANDLE,PVOID*,PPORT_MESSAGE,PPORT_MESSAGE,PLARGE_INTEGER);
NTSTATUS  WINAPI NtReplyWaitReplyPort(HANDLE,PLPC_MESSAGE);
NTSTATUS  WINAPI NtRequestPort(HANDLE,PLPC_MESSAGE);
NTSTATUS  WINAPI NtRequestWaitReplyPort(HANDLE,PLPC_MESSAGE,PLPC_MESSAGE);
NTSTATUS  WINAPI NtResetEvent(HANDLE,PULONG);
NTSTATUS  WINAPI NtRestoreKey(HANDLE,HANDLE,ULONG);
NTSTATUS  WINAPI NtResumeThread(HANDLE,PULONG);
NTSTATUS  WINAPI NtResumeProcess(HANDLE);
NTSTATUS  WINAPI NtSaveKey(HANDLE,HANDLE);
NTSTATUS  WINAPI NtSecureConnectPort(PHANDLE,PUNICODE_STRING,PSECURITY_QUALITY_OF_SERVICE,PLPC_SECTION_WRITE,PSID,PLPC_SECTION_READ,PULONG,PVOID,PULONG);
NTSTATUS  WINAPI NtSetContextThread(HANDLE,const CONTEXT*);
NTSTATUS  WINAPI NtSetDefaultHardErrorPort(HANDLE); 
NTSTATUS  WINAPI NtSetDefaultLocale(BOOLEAN,LCID);
NTSTATUS  WINAPI NtSetDefaultUILanguage(LANGID);
NTSTATUS  WINAPI NtSetEaFile(HANDLE,PIO_STATUS_BLOCK,PVOID,ULONG);
NTSTATUS  WINAPI NtSetEvent(HANDLE,PULONG);
NTSTATUS  WINAPI NtSetHighEventPair(HANDLE); 
NTSTATUS  WINAPI NtSetHighWaitLowEventPair(HANDLE); 
NTSTATUS  WINAPI NtSetHighWaitLowThread(VOID);
NTSTATUS  WINAPI NtSetInformationFile(HANDLE,PIO_STATUS_BLOCK,PVOID,ULONG,FILE_INFORMATION_CLASS);
NTSTATUS  WINAPI NtSetInformationKey(HANDLE,const int,PVOID,ULONG);
NTSTATUS  WINAPI NtSetInformationObject(HANDLE, OBJECT_INFORMATION_CLASS, PVOID, ULONG);
NTSTATUS  WINAPI NtSetInformationProcess(HANDLE,PROCESS_INFORMATION_CLASS,PVOID,ULONG);
NTSTATUS  WINAPI NtSetInformationThread(HANDLE,THREADINFOCLASS,LPCVOID,ULONG);
NTSTATUS  WINAPI NtSetInformationToken(HANDLE,TOKEN_INFORMATION_CLASS,PVOID,ULONG);
NTSTATUS  WINAPI NtSetIntervalProfile(ULONG,KPROFILE_SOURCE);
NTSTATUS  WINAPI NtSetIoCompletion(HANDLE,ULONG,ULONG,NTSTATUS,ULONG);
NTSTATUS  WINAPI NtSetLdtEntries(ULONG,LDT_ENTRY,ULONG,LDT_ENTRY);
NTSTATUS  WINAPI NtSetLowEventPair(HANDLE); 
NTSTATUS  WINAPI NtSetLowWaitHighEventPair(HANDLE); 
NTSTATUS  WINAPI NtSetLowWaitHighThread(VOID); 
NTSTATUS  WINAPI NtSetSecurityObject(HANDLE,SECURITY_INFORMATION,PSECURITY_DESCRIPTOR);
NTSTATUS  WINAPI NtSetSystemEnvironmentValue(PUNICODE_STRING,PUNICODE_STRING);
NTSTATUS  WINAPI NtSetSystemInformation(SYSTEM_INFORMATION_CLASS,PVOID,ULONG);
NTSTATUS  WINAPI NtSetSystemPowerState(POWER_ACTION,SYSTEM_POWER_STATE,ULONG);
NTSTATUS  WINAPI NtSetSystemTime(const LARGE_INTEGER*,LARGE_INTEGER*);
NTSTATUS  WINAPI NtSetTimer(HANDLE, const LARGE_INTEGER*, PTIMER_APC_ROUTINE, PVOID, BOOLEAN, ULONG, BOOLEAN*);
NTSTATUS  WINAPI NtSetTimerResolution(ULONG,BOOLEAN,PULONG); 
NTSTATUS  WINAPI NtSetValueKey(HANDLE,const UNICODE_STRING *,ULONG,ULONG,const void *,ULONG);
NTSTATUS  WINAPI NtSetVolumeInformationFile(HANDLE,PIO_STATUS_BLOCK,PVOID,ULONG,FS_INFORMATION_CLASS);
NTSTATUS  WINAPI NtSignalAndWaitForSingleObject(HANDLE,HANDLE,BOOLEAN,const LARGE_INTEGER*);
NTSTATUS  WINAPI NtShutdownSystem(SHUTDOWN_ACTION); 
NTSTATUS  WINAPI NtStartProfile(HANDLE); 
NTSTATUS  WINAPI NtStopProfile(HANDLE); 
NTSTATUS  WINAPI NtSuspendThread(HANDLE,PULONG);
NTSTATUS  WINAPI NtSystemDebugControl(SYSDBG_COMMAND,PVOID,ULONG,PVOID,ULONG,PULONG);
NTSTATUS  WINAPI NtSuspendProcess(HANDLE ProcessHandle);
NTSTATUS  WINAPI NtTerminateProcess(HANDLE,LONG);
NTSTATUS  WINAPI NtTerminateThread(HANDLE,LONG);
NTSTATUS  WINAPI NtTestAlert(VOID); 
NTSTATUS  WINAPI NtUnloadDriver(const UNICODE_STRING *);
NTSTATUS  WINAPI NtUnloadKey(HANDLE);
NTSTATUS  WINAPI NtUnloadKeyEx(POBJECT_ATTRIBUTES,HANDLE);
NTSTATUS  WINAPI NtUnlockFile(HANDLE,PIO_STATUS_BLOCK,PLARGE_INTEGER,PLARGE_INTEGER,PULONG);
NTSTATUS  WINAPI NtUnlockVirtualMemory(HANDLE,PVOID*,SIZE_T*,ULONG);
NTSTATUS  WINAPI NtUnmapViewOfSection(HANDLE,PVOID);
NTSTATUS  WINAPI NtVdmControl(ULONG,PVOID); 
NTSTATUS  WINAPI NtWaitForSingleObject(HANDLE,BOOLEAN,const LARGE_INTEGER*);
NTSTATUS  WINAPI NtWaitForMultipleObjects(ULONG,const HANDLE*,BOOLEAN,BOOLEAN,const LARGE_INTEGER*);
NTSTATUS  WINAPI NtWaitHighEventPair(HANDLE); 
NTSTATUS  WINAPI NtWaitLowEventPair(HANDLE); 
NTSTATUS  WINAPI NtWriteFile(HANDLE,HANDLE,PIO_APC_ROUTINE,PVOID,PIO_STATUS_BLOCK,const void*,ULONG,PLARGE_INTEGER,PULONG);
NTSTATUS  WINAPI NtWriteFileGather(HANDLE,HANDLE,PIO_APC_ROUTINE,PVOID,PIO_STATUS_BLOCK,FILE_SEGMENT_ELEMENT,ULONG,PLARGE_INTEGER,PULONG);
NTSTATUS  WINAPI NtWriteRequestData(HANDLE,PLPC_MESSAGE,ULONG,PVOID,ULONG,PULONG);
NTSTATUS  WINAPI NtWriteVirtualMemory(HANDLE,void*,const void*,SIZE_T,SIZE_T*);
NTSTATUS  WINAPI NtYieldExecution(void);
NTSTATUS	WINAPI RtlGetCompressionWorkSpaceSize(USHORT, PULONG, PULONG);
#define COMPRESSION_FORMAT_NONE		(0x0000)		// [result:STATUS_INVALID_PARAMETER]
#define COMPRESSION_FORMAT_DEFAULT	(0x0001)		// [result:STATUS_INVALID_PARAMETER]
#define COMPRESSION_FORMAT_LZNT1	(0x0002)
#define COMPRESSION_FORMAT_NS3		(0x0003)		// STATUS_NOT_SUPPORTED
#define COMPRESSION_FORMAT_NS15		(0x000F)		// STATUS_NOT_SUPPORTED
#define COMPRESSION_FORMAT_SPARSE	(0x4000)		// ??? [result:STATUS_INVALID_PARAMETER]

#define COMPRESSION_ENGINE_STANDARD	(0x0000)		// Standart compression
#define COMPRESSION_ENGINE_MAXIMUM	(0x0100)		// Maximum (slowest but better)
#define COMPRESSION_ENGINE_HIBER	(0x0200)		// STATUS_NOT_SUPPORTED
NTSTATUS  WINAPI RtlCompressBuffer(IN ULONG CompressionFormat,IN PVOID SourceBuffer,IN ULONG SourceBufferLength,OUT PVOID DestinationBuffer,IN ULONG DestinationBufferLength,IN ULONG Unknown,OUT PULONG pDestinationSize,IN PVOID WorkspaceBuffer);
void      WINAPI RtlAcquirePebLock(void);
BYTE      WINAPI RtlAcquireResourceExclusive(LPRTL_RWLOCK,BYTE);
BYTE      WINAPI RtlAcquireResourceShared(LPRTL_RWLOCK,BYTE);
NTSTATUS  WINAPI RtlAddAce(PACL,DWORD,DWORD,PACE_HEADER,DWORD);
NTSTATUS  WINAPI RtlAddAccessAllowedAce(PACL,DWORD,DWORD,PSID);
NTSTATUS  WINAPI RtlAddAccessAllowedAceEx(PACL,DWORD,DWORD,DWORD,PSID);
NTSTATUS  WINAPI RtlAddAccessDeniedAce(PACL,DWORD,DWORD,PSID);
NTSTATUS  WINAPI RtlAddAccessDeniedAceEx(PACL,DWORD,DWORD,DWORD,PSID);
NTSTATUS  WINAPI RtlAddAtomToAtomTable(RTL_ATOM_TABLE,const WCHAR*,RTL_ATOM*);
NTSTATUS  WINAPI RtlAddAuditAccessAce(PACL,DWORD,DWORD,PSID,BOOL,BOOL); 
PVOID     WINAPI RtlAddVectoredExceptionHandler(ULONG,PVECTORED_EXCEPTION_HANDLER);
NTSTATUS  WINAPI RtlAdjustPrivilege(ULONG,BOOLEAN,BOOLEAN,PBOOLEAN);
NTSTATUS  WINAPI RtlAllocateAndInitializeSid(PSID_IDENTIFIER_AUTHORITY,BYTE,DWORD,DWORD,DWORD,DWORD,DWORD,DWORD,DWORD,DWORD,PSID *);
RTL_HANDLE * WINAPI RtlAllocateHandle(RTL_HANDLE_TABLE *,ULONG *);
PVOID     WINAPI RtlAllocateHeap(HANDLE,ULONG,SIZE_T);
WCHAR     WINAPI RtlAnsiCharToUnicodeChar(LPSTR *);
DWORD     WINAPI RtlAnsiStringToUnicodeSize(const STRING *);
NTSTATUS  WINAPI RtlAnsiStringToUnicodeString(PUNICODE_STRING,PCANSI_STRING,BOOLEAN);
NTSTATUS  WINAPI RtlAppendAsciizToString(STRING *,LPCSTR);
NTSTATUS  WINAPI RtlAppendStringToString(STRING *,const STRING *);
NTSTATUS  WINAPI RtlAppendUnicodeStringToString(UNICODE_STRING *,const UNICODE_STRING *);
NTSTATUS  WINAPI RtlAppendUnicodeToString(UNICODE_STRING *,LPCWSTR);
BOOLEAN   WINAPI RtlAreAllAccessesGranted(ACCESS_MASK,ACCESS_MASK);
BOOLEAN   WINAPI RtlAreAnyAccessesGranted(ACCESS_MASK,ACCESS_MASK);
BOOLEAN   WINAPI RtlAreBitsSet(PCRTL_BITMAP,ULONG,ULONG);
BOOLEAN   WINAPI RtlAreBitsClear(PCRTL_BITMAP,ULONG,ULONG);
NTSYSAPI
	DWORD   
	NTAPI
	RtlSetHeapInformation (
	IN PVOID HeapHandle,
	IN HEAP_INFORMATION_CLASS HeapInformationClass,
	IN PVOID HeapInformation OPTIONAL,
	IN SIZE_T HeapInformationLength OPTIONAL
	);
NTSTATUS  WINAPI RtlCharToInteger(PCSZ,ULONG,PULONG);
NTSTATUS  WINAPI RtlCheckRegistryKey(ULONG, PWSTR);
void      WINAPI RtlClearAllBits(PRTL_BITMAP);
void      WINAPI RtlClearBits(PRTL_BITMAP,ULONG,ULONG);
PDEBUG_BUFFER WINAPI RtlCreateQueryDebugBuffer(ULONG,BOOLEAN);
ULONG     WINAPI RtlCompactHeap(HANDLE,ULONG);
LONG      WINAPI RtlCompareString(const STRING*,const STRING*,BOOLEAN);
LONG      WINAPI RtlCompareUnicodeString(const UNICODE_STRING*,const UNICODE_STRING*,BOOLEAN);
DWORD     WINAPI RtlComputeCrc32(DWORD,PBYTE,INT);
NTSTATUS  WINAPI RtlConvertSidToUnicodeString(PUNICODE_STRING,PSID,BOOLEAN);
LONGLONG  WINAPI RtlConvertLongToLargeInteger(LONG);
ULONGLONG WINAPI RtlConvertUlongToLargeInteger(ULONG);
void      WINAPI RtlCopyLuid(PLUID,const LUID*);
void      WINAPI RtlCopyLuidAndAttributesArray(ULONG,const LUID_AND_ATTRIBUTES*,PLUID_AND_ATTRIBUTES);
BOOLEAN   WINAPI RtlCopySid(DWORD,PSID,PSID);
NTSTATUS  WINAPI RtlCopySecurityDescriptor(PSECURITY_DESCRIPTOR,PSECURITY_DESCRIPTOR);
void      WINAPI RtlCopyString(STRING*,const STRING*);
void      WINAPI RtlCopyUnicodeString(UNICODE_STRING*,const UNICODE_STRING*);
NTSTATUS  WINAPI RtlCreateAcl(PACL,DWORD,DWORD);
NTSTATUS  WINAPI RtlCreateAtomTable(ULONG,RTL_ATOM_TABLE*);
NTSTATUS  WINAPI RtlCreateEnvironment(BOOLEAN, PWSTR*);
HANDLE    WINAPI RtlCreateHeap(ULONG,PVOID,SIZE_T,SIZE_T,PVOID,PRTL_HEAP_DEFINITION);
NTSTATUS  WINAPI RtlCreateProcessParameters(RTL_USER_PROCESS_PARAMETERS**,const UNICODE_STRING*,
                                            const UNICODE_STRING*,const UNICODE_STRING*,
                                            const UNICODE_STRING*,PWSTR,const UNICODE_STRING*,
                                            const UNICODE_STRING*,const UNICODE_STRING*,
                                            const UNICODE_STRING*);
NTSTATUS  WINAPI RtlCreateSecurityDescriptor(PSECURITY_DESCRIPTOR,DWORD);
BOOLEAN   WINAPI RtlCreateUnicodeString(PUNICODE_STRING,LPCWSTR);
BOOLEAN   WINAPI RtlCreateUnicodeStringFromAsciiz(PUNICODE_STRING,LPCSTR);
NTSTATUS  WINAPI RtlCreateUserThread(HANDLE,const SECURITY_DESCRIPTOR*,BOOLEAN,PVOID,SIZE_T,SIZE_T,PRTL_THREAD_START_ROUTINE,void*,HANDLE*,CLIENT_ID*);

NTSTATUS  WINAPI RtlDeleteAce(PACL,DWORD);
NTSTATUS  WINAPI RtlDeleteAtomFromAtomTable(RTL_ATOM_TABLE,RTL_ATOM);
NTSTATUS  WINAPI RtlDeleteCriticalSection(RTL_CRITICAL_SECTION *);
NTSTATUS  WINAPI RtlDeleteRegistryValue(ULONG, PCWSTR, PCWSTR);
void      WINAPI RtlDeleteResource(LPRTL_RWLOCK);
DWORD     WINAPI RtlDeleteSecurityObject(DWORD);
PRTL_USER_PROCESS_PARAMETERS WINAPI RtlDeNormalizeProcessParams(RTL_USER_PROCESS_PARAMETERS*);
NTSTATUS  WINAPI RtlDestroyAtomTable(RTL_ATOM_TABLE);
NTSTATUS  WINAPI RtlDestroyEnvironment(PWSTR);
NTSTATUS  WINAPI RtlDestroyHandleTable(RTL_HANDLE_TABLE *);
HANDLE    WINAPI RtlDestroyHeap(HANDLE);
void      WINAPI RtlDestroyProcessParameters(RTL_USER_PROCESS_PARAMETERS*);
NTSTATUS  WINAPI RtlDestroyQueryDebugBuffer(PDEBUG_BUFFER);
DOS_PATHNAME_TYPE WINAPI RtlDetermineDosPathNameType_U(PCWSTR);
BOOLEAN   WINAPI RtlDoesFileExists_U(LPCWSTR);
BOOLEAN   WINAPI RtlDosPathNameToNtPathName_U(PCWSTR,PUNICODE_STRING,PWSTR*,CURDIR*);
ULONG     WINAPI RtlDosSearchPath_U(LPCWSTR, LPCWSTR, LPCWSTR, ULONG, LPWSTR, LPWSTR*);
WCHAR     WINAPI RtlDowncaseUnicodeChar(WCHAR);
NTSTATUS  WINAPI RtlDowncaseUnicodeString(UNICODE_STRING*,const UNICODE_STRING*,BOOLEAN);
void      WINAPI RtlDumpResource(LPRTL_RWLOCK);
NTSTATUS  WINAPI RtlDuplicateUnicodeString(int,const UNICODE_STRING*,UNICODE_STRING*);
//DWORD  WINAPI NtUserGetKeyState(DWORD key);
NTSTATUS  WINAPI RtlEmptyAtomTable(RTL_ATOM_TABLE,BOOLEAN);
LONGLONG  WINAPI RtlEnlargedIntegerMultiply(INT,INT);
ULONGLONG WINAPI RtlEnlargedUnsignedMultiply(UINT,UINT);
UINT      WINAPI RtlEnlargedUnsignedDivide(ULONGLONG,UINT,UINT *);
NTSTATUS  WINAPI RtlEnterCriticalSection(RTL_CRITICAL_SECTION *);
void      WINAPI RtlEraseUnicodeString(UNICODE_STRING*);
NTSTATUS  WINAPI RtlEqualComputerName(const UNICODE_STRING*,const UNICODE_STRING*);
NTSTATUS  WINAPI RtlEqualDomainName(const UNICODE_STRING*,const UNICODE_STRING*);
BOOLEAN   WINAPI RtlEqualLuid(const LUID*,const LUID*);
BOOL      WINAPI RtlEqualPrefixSid(PSID,PSID);
BOOL      WINAPI RtlEqualSid(PSID,PSID);
BOOLEAN   WINAPI RtlEqualString(const STRING*,const STRING*,BOOLEAN);
BOOLEAN   WINAPI RtlEqualUnicodeString(const UNICODE_STRING*,const UNICODE_STRING*,BOOLEAN);
DECLSPEC_NORETURN void      WINAPI RtlExitUserThread(ULONG) ;
NTSTATUS  WINAPI RtlExpandEnvironmentStrings_U(PWSTR, const UNICODE_STRING*, UNICODE_STRING*, ULONG*);
LONGLONG  WINAPI RtlExtendedMagicDivide(LONGLONG,LONGLONG,INT);
LONGLONG  WINAPI RtlExtendedIntegerMultiply(LONGLONG,INT);
LONGLONG  WINAPI RtlExtendedLargeIntegerDivide(LONGLONG,INT,INT *);
NTSYSAPI PVOID NTAPI RtlInitializeContext(IN HANDLE ProcessHandle,OUT PCONTEXT ThreadContext,
										  IN PVOID ThreadStartParam OPTIONAL,
										  IN PTHREAD_START_ROUTINE ThreadStartAddress,
										  IN PINITIAL_TEB InitialTeb );
NTSTATUS  WINAPI RtlFindCharInUnicodeString(int,const UNICODE_STRING*,const UNICODE_STRING*,USHORT*);
ULONG     WINAPI RtlFindClearBits(PCRTL_BITMAP,ULONG,ULONG);
ULONG     WINAPI RtlFindClearBitsAndSet(PRTL_BITMAP,ULONG,ULONG);
ULONG     WINAPI RtlFindClearRuns(PCRTL_BITMAP,PRTL_BITMAP_RUN,ULONG,BOOLEAN);
ULONG     WINAPI RtlFindLastBackwardRunSet(PCRTL_BITMAP,ULONG,PULONG);
ULONG     WINAPI RtlFindLastBackwardRunClear(PCRTL_BITMAP,ULONG,PULONG);
CCHAR     WINAPI RtlFindLeastSignificantBit(ULONGLONG);
ULONG     WINAPI RtlFindLongestRunSet(PCRTL_BITMAP,PULONG);
ULONG     WINAPI RtlFindLongestRunClear(PCRTL_BITMAP,PULONG);
NTSTATUS  WINAPI RtlFindMessage(HMODULE,ULONG,ULONG,ULONG,const MESSAGE_RESOURCE_ENTRY**);
CCHAR     WINAPI RtlFindMostSignificantBit(ULONGLONG);
ULONG     WINAPI RtlFindNextForwardRunSet(PCRTL_BITMAP,ULONG,PULONG);
ULONG     WINAPI RtlFindNextForwardRunClear(PCRTL_BITMAP,ULONG,PULONG);
ULONG     WINAPI RtlFindSetBits(PCRTL_BITMAP,ULONG,ULONG);
ULONG     WINAPI RtlFindSetBitsAndClear(PRTL_BITMAP,ULONG,ULONG);
ULONG     WINAPI RtlFindSetRuns(PCRTL_BITMAP,PRTL_BITMAP_RUN,ULONG,BOOLEAN);
BOOLEAN   WINAPI RtlFirstFreeAce(PACL,PACE_HEADER *);
NTSTATUS  WINAPI RtlFormatCurrentUserKeyPath(PUNICODE_STRING);
NTSTATUS  WINAPI RtlFormatMessage(LPWSTR Message,UCHAR MaxWidth,BOOLEAN IgnoreInserts,BOOLEAN Ansi,BOOLEAN ArgumentIsArray,va_list* Arguments,LPWSTR Buffer,ULONG BufferSize);
void      WINAPI RtlFreeAnsiString(PANSI_STRING);
BOOLEAN   WINAPI RtlFreeHandle(RTL_HANDLE_TABLE *,RTL_HANDLE *);
BOOLEAN   WINAPI RtlFreeHeap(HANDLE,ULONG,PVOID);
void      WINAPI RtlFreeOemString(POEM_STRING);
DWORD     WINAPI RtlFreeSid(PSID);
void      WINAPI RtlFreeUnicodeString(PUNICODE_STRING);

NTSTATUS  WINAPI RtlGetAce(PACL,DWORD,LPVOID *);
NTSTATUS  WINAPI RtlGetControlSecurityDescriptor(PSECURITY_DESCRIPTOR, PSECURITY_DESCRIPTOR_CONTROL,LPDWORD);
NTSTATUS  WINAPI RtlGetCurrentDirectory_U(ULONG, LPWSTR);
PEB *     WINAPI RtlGetCurrentPeb(void);
NTSTATUS  WINAPI RtlGetDaclSecurityDescriptor(PSECURITY_DESCRIPTOR,PBOOLEAN,PACL *,PBOOLEAN);
ULONG     WINAPI RtlGetFullPathName_U(PCWSTR,ULONG,PWSTR,PWSTR*);
NTSTATUS  WINAPI RtlGetGroupSecurityDescriptor(PSECURITY_DESCRIPTOR,PSID *,PBOOLEAN);
NTSTATUS  WINAPI RtlGetLastNtStatus(void);
DWORD     WINAPI RtlGetLastWin32Error(void);
DWORD     WINAPI RtlGetLongestNtPathLength(void);
BOOLEAN   WINAPI RtlGetNtProductType(LPDWORD);
NTSTATUS  WINAPI RtlGetOwnerSecurityDescriptor(PSECURITY_DESCRIPTOR,PSID *,PBOOLEAN);
ULONG     WINAPI RtlGetProcessHeaps(ULONG,HANDLE*);
NTSTATUS  WINAPI RtlGetSaclSecurityDescriptor(PSECURITY_DESCRIPTOR,PBOOLEAN,PACL *,PBOOLEAN);
NTSTATUS  WINAPI RtlGetVersion(RTL_OSVERSIONINFOEXW*);
NTSTATUS  WINAPI RtlGUIDFromString(PUNICODE_STRING,GUID*);

PSID_IDENTIFIER_AUTHORITY WINAPI RtlIdentifierAuthoritySid(PSID);
PVOID     WINAPI RtlImageDirectoryEntryToData(HMODULE,BOOL,WORD,ULONG *);
PIMAGE_NT_HEADERS WINAPI RtlImageNtHeader(HMODULE);
PIMAGE_SECTION_HEADER WINAPI RtlImageRvaToSection(const IMAGE_NT_HEADERS *,HMODULE,DWORD);
PVOID     WINAPI RtlImageRvaToVa(const IMAGE_NT_HEADERS *,HMODULE,DWORD,IMAGE_SECTION_HEADER **);
NTSTATUS  WINAPI RtlImpersonateSelf(SECURITY_IMPERSONATION_LEVEL);
void      WINAPI RtlInitString(PSTRING,PCSZ);
void      WINAPI RtlInitAnsiString(PANSI_STRING,PCSZ);
void      WINAPI RtlInitUnicodeString(PUNICODE_STRING,PCWSTR);
NTSTATUS  WINAPI RtlInitUnicodeStringEx(PUNICODE_STRING,PCWSTR);
NTSTATUS  WINAPI RtlInitializeCriticalSection(RTL_CRITICAL_SECTION *);
NTSTATUS  WINAPI RtlInitializeCriticalSectionAndSpinCount(RTL_CRITICAL_SECTION *,DWORD);
void      WINAPI RtlInitializeBitMap(PRTL_BITMAP,PULONG,ULONG);
void      WINAPI RtlInitializeHandleTable(ULONG,ULONG,RTL_HANDLE_TABLE *);
void      WINAPI RtlInitializeResource(LPRTL_RWLOCK);
BOOL      WINAPI RtlInitializeSid(PSID,PSID_IDENTIFIER_AUTHORITY,BYTE);

NTSTATUS  WINAPI RtlInt64ToUnicodeString(ULONGLONG,ULONG,UNICODE_STRING *);
NTSTATUS  WINAPI RtlIntegerToChar(ULONG,ULONG,ULONG,PCHAR);
NTSTATUS  WINAPI RtlIntegerToUnicodeString(ULONG,ULONG,UNICODE_STRING *);
ULONG     WINAPI RtlIsDosDeviceName_U(PCWSTR);
BOOLEAN   WINAPI RtlIsNameLegalDOS8Dot3(const UNICODE_STRING*,POEM_STRING,PBOOLEAN);
BOOLEAN   WINAPI RtlIsTextUnicode(LPCVOID,INT,INT *);
BOOLEAN   WINAPI RtlIsValidHandle(const RTL_HANDLE_TABLE *, const RTL_HANDLE *);
BOOLEAN   WINAPI RtlIsValidIndexHandle(const RTL_HANDLE_TABLE *, ULONG Index, RTL_HANDLE **);
//BOOLEAN   WINAPI CsrClientConnectToServer(PWSTR);
//NTSTATUS NTAPI CsrCreateProcess(IN HANDLE hProcess,IN HANDLE hThread,IN PCLIENT_ID ClientId,IN PCSR_NT_SESSION NtSession,IN ULONG Flags,IN PCLIENT_ID	DebugCid);
LONGLONG  WINAPI RtlLargeIntegerAdd(LONGLONG,LONGLONG);
LONGLONG  WINAPI RtlLargeIntegerArithmeticShift(LONGLONG,INT);
ULONGLONG WINAPI RtlLargeIntegerDivide( ULONGLONG,ULONGLONG,ULONGLONG *);
LONGLONG  WINAPI RtlLargeIntegerNegate(LONGLONG);
LONGLONG  WINAPI RtlLargeIntegerShiftLeft(LONGLONG,INT);
LONGLONG  WINAPI RtlLargeIntegerShiftRight(LONGLONG,INT);
LONGLONG  WINAPI RtlLargeIntegerSubtract(LONGLONG,LONGLONG);
NTSTATUS  WINAPI RtlLargeIntegerToChar(const ULONGLONG *,ULONG,ULONG,PCHAR);
NTSTATUS  WINAPI RtlLeaveCriticalSection(RTL_CRITICAL_SECTION *);
DWORD     WINAPI RtlLengthRequiredSid(DWORD);
ULONG     WINAPI RtlLengthSecurityDescriptor(PSECURITY_DESCRIPTOR);
DWORD     WINAPI RtlLengthSid(PSID);
NTSTATUS  WINAPI RtlLocalTimeToSystemTime(const LARGE_INTEGER*,PLARGE_INTEGER);
BOOLEAN   WINAPI RtlLockHeap(HANDLE);
NTSTATUS  WINAPI RtlLookupAtomInAtomTable(RTL_ATOM_TABLE,const WCHAR*,RTL_ATOM*);

NTSTATUS  WINAPI RtlMakeSelfRelativeSD(PSECURITY_DESCRIPTOR,PSECURITY_DESCRIPTOR,LPDWORD);
void      WINAPI RtlMapGenericMask(PACCESS_MASK,const GENERIC_MAPPING*);
NTSTATUS  WINAPI RtlMultiByteToUnicodeN(LPWSTR,DWORD,LPDWORD,LPCSTR,DWORD);
NTSTATUS  WINAPI RtlMultiByteToUnicodeSize(DWORD*,LPCSTR,UINT);

DWORD     WINAPI RtlNewSecurityObject(DWORD,DWORD,DWORD,DWORD,DWORD,DWORD);
PRTL_USER_PROCESS_PARAMETERS WINAPI RtlNormalizeProcessParams(RTL_USER_PROCESS_PARAMETERS*);
ULONG     WINAPI RtlNtStatusToDosError(NTSTATUS);
ULONG     WINAPI RtlNtStatusToDosErrorNoTeb(NTSTATUS);
ULONG     WINAPI RtlNumberOfSetBits(PCRTL_BITMAP);
ULONG     WINAPI RtlNumberOfClearBits(PCRTL_BITMAP);

UINT      WINAPI RtlOemStringToUnicodeSize(const STRING*);
NTSTATUS  WINAPI RtlOemStringToUnicodeString(UNICODE_STRING*,const STRING*,BOOLEAN);
NTSTATUS  WINAPI RtlOemToUnicodeN(LPWSTR,DWORD,LPDWORD,LPCSTR,DWORD);
DWORD     WINAPI RtlOpenCurrentUser(ACCESS_MASK,PHANDLE);

NTSTATUS  WINAPI RtlPinAtomInAtomTable(PRTL_ATOM_TABLE,RTL_ATOM);
BOOLEAN   WINAPI RtlPrefixString(const STRING*,const STRING*,BOOLEAN);
BOOLEAN   WINAPI RtlPrefixUnicodeString(const UNICODE_STRING*,const UNICODE_STRING*,BOOLEAN);

NTSTATUS  WINAPI RtlQueryAtomInAtomTable(RTL_ATOM_TABLE,RTL_ATOM,ULONG*,ULONG*,WCHAR*,ULONG*);
NTSTATUS  WINAPI RtlQueryEnvironmentVariable_U(PWSTR,PUNICODE_STRING,PUNICODE_STRING);
NTSTATUS  WINAPI RtlQueryInformationAcl(PACL,LPVOID,DWORD,ACL_INFORMATION_CLASS);
NTSTATUS  WINAPI RtlQueryProcessDebugInformation(IN HANDLE  HProcessId,IN ULONG  DebugInfoClassMask,IN OUT PDEBUG_BUFFER  DebugBuffer);
NTSTATUS  WINAPI RtlQueryRegistryValues(ULONG, PCWSTR, PRTL_QUERY_REGISTRY_TABLE, PVOID, PVOID);
NTSTATUS  WINAPI RtlQueryTimeZoneInformation(RTL_TIME_ZONE_INFORMATION*);
void      WINAPI RtlRaiseException(PEXCEPTION_RECORD);
void      WINAPI RtlRaiseStatus(NTSTATUS);
ULONG     WINAPI RtlRandom(PULONG);
PVOID     WINAPI RtlReAllocateHeap(HANDLE,ULONG,PVOID,SIZE_T);
void      WINAPI RtlReleasePebLock(void);
void      WINAPI RtlReleaseResource(LPRTL_RWLOCK);
ULONG     WINAPI RtlRemoveVectoredExceptionHandler(PVOID);
void      WINAPI RtlRestoreLastWin32Error(DWORD);

void      WINAPI RtlSecondsSince1970ToTime(DWORD,LARGE_INTEGER *);
void      WINAPI RtlSecondsSince1980ToTime(DWORD,LARGE_INTEGER *);
NTSTATUS  WINAPI RtlSelfRelativeToAbsoluteSD(PSECURITY_DESCRIPTOR,PSECURITY_DESCRIPTOR,
                                             PDWORD,PACL,PDWORD,PACL,PDWORD,PSID,PDWORD,PSID,PDWORD);
void      WINAPI RtlSetAllBits(PRTL_BITMAP);
void      WINAPI RtlSetBits(PRTL_BITMAP,ULONG,ULONG);
ULONG     WINAPI RtlSetCriticalSectionSpinCount(RTL_CRITICAL_SECTION*,ULONG);
NTSTATUS  WINAPI RtlSetCurrentDirectory_U(const UNICODE_STRING*);
void      WINAPI RtlSetCurrentEnvironment(PWSTR, PWSTR*);
NTSTATUS  WINAPI RtlSetDaclSecurityDescriptor(PSECURITY_DESCRIPTOR,BOOLEAN,PACL,BOOLEAN);
NTSTATUS  WINAPI RtlSetEnvironmentVariable(PWSTR*,PUNICODE_STRING,PUNICODE_STRING);
NTSTATUS  WINAPI RtlSetOwnerSecurityDescriptor(PSECURITY_DESCRIPTOR,PSID,BOOLEAN);
NTSTATUS  WINAPI RtlSetGroupSecurityDescriptor(PSECURITY_DESCRIPTOR,PSID,BOOLEAN);
void      WINAPI RtlSetLastWin32Error(DWORD);
void      WINAPI RtlSetLastWin32ErrorAndNtStatusFromNtStatus(NTSTATUS);
NTSTATUS  WINAPI RtlSetSaclSecurityDescriptor(PSECURITY_DESCRIPTOR,BOOLEAN,PACL,BOOLEAN);
NTSTATUS  WINAPI RtlSetTimeZoneInformation(const RTL_TIME_ZONE_INFORMATION*);
SIZE_T    WINAPI RtlSizeHeap(HANDLE,ULONG,PVOID);
NTSTATUS  WINAPI RtlStringFromGUID(REFGUID,PUNICODE_STRING);
LPDWORD   WINAPI RtlSubAuthoritySid(PSID,DWORD);
LPBYTE    WINAPI RtlSubAuthorityCountSid(PSID);
NTSTATUS  WINAPI RtlSystemTimeToLocalTime(const LARGE_INTEGER*,PLARGE_INTEGER);
//NTSTATUS WINAPI RtlCreateStack(HANDLE hProcess,ULONG StackReserve,ULONG StackCommit,PINITIAL_TEB InitialTeb);

void      WINAPI RtlTimeToTimeFields(const LARGE_INTEGER*,PTIME_FIELDS);
BOOLEAN   WINAPI RtlTimeFieldsToTime(PTIME_FIELDS,PLARGE_INTEGER);
void      WINAPI RtlTimeToElapsedTimeFields(const LARGE_INTEGER *,PTIME_FIELDS);
BOOLEAN   WINAPI RtlTimeToSecondsSince1970(const LARGE_INTEGER *,LPDWORD);
BOOLEAN   WINAPI RtlTimeToSecondsSince1980(const LARGE_INTEGER *,LPDWORD);
BOOL      WINAPI RtlTryEnterCriticalSection(RTL_CRITICAL_SECTION *);

ULONGLONG __cdecl RtlUlonglongByteSwap(ULONGLONG);
DWORD     WINAPI RtlUnicodeStringToAnsiSize(const UNICODE_STRING*);
NTSTATUS  WINAPI RtlUnicodeStringToAnsiString(PANSI_STRING,PCUNICODE_STRING,BOOLEAN);
NTSTATUS  WINAPI RtlUnicodeStringToInteger(const UNICODE_STRING *,ULONG,ULONG *);
DWORD     WINAPI RtlUnicodeStringToOemSize(const UNICODE_STRING*);
NTSTATUS  WINAPI RtlUnicodeStringToOemString(POEM_STRING,PCUNICODE_STRING,BOOLEAN);
NTSTATUS  WINAPI RtlUnicodeToMultiByteN(LPSTR,DWORD,LPDWORD,LPCWSTR,DWORD);
NTSTATUS  WINAPI RtlUnicodeToMultiByteSize(PULONG,PCWSTR,ULONG);
NTSTATUS  WINAPI RtlUnicodeToOemN(LPSTR,DWORD,LPDWORD,LPCWSTR,DWORD);
ULONG     WINAPI RtlUniform(PULONG);
BOOLEAN   WINAPI RtlUnlockHeap(HANDLE);
void      WINAPI RtlUnwind(PVOID,PVOID,PEXCEPTION_RECORD,PVOID);
#ifdef __ia64__
void      WINAPI RtlUnwind2(FRAME_POINTERS,PVOID,PEXCEPTION_RECORD,PVOID,PCONTEXT);
void      WINAPI RtlUnwindEx(FRAME_POINTERS,PVOID,PEXCEPTION_RECORD,PVOID,PCONTEXT,PUNWIND_HISTORY_TABLE);
#endif
WCHAR     WINAPI RtlUpcaseUnicodeChar(WCHAR);
NTSTATUS  WINAPI RtlUpcaseUnicodeString(UNICODE_STRING*,const UNICODE_STRING *,BOOLEAN);
NTSTATUS  WINAPI RtlUpcaseUnicodeStringToAnsiString(STRING*,const UNICODE_STRING*,BOOLEAN);
NTSTATUS  WINAPI RtlUpcaseUnicodeStringToCountedOemString(STRING*,const UNICODE_STRING*,BOOLEAN);
NTSTATUS  WINAPI RtlUpcaseUnicodeStringToOemString(STRING*,const UNICODE_STRING*,BOOLEAN);
NTSTATUS  WINAPI RtlUpcaseUnicodeToMultiByteN(LPSTR,DWORD,LPDWORD,LPCWSTR,DWORD);
NTSTATUS  WINAPI RtlUpcaseUnicodeToOemN(LPSTR,DWORD,LPDWORD,LPCWSTR,DWORD);
CHAR      WINAPI RtlUpperChar(CHAR);
void      WINAPI RtlUpperString(STRING *,const STRING *);

NTSTATUS  WINAPI RtlValidSecurityDescriptor(PSECURITY_DESCRIPTOR);
BOOLEAN   WINAPI RtlValidAcl(PACL);
BOOLEAN   WINAPI RtlValidSid(PSID);
BOOLEAN   WINAPI RtlValidateHeap(HANDLE,ULONG,LPCVOID);
//NTSTATUS  WINAPI RtlVerifyVersionInfo(const RTL_OSVERSIONINFOEXW*,DWORD,DWORDLONG);
typedef struct _RTL_USER_PROCESS_INFORMATION
{
    ULONG Size;
    HANDLE ProcessHandle;
    HANDLE ThreadHandle;
    CLIENT_ID ClientId;
    SECTION_IMAGE_INFORMATION ImageInformation;
} RTL_USER_PROCESS_INFORMATION, *PRTL_USER_PROCESS_INFORMATION;
NTSTATUS  WINAPI RtlCreateUserProcess(IN PUNICODE_STRING ImagePath,IN ULONG ObjectAttributes,IN OUT PRTL_USER_PROCESS_PARAMETERS ProcessParameters,IN PSECURITY_DESCRIPTOR ProcessSecurityDescriptor OPTIONAL,IN PSECURITY_DESCRIPTOR ThreadSecurityDescriptor OPTIONAL,IN HANDLE ParentProcess,IN BOOLEAN InheritHandles,IN HANDLE DebugPort OPTIONAL,IN HANDLE ExceptionPort OPTIONAL,OUT PRTL_USER_PROCESS_INFORMATION ProcessInformation );
NTSTATUS  WINAPI RtlWalkHeap(HANDLE,PVOID);

NTSTATUS  WINAPI RtlpNtCreateKey(PHANDLE,ACCESS_MASK,const OBJECT_ATTRIBUTES*,ULONG,const UNICODE_STRING*,ULONG,PULONG);
NTSTATUS  WINAPI RtlpWaitForCriticalSection(RTL_CRITICAL_SECTION *);
NTSTATUS  WINAPI RtlpUnWaitCriticalSection(RTL_CRITICAL_SECTION *);

ULONG WINAPI
vDbgPrintEx(IN ULONG ComponentId,
            IN ULONG Level,
            IN LPCSTR Format,
            IN va_list ap);
ULONG WINAPI
vDbgPrintExWithPrefix(IN LPCSTR Prefix,
                      IN ULONG ComponentId,
                      IN ULONG Level,
                      IN LPCSTR Format,
                      IN va_list ap);
int  WINAPI CsrClientCallServer(PVOID length, DWORD opcode, DWORD zero,DWORD message);
/* PURPOSE:         Definitions for CSR Servers
 */
#ifndef _CSRSERVER_H
#define _CSRSERVER_H

/* DEPENDENCIES **************************************************************/


/* TYPES **********************************************************************/
typedef struct _CSR_NT_SESSION
{
    ULONG ReferenceCount;
    LIST_ENTRY SessionList;
    ULONG SessionId;
} CSR_NT_SESSION, *PCSR_NT_SESSION;

typedef struct _CSR_PROCESS
{
    CLIENT_ID ClientId;
    LIST_ENTRY ListLink;
    LIST_ENTRY ThreadList;
    struct _CSR_PROCESS *Parent;
    PCSR_NT_SESSION NtSession;
    ULONG ExpectedVersion;
    HANDLE ClientPort;
    ULONG_PTR ClientViewBase;
    ULONG_PTR ClientViewBounds;
    HANDLE ProcessHandle;
    ULONG SequenceNumber;
    ULONG Flags;
    ULONG DebugFlags;
    CLIENT_ID DebugCid;
    ULONG ReferenceCount;
    ULONG ProcessGroupId;
    ULONG ProcessGroupSequence;
    ULONG fVDM;
    ULONG ThreadCount;
    ULONG PriorityClass;
    ULONG Reserved;
    ULONG ShutdownLevel;
    ULONG ShutdownFlags;
    PVOID ServerData[1];
} CSR_PROCESS, *PCSR_PROCESS; 

typedef struct _CSR_THREAD
{
    LARGE_INTEGER CreateTime;
    LIST_ENTRY Link;
    LIST_ENTRY HashLinks;
    CLIENT_ID ClientId;
    PCSR_PROCESS Process;
    struct _CSR_WAIT_BLOCK *WaitBlock;
    HANDLE ThreadHandle;
    ULONG Flags;
    ULONG ReferenceCount;
    ULONG ImpersonationCount;
} CSR_THREAD, *PCSR_THREAD; 

/* ENUMERATIONS **************************************************************/
#define CSR_SRV_SERVER 0

typedef enum _CSR_PROCESS_FLAGS
{
    CsrProcessTerminating = 0x1,
    CsrProcessSkipShutdown = 0x2,
    CsrProcessCreateNewGroup = 0x100,
    CsrProcessTerminated = 0x200,
    CsrProcessLastThreadTerminated = 0x400,
    CsrProcessIsConsoleApp = 0x800
} CSR_PROCESS_FLAGS, *PCSR_PROCESS_FLAGS;

typedef enum _CSR_THREAD_FLAGS
{
    CsrThreadAltertable = 0x1,
    CsrThreadInTermination = 0x2,
    CsrThreadTerminated = 0x4,
    CsrThreadIsServerThread = 0x10
} CSR_THREAD_FLAGS, *PCSR_THREAD_FLAGS;

typedef enum _SHUTDOWN_RESULT
{
    CsrShutdownCsrProcess = 1,
    CsrShutdownNonCsrProcess,
    CsrShutdownCancelled
} SHUTDOWN_RESULT, *PSHUTDOWN_RESULT;

typedef enum _CSR_SHUTDOWN_FLAGS
{
    CsrShutdownSystem = 4,
    CsrShutdownOther = 8
} CSR_SHUTDOWN_FLAGS, *PCSR_SHUTDOWN_FLAGS;

typedef enum _CSR_DEBUG_FLAGS
{
    CsrDebugOnlyThisProcess = 1,
    CsrDebugProcessChildren = 2
} CSR_PROCESS_DEBUG_FLAGS, *PCSR_PROCESS_DEBUG_FLAGS;

/* FUNCTION TYPES ************************************************************/
typedef
NTSTATUS
(*PCSR_CONNECT_CALLBACK)(
    IN PCSR_PROCESS CsrProcess,
    IN OUT PVOID ConnectionInfo,
    IN OUT PULONG ConnectionInfoLength
);

typedef
VOID
(*PCSR_DISCONNECT_CALLBACK)(IN PCSR_PROCESS CsrProcess);

typedef
NTSTATUS
(*PCSR_NEWPROCESS_CALLBACK)(
    IN PCSR_PROCESS Parent,
    IN PCSR_PROCESS CsrProcess
);

//
// Maximum Parameters for NtRaiseHardError
//
#define MAXIMUM_HARDERROR_PARAMETERS    4
//
// Hard Error LPC Message
//
typedef struct _HARDERROR_MSG
{
    PORT_MESSAGE h;
    NTSTATUS Status;
    LARGE_INTEGER ErrorTime;
    ULONG ValidResponseOptions;
    ULONG Response;
    ULONG NumberOfParameters;
    ULONG UnicodeStringParameterMask;
    ULONG Parameters[MAXIMUM_HARDERROR_PARAMETERS];
} HARDERROR_MSG, *PHARDERROR_MSG;

typedef
VOID
(*PCSR_HARDERROR_CALLBACK)(
    IN PCSR_THREAD CsrThread,
    IN PHARDERROR_MSG HardErrorMessage
);

typedef
ULONG
(*PCSR_SHUTDOWNPROCESS_CALLBACK)(
    IN PCSR_PROCESS CsrProcess,
    IN ULONG Flags,
    IN BOOLEAN FirstPhase
);


/* FIXME: Put into public NDK Header */
typedef ULONG CSR_API_NUMBER;

#define CSR_MAKE_OPCODE(s,m) ((s) << 16) | (m)
#define CSR_API_ID_FROM_OPCODE(n) ((ULONG)((USHORT)(n)))
#define CSR_SERVER_ID_FROM_OPCODE(n) (ULONG)((n) >> 16)

typedef struct _CSR_CONNECTION_INFO
{
    ULONG Unknown[2];
    HANDLE ObjectDirectory;
    PVOID SharedSectionBase;
    PVOID SharedSectionHeap;
    PVOID SharedSectionData;
    ULONG DebugFlags;
    ULONG Unknown2[3];
    HANDLE ProcessId;
} CSR_CONNECTION_INFO, *PCSR_CONNECTION_INFO;

typedef struct _CSR_CLIENT_CONNECT
{
    ULONG ServerId;
    PVOID ConnectionInfo;
    ULONG ConnectionInfoSize;
} CSR_CLIENT_CONNECT, *PCSR_CLIENT_CONNECT;

typedef struct _CSR_API_MESSAGE
{
    PORT_MESSAGE Header;
    union
    {
        CSR_CONNECTION_INFO ConnectionInfo;
        struct
        {
            PVOID CsrCaptureData;
            CSR_API_NUMBER Opcode;
            ULONG Status; 
            ULONG Reserved;
            union
            {
                CSR_CLIENT_CONNECT CsrClientConnect;
            };
        };
    };
} CSR_API_MESSAGE, *PCSR_API_MESSAGE;

typedef struct _CSR_CAPTURE_BUFFER
{
    ULONG Size;
    struct _CSR_CAPTURE_BUFFER *PreviousCaptureBuffer;
    ULONG PointerCount;
    ULONG_PTR BufferEnd;
} CSR_CAPTURE_BUFFER, *PCSR_CAPTURE_BUFFER;

/* Private data resumes here */
typedef
NTSTATUS
(NTAPI *PCSR_API_ROUTINE)(
    IN OUT PCSR_API_MESSAGE ApiMessage,
    IN OUT PULONG Reply
);

typedef struct _CSR_SERVER_DLL
{
    ULONG Length;
    HANDLE Event;
    ANSI_STRING Name;
    HANDLE ServerHandle;
    ULONG ServerId;
    ULONG Unknown;
    ULONG ApiBase;
    ULONG HighestApiSupported;
    PCSR_API_ROUTINE *DispatchTable;
    PBOOLEAN ValidTable;
    PCHAR *NameTable;
    ULONG SizeOfProcessData;
    PCSR_CONNECT_CALLBACK ConnectCallback;
    PCSR_DISCONNECT_CALLBACK DisconnectCallback;
    PCSR_HARDERROR_CALLBACK HardErrorCallback;
    PVOID SharedSection;
    PCSR_NEWPROCESS_CALLBACK NewProcessCallback;
    PCSR_SHUTDOWNPROCESS_CALLBACK ShutdownProcessCallback;
    ULONG Unknown2[3];
} CSR_SERVER_DLL, *PCSR_SERVER_DLL;

typedef
NTSTATUS
(NTAPI *PCSR_SERVER_DLL_INIT_CALLBACK)(IN PCSR_SERVER_DLL ServerDll);

typedef
BOOLEAN
(*CSR_WAIT_FUNCTION)(
    IN PLIST_ENTRY WaitList,
    IN PCSR_THREAD WaitThread,
    IN PCSR_API_MESSAGE WaitApiMessage,
    IN PVOID WaitContext,
    IN PVOID WaitArgument1,
    IN PVOID WaitArgument2,
    IN ULONG WaitFlags
);

typedef struct _CSR_WAIT_BLOCK
{
    ULONG Size;
    LIST_ENTRY WaitList;
    LIST_ENTRY UserWaitList;
    PVOID WaitContext;
    PCSR_THREAD WaitThread;
    CSR_WAIT_FUNCTION WaitFunction;
    CSR_API_MESSAGE WaitApiMessage;
} CSR_WAIT_BLOCK, *PCSR_WAIT_BLOCK;



/* FIXME: Put into new SM headers */
typedef struct _SB_CREATE_SESSION
{
    ULONG SessionId;
    RTL_USER_PROCESS_INFORMATION ProcessInfo;
} SB_CREATE_SESSION, *PSB_CREATE_SESSION;

typedef struct _SB_TERMINATE_SESSION
{
    ULONG SessionId;
} SB_TERMINATE_SESSION, *PSB_TERMINATE_SESSION;

typedef struct _SB_FOREIGN_SESSION_COMPLETE
{
    ULONG SessionId;
} SB_FOREIGN_SESSION_COMPLETE, *PSB_FOREIGN_SESSION_COMPLETE;

typedef struct _SB_CREATE_PROCESS
{
    ULONG SessionId;
} SB_CREATE_PROCESS, *PSB_CREATE_PROCESS;

typedef struct _SB_CONNECTION_INFO
{
    ULONG SubsystemId;
} SB_CONNECTION_INFO, *PSB_CONNECTION_INFO;

typedef struct _SB_API_MESSAGE
{
    PORT_MESSAGE Header;
    union
    {
        SB_CONNECTION_INFO ConnectionInfo;
        struct
        {
            ULONG Opcode;
            NTSTATUS Status;
            union
            {
                SB_CREATE_SESSION SbCreateSession;
                SB_TERMINATE_SESSION SbTerminateSession;
                SB_FOREIGN_SESSION_COMPLETE SbForeignSessionComplete;
                SB_CREATE_PROCESS SbCreateProcess;
            };
        };
    };
} SB_API_MESSAGE, *PSB_API_MESSAGE;

typedef
BOOLEAN
(NTAPI *PSB_API_ROUTINE)(IN PSB_API_MESSAGE ApiMessage);

NTSTATUS
NTAPI
SmSessionComplete(
    IN HANDLE hApiPort,
    IN ULONG SessionId,
    IN NTSTATUS Status
);

NTSTATUS
NTAPI
SmConnectToSm(
    IN PUNICODE_STRING SbApiPortName OPTIONAL,
    IN HANDLE hSbApiPort OPTIONAL,
    IN ULONG SubsystemType OPTIONAL,
    OUT PHANDLE hSmApiPort
);

/* PROTOTYPES ****************************************************************/

NTSTATUS
NTAPI
CsrServerInitialization(
    ULONG ArgumentCount,
    PCHAR Arguments[]
);
DWORD NTAPI CsrGetProcessId(void);

#endif

/* Wine internal functions */

extern NTSTATUS wine_nt_to_unix_file_name( const UNICODE_STRING *nameW, ANSI_STRING *unix_name_ret,
                                           UINT disposition, BOOLEAN check_case );

/***********************************************************************
 * Inline functions
 */

#define InitializeObjectAttributes(p,n,a,r,s) \
    do { \
        (p)->Length = sizeof(OBJECT_ATTRIBUTES); \
        (p)->RootDirectory = r; \
        (p)->Attributes = a; \
        (p)->ObjectName = n; \
        (p)->SecurityDescriptor = s; \
        (p)->SecurityQualityOfService = NULL; \
    } while (0)

#define NtCurrentProcess() ((HANDLE)-1)

#ifndef RtlFillMemory
#define RtlFillMemory(Destination,Length,Fill) memset((Destination),(Fill),(Length))
#endif
#ifndef RtlMoveMemory
#define RtlMoveMemory(Destination,Source,Length) memmove((Destination),(Source),(Length))
#endif
#define RtlStoreUlong(p,v)  do { ULONG _v = (v); memcpy((p), &_v, sizeof(_v)); } while (0)
#define RtlStoreUlonglong(p,v) do { ULONGLONG _v = (v); memcpy((p), &_v, sizeof(_v)); } while (0)
#define RtlRetrieveUlong(p,s) memcpy((p), (s), sizeof(ULONG))
#define RtlRetrieveUlonglong(p,s) memcpy((p), (s), sizeof(ULONGLONG))
#ifndef RtlZeroMemory
#define RtlZeroMemory(Destination,Length) memset((Destination),0,(Length))
#endif

inline static BOOLEAN RtlCheckBit(PCRTL_BITMAP lpBits, ULONG ulBit)
{
    if (lpBits && ulBit < lpBits->SizeOfBitMap &&
        lpBits->Buffer[ulBit >> 5] & (1 << (ulBit & 31)))
        return TRUE;
    return FALSE;
}

/* These are implemented as __fastcall, so we can't let Winelib apps link with them */
inline static USHORT RtlUshortByteSwap(USHORT s)
{
    return (s >> 8) | (s << 8);
}
inline static ULONG RtlUlongByteSwap(ULONG i)
{
#if defined(__i386__) && defined(__GNUC__)
    ULONG ret;
    __asm__("bswap %0" : "=r" (ret) : "0" (i) );
    return ret;
#else
    return ((ULONG)RtlUshortByteSwap((USHORT)i) << 16) | RtlUshortByteSwap((USHORT)(i >> 16));
#endif
}

/*************************************************************************
 * Loader functions and structures.
 *
 * Those are not part of standard Winternl.h
 */
typedef struct _LDR_MODULE
{
    LIST_ENTRY          InLoadOrderModuleList; // 
    LIST_ENTRY          InMemoryOrderModuleList; //  
    LIST_ENTRY          InInitializationOrderModuleList; // 
    void*               BaseAddress;
    void*               EntryPoint;
    ULONG               SizeOfImage;
    UNICODE_STRING      FullDllName;
    UNICODE_STRING      BaseDllName;
    ULONG               Flags;
    SHORT               LoadCount;
    SHORT               TlsIndex;
    LIST_ENTRY			HashTableEntry; // HANDLE HandleSection;
    ULONG               CheckSum;
    ULONG               TimeDateStamp;
} LDR_MODULE, *PLDR_MODULE;

typedef struct _LDR_DATA_TABLE_ENTRY 
{ 
	LIST_ENTRY InLoadOrderModuleList; /* 00h */ 
	LIST_ENTRY InMemoryOrderModuleList; /* 08h */ 
	LIST_ENTRY InInitializationOrderModuleList; /* 10h */ 
	PVOID BaseAddress; /* 18h */ 
	PVOID EntryPoint; /* 1Ch */ 
	ULONG SizeOfImage; /* 20h */ 
	UNICODE_STRING FullDllName; /* 24h */ 
	UNICODE_STRING BaseDllName; /* 2Ch */ 
	ULONG Flags; /* 34h */ 
	USHORT LoadCount; /* 38h */ 
	USHORT TlsIndex; /* 3Ah */ 
	union 
	{ 
		LIST_ENTRY HashTableEntry; /* 3Ch */ 
		PVOID SectionPointer; /* 3Ch */ 
	}; 
	ULONG CheckSum; /* 44h */ 
	union 
	{ 
		ULONG TimeDateStamp; /* 48h */ 
		PVOID LoadedImports; /* 48h */ 
	}; 
	PVOID EntryPointActivationContext; /* 4Ch */ 
	PVOID PatchInformation; /* 50h */ 
} LDR_DATA_TABLE_ENTRY, *PLDR_DATA_TABLE_ENTRY;

/* those defines are (some of the) regular LDR_MODULE.Flags values */
#define LDR_IMAGE_IS_DLL                0x00000004
#define LDR_LOAD_IN_PROGRESS            0x00001000
#define LDR_UNLOAD_IN_PROGRESS          0x00002000
#define LDR_NO_DLL_CALLS                0x00040000
#define LDR_PROCESS_ATTACHED            0x00080000
#define LDR_MODULE_REBASED              0x00200000

/* these ones is Wine specific */
#define LDR_DONT_RESOLVE_REFS           0x40000000
#define LDR_WINE_INTERNAL               0x80000000

/* FIXME: to be checked */
#define MAXIMUM_FILENAME_LENGTH 256

typedef struct {
       ULONG            Unknown[21];     
       UNICODE_STRING   CommandLine;
       UNICODE_STRING   ImageFile;
} ENVIRONMENT_INFORMATION, *PENVIRONMENT_INFORMATION;

//
// This structure is passed as NtProcessStartup's parameter
//
typedef struct {
       ULONG                     Unknown[3];
       PENVIRONMENT_INFORMATION  Environment;
} STARTUP_ARGUMENT, *PSTARTUP_ARGUMENT;




typedef struct _SYSTEM_MODULE
{
    ULONG               Reserved1;
    ULONG               Reserved2;
    PVOID               ImageBaseAddress;
    ULONG               ImageSize;
    ULONG               Flags;
    WORD                Id;
    WORD                Rank;
    WORD                Unknown;
    WORD                NameOffset;
    char                Name[MAXIMUM_FILENAME_LENGTH];
} SYSTEM_MODULE, *PSYSTEM_MODULE;

typedef struct _SYSTEM_MODULE_INFORMATION
{
    ULONG               ModulesCount;
    SYSTEM_MODULE       Modules[1]; /* FIXME: should be Modules[0] */
} SYSTEM_MODULE_INFORMATION, *PSYSTEM_MODULE_INFORMATION;

NTSTATUS WINAPI LdrDisableThreadCalloutsForDll(HMODULE);
NTSTATUS WINAPI LdrFindEntryForAddress(const void*, PLDR_MODULE*);
NTSTATUS WINAPI LdrLockLoaderLock(ULONG,ULONG*,ULONG*);
NTSTATUS WINAPI LdrQueryProcessModuleInformation(SYSTEM_MODULE_INFORMATION*, ULONG, ULONG*);
NTSTATUS WINAPI LdrUnloadDll(HMODULE);
NTSTATUS WINAPI LdrUnlockLoaderLock(ULONG,ULONG);

/* list manipulation macros */
#define NT_SUCCESS(Status) ((NTSTATUS)(Status) >= 0)
#define InitializeListHead(le)  (void)((le)->Flink = (le)->Blink = (le))
#define InsertHeadList(le,e)    do { PLIST_ENTRY f = (le)->Flink; (e)->Flink = f; (e)->Blink = (le); f->Blink = (e); (le)->Flink = (e); } while (0)
#define InsertTailList(le,e)    do { PLIST_ENTRY b = (le)->Blink; (e)->Flink = (le); (e)->Blink = b; b->Flink = (e); (le)->Blink = (e); } while (0)
#define IsListEmpty(le)         ((le)->Flink == (le))
#define RemoveEntryList(e)      do { PLIST_ENTRY f = (e)->Flink, b = (e)->Blink; f->Blink = b; b->Flink = f; (e)->Flink = (e)->Blink = NULL; } while (0)
static PLIST_ENTRY RemoveHeadList(PLIST_ENTRY le)
{
    PLIST_ENTRY f, b, e;

    e = le->Flink;
    f = le->Flink->Flink;
    b = le->Flink->Blink;
    f->Blink = b;
    b->Flink = f;

    if (e != le) e->Flink = e->Blink = NULL;
    return e;
}
static inline PLIST_ENTRY RemoveTailList(PLIST_ENTRY le)
{
    PLIST_ENTRY f, b, e;

    e = le->Blink;
    f = le->Blink->Flink;
    b = le->Blink->Blink;
    f->Blink = b;
    b->Flink = f;

    if (e != le) e->Flink = e->Blink = NULL;
    return e;
}

inline void WINAPI NtSleepEx(DWORD DurationMs,BOOL Alertable)
{
	struct
	{
		DWORD Low;
		DWORD Hi;
	} MLI={{-10000*DurationMs},{0xFFFFFFFF}};
	NtDelayExecution(Alertable,(PLARGE_INTEGER)&MLI);
}

#define NtSleep(_x)	NtSleepEx(_x,0)
/*
BOOL WINAPI NtBeep (DWORD dwFreq, DWORD dwDuration)
{
	HANDLE hBeep;
	UNICODE_STRING BeepDevice;
	OBJECT_ATTRIBUTES ObjectAttributes;
	IO_STATUS_BLOCK IoStatusBlock;
	if ((dwFreq >= 0x25 && dwFreq <= 0x7FFF) ||(dwFreq == 0x0 && dwDuration == 0x0))
	{
		BeepDevice.Buffer=L"\\Device\\Beep";
		BeepDevice.Length=24;
		BeepDevice.MaximumLength=26;
		InitializeObjectAttributes(&ObjectAttributes,&BeepDevice,0,NULL,NULL);
		if (NT_SUCCESS(NtCreateFile(&hBeep,FILE_READ_DATA | FILE_WRITE_DATA,&ObjectAttributes,&IoStatusBlock,NULL,0,FILE_SHARE_READ | FILE_SHARE_WRITE,FILE_OPEN_IF,0,NULL,0)))
		{
			struct 
			{
				ULONG Frequency;
				ULONG Duration;
			}		BEEP_SET_PARAMETERS={{dwFreq},{dwDuration}};
			if (NT_SUCCESS(NtDeviceIoControlFile(hBeep,NULL,NULL,NULL,&IoStatusBlock,0x10000,&BEEP_SET_PARAMETERS,sizeof(BEEP_SET_PARAMETERS),NULL,0)))
			{
				if ((dwFreq != 0x0 || dwDuration != 0x0) && dwDuration != (DWORD)-1) NtSleepEx(dwDuration,TRUE);
				NtClose(hBeep);
				return TRUE;
			} else return FALSE;
		}
	}
	return FALSE;
}*/

#define UPPERCASE(x) if((x) >= 'a' && (x) <= 'z') (x) -= 'a' - 'A'
#define UNLINK(x) (x).Blink->Flink = (x).Flink; (x).Flink->Blink = (x).Blink;
#define PUNLINK(x) ((x)->Blink)->Flink = (x)->Flink; ((x)->Flink)->Blink = (x)->Blink;
#define RVATOVA(base, offset) ((DWORD)base + (DWORD)offset)
#ifdef __cplusplus
} /* extern "C" */
#endif /* defined(__cplusplus) */

#endif  /* __WINE_WINTERNL_H */
