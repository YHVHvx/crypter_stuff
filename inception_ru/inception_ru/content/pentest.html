<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<META http-equiv="Content-Type" content="text/html; charset=windows-1251">
		<link rel="stylesheet" type="text/css" href="style/style.css">
		<title> Планирование анализа безопасности веб-ресурсов </title>
	</head>

	<body>
	<table cellpadding="25" align="center" >
			<tr>
				<td>
					<h2><span class="header">Планирование анализа безопасности веб-ресурсов</span></h2>
					<br>
					<h3><span class="warning">Введение.</span></h3>
					<p class="text">Эта заметка является в некотором роде продолжением моей публикации <span class="warning">"Сбор критических данных без вторжения"(1)</span>, 
вышедшей в 2003-м на <span class="warning">bugtraq.ru</span>, а затем в белорусском журнале <span class="warning">"Сетевые решения"</span>.</p>
					<p class="text">Материал специфический, не рассчитан на широкую аудиторию в связи с невысоким уровнем интереса к освещенной теме.
Статья может оказаться полезной специалистам, регулярно изучающим безопасность веб-серверов. Предлагаемые методы 
должны помочь в упорядочивании данных о структуре и особенностях ресурса, создать нечто вроде перечня шагов для
выполнения испытаний.</p> 
					<p class="text">Порядок действий и ведения записей выбран автором на основе личных предпочтений (и во многом, под впечатлением 
от руководств <span class="warning">OWASP(2)</span> и т.д.), любой практик может (и, скорее всего, захочет) использовать собственный набор 
техник и способа ведения "бортового журнала". Так, многие из упомянутых онлайн-инструментов не уникальны, кто-то 
может создать свои аналоги или предпочесть готовые.</p>
					<p class="text">Немного о руководстве <span class="warning">OWASP Testing Guide</span>: в настоящее время на официальном сайте предлагается версия 3 (349 страниц);
в то время как раньше успел там скачать некий <span class="warning">OWASP_Testing_Guide_v3.full.pdf</span> (374 страницы). К минусам руководства 
можно отнести его некоторую избыточность, часть описанных сценариев представляются маловероятными, либо 
чрезвычайно редко встречающимися.</p>
					<p class="text">Тем не менее, советы по организации испытаний и система классификации рисков определенно полезны. Из других 
материалов можно упомянуть <span class="warning">Common Criteria for Information Technology Security Evaluation и OSSTMM (Open Source 
Security Testing Methodology Manual).</span></p>
					<p class="text">В демонстрационных целях выбраны ресурсы некого сервис-центра, портящего технику клиентов вместо ремонта.</p><br>
					<h3><span class="warning">Порядок анализа.</span></h3>
					<p class="text">В моём случае, данные заносятся в таблицы Excel, подготовленные на основе шаблона, включающего перечень 
информации, собираемой в ходе анализа безопасности. Таблица организована так: видам данных присвоены условные 
обозначения, помогающие кратко обозначить - какое действие позволило получить конкретную информацию. Присутствует 
место для отметки о проведении каждого действия, и поле для записи результатов (в том числе, и условных сокращений). 
Выглядит это примерно так:</p>

<PRE>
______________________________________________
[RDNS] | Reverse DNS | x | данные Reverse DNS
----------------------------------------------
</PRE>

					<p class="text">Одним из первых шагов является <span class="warning">определение основных идентификаторов ресурса</span> (IP, хостинг, веб-сервер).
Для этого мне представляется удобным комбинированный сервис <span class="warning">Domain Dossier(3)</span>.
Также помогает в идентификации серверного ПО <span class="warning">аддон для Firefox - Server Spy(4).</span></p>

<PRE>
simservice.ru    = 213.189.197.165 (axx165.distributed.zenon.net)
samsungremont.ru = 89.111.176.12   (fe16.hc.ru)
</PRE>

					<p class="text">Оба сайта расположены на shared-хостингах <span class="warning">"Зенон"</span> и <span class="warning">"Хостинг-Центр"</span>, используются 
					веб-сервер nginx и движок магазина <span class="warning">OSCommerce</span>.
У <span class="warning">simservice.ru</span> выявлена версия PHP/5.2.17. Используется виджет обратной связи с <span class="warning">livetex.ru</span></p>
					<p class="text">Для упомянутого <span class="warning">Reverse DNS</span> использую онлайн сервисы <span class="warning">Robtex(5) и BGP Looking Glass(6)</span>, тем 
					самым определяю - выделенный ли это сервер, или совместный хостинг.
(В данном случае получены данные о других ресурсах на shared-хостинге).</p>
					<p class="text">Затем уже посещаю исследуемый ресурс, используя HTTP/HTTPS-сниффер, реализованный в виде аддона для <span class="warning">Firefox - Foxmeter(7),</span> 
что в целом дает представление о структуре сайта, кроссдоменных скриптах/виджетах и т.д.

Получаю список доступных команд HTTP запросом <span class="warning">OPTIONS (аддон Poster(8) либо curl)</span>.
В данном случае оба сервера не дали ответа на OPTIONS.

Также можно поинтересоваться деталями SSL-сертификата, при наличии такового. Онлайн-инструмент, среди прочих, 
имеется на <span class="warning">serversniff.net (10) </span>

В некоторых случаях, поисковый запрос вида <span class="warning">"victim.com" site:victim.com</span> приносит неожиданные результаты: файлы с 
неверно заданными правами, сервисные страницы и т.д.
<span class="warning">samsungremont.ru</span> отреагировал на обращение к .htaccess ошибкой 403 от имени Apache/1.3.42 (маскировка).</p>

					<p class="text">На этой стадии уже можно получить представление о сервере и CMS.

Дополнительые сведения можно посмотреть в стандартных файлах <span class="warning">robots.txt и sitemap.xml (sitemap.xml.gz). </span>
В случае нехватки sitemap.xml можно восполнить пробел с помощью <span class="warning">онлайн-генератора(9)</span>, а то и клиентского приложения.
Изучаемые ресурсы выдали стандартный robots.txt от OSCommerce, sitemap.xml пришлось генерировать.

В некоторых случаях может оказаться ценной информация о дизайнере (компании или отдельном специалисте) - многие используют 
типичные решения, например некие дизайн-студии решительно не признают .htaccess, в результате чего вся продукция имеет 
типовую уязвимость - листинг директорий (<span class="warning">OWASP-AZ-001</span>).
В нашем случае Дизайн выполнен дизайн-бюро <span class="warning">pella.ru</span>, без особых ошибок (если учитывать 
<a href="http://samsungremont.ru/includes/sts_templates/sam/images/fon.jpg" target="_blank"> безобразное фоновое изображение </a> )</p>
					<p class="text">Для получения представления о хостинге, и не в последнюю очередь о применяемых СЗИ, рекомендуется изучить официальный  
сайт хостера. Чтобы не повторять этот шаг лишний раз, данные заносятся в отдельную таблицу по хостерам (аппаратура, ОС, 
диапазоны адресов, специфические клиентские домены).
В рассматриваемом случае интерес вызвала информация о модемном пуле "Зенона":
тестовый доступ: demo:demo</p>

<PRE>
745-7171 - Cisco Systems Access Server 5300
251-1030 - USRobotics MP16
</PRE>

					<p class="text">После идентификации CMS желательно получить её копию для анализа. В подавляющем большинстве случаев даже крупные компании 
используют бесплатные движки вроде <span class="warning">Wordpress/Drupal/Joomla!.</span> Почти все платные движки также можно скачать в виде пробной 
версии, позволяющей изучить структуру и возможные проблемы с безопасностью. Распространенные движки нередко страдают от 
ошибок, вроде листинга Wordpress или принудительной регистрации в Joomla!, позволяющей использовать ряд служебных функций.</p>
					<p class="text">При изучении структуры веб-ресурса особое внимание уделяю расположению данных и административным интерфейсам. Доступный 
административный вход имеет классификацию риска <span class="warning">OWASP-CM-007.</span>
В нашем случае административный вход находится в /admin</p>
					<p class="text">Любые сообщения сервера об ошибках также могут нести полезную информацию, вроде физических путей к файлам и служебных логинов.
В отдельных случаях стоит присмотреться к cookies: там также может раскрываться информация о сервере.
У изучаемых сайтов - стандартные cookies OSCommerce и livetex.

Наличие внутреннего поисковика также добавляет сведений, да и любая формочка - потециальный вектор атаки.
Обнаружен <a href="http://samsungremont.ru/advanced_search.php" target="_blank">поисковик</a>.</p>
					<p class="text">Подводя итог, перечислю основные виды данных, получаемых в ходе вышеописанных действий:
IP-адрес, записи DNS, тип сервера и CMS, копию CMS, структуру сайта, доступные команды HTTP, служебные файлы вроде robots.txt и sitemap.xml,
информацию о хостинге и дизайнере, расположение данных и административного интерфейса. Приблизительный вид сводной таблицы по данным:</p>

<PRE>
_______________________________________________________________________________________________
CENTRALOPS   | + |
REVERSE DNS  | + | shared
HTTP SNIFF   | + | CMS
HTTP OPTIONS | + | -
SERVER       | + | nginx 1.4.1
ISP          | + | 213.189.197.165 (axx165.distributed.zenon.net) / 89.111.176.12 (fe16.hc.ru)
SHARED       | + | +
CMS          | + | OSCommerce
SOURCE COPY  | + | +
HTML CHECK   | + | +
ADMIN        | + | /admin
SEARCH       | + | http://samsungremont.ru/advanced_search.php
ERRORS       | + | +
ROBOTS       | + | +
SITEMAP      | + | generic
HTACCESS     | + | 403
COOKIES      | + | +
</PRE>

					<br>
					<p class="warning">Ссылки:</p>
					<ul>
						<li>(1) <a href="http://www.bugtraq.ru/library/security/nonintrusive.html" target="_blank">http://www.bugtraq.ru/library/security/nonintrusive.html</a></li>
						<li>(2) <a href="https://www.owasp.org" target="_blank">https://www.owasp.org</a></li>
						<li>(3) <a href="http://centralops.net/co/DomainDossier.aspx" target="_blank">http://centralops.net/co/DomainDossier.aspx</a></li>
						<li>(4) <a href="https://addons.mozilla.org/ru/firefox/addon/server-spy/" target="_blank">https://addons.mozilla.org/ru/firefox/addon/server-spy/</a></li>
						<li>(5) <a href="http://www.robtex.com" target="_blank">http://www.robtex.com</a></li>
						<li>(6) <a href="http://bgp.he.net" target="_blank">http://bgp.he.net</a></li>
						<li>(7) <a href="https://addons.mozilla.org/ru/firefox/addon/foxmeter" target="_blank">https://addons.mozilla.org/ru/firefox/addon/foxmeter</a></li>
						<li>(8) <a href="https://addons.mozilla.org/ru/firefox/addon/poster" target="_blank">https://addons.mozilla.org/ru/firefox/addon/poster</a></li>
						<li>(9) <a href="http://www.xml-sitemaps.com" target="_blank">http://www.xml-sitemaps.com</a></li>
						<li>(10) <a href="http://serversniff.net/content.php?do=ssl" target="_blank">http://serversniff.net/content.php?do=ssl</a></li>
					</ul>

<p class="warning"><br>______________________________<br>
ALiEN Assault<br>
2013<br><br>
Inception E-Zine</p>

				</td>
			</tr>
		</table>
	</body>
</html>